(window.webpackJsonp=window.webpackJsonp||[]).push([[193,14,18,126],{1326:function(t,e,n){"use strict";n.r(e);var r=n(787),o=n(841),c=n(316),l=n(313),d=n(18),f=n(317),m=n(785),h=n(794),v=n(759),x=n(312),w=n(167),_=n(28),y=n(784),k=n(90),I=n(964),D=n(782),O=n(113),A=n(816),C=(n(7),n(67),n(34),n(131),n(35),n(12),n(13),n(33)),L=n(3),E=n(20),R=(n(92),n(22),n(5),n(10),n(44),n(30),n(121),n(66),n(8),n(68),n(39),n(51),n(104),n(824),n(54),n(825),n(826),n(827),n(828),n(829),n(830),n(831),n(832),n(833),n(834),n(835),n(836),n(837),n(838),n(839),n(840),n(53),n(9),n(102),n(250),n(821),n(447),n(62),n(843)),j=n(40),S=n(36);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function N(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Object(L.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var F={name:"gl-form",props:{GLId:{type:Number,default:null},isUpdate:{type:Boolean,default:!1}},directives:{commaThousand:R.a},created:function(){var t=this;return Object(E.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initializeForm();case 2:case"end":return e.stop()}}),e)})))()},data:function(){return{isloading:!1,customerDialog:!1,cancelConfirmDialog:!1,sheet:!1,successSnackbar:!1,successMessage:"",search:"",headerError:!1,errorLineNumber:null,validateErrorMessage:"",validationErrors:{header:{},lines:{}},accountList:[],transaction:{id:null,bookingDate:null,reference:"",description:"",vendorId:null,status:"PENDING",isActive:!0,exchangeRate:1,total:0,poHeaderId:null,locationId:null,user:null,lines:[]},headers:[{text:"#",value:"index",align:"center",sortable:!1,width:"60px"},{text:"Currency",value:"currencyId",align:"start",sortable:!1,width:"150px"},{text:"Amount",value:"amount",align:"end",sortable:!1,width:"120px"},{text:"Rate",value:"rate",align:"end",sortable:!1,width:"120px"},{text:"Debit Account",value:"drAccountId",align:"start",sortable:!1,width:"200px"},{text:"Credit Account",value:"crAccountId",align:"start",sortable:!1,width:"200px"},{text:"Description",value:"description",align:"start",sortable:!1,width:"150px"},{text:"Local Amount",value:"localAmount",align:"end",sortable:!1,width:"120px"},{text:"Actions",value:"actions",align:"center",sortable:!1,width:"80px"}],validationRules:{required:function(t){return!!t||"This field is required"},number:function(t){return!isNaN(parseFloat(t))&&isFinite(t)||"Must be a valid number"},positiveNumber:function(t){return parseFloat(t)>0||"Must be greater than 0"},date:function(t){if(!t)return"Date is required";var e=new Date(t);return!isNaN(e.getTime())||"Must be a valid date"},maxLength:function(t){return function(e){return!e||e.length<=t||"Maximum ".concat(t," characters allowed")}},numberComma:function(t){if(!t)return!0;return/^[0-9,]*$/.test(t)||"Only numbers and commas are allowed"}}}},computed:N(N({},Object(j.c)(["findAllProduct","findAllClient","findAllPayment","findAllUnit","findAllCurrency","findAllTerminal","findSelectedTerminal","findAllLocation"])),{},{currencyList:function(){return this.findAllCurrency||[]},grandTotal:function(){return this.transaction.lines.reduce((function(t,e){return t+(e.localAmount||0)}),0)},canSave:function(){return this.transaction.lines.length>0&&this.transaction.bookingDate&&!this.hasValidationErrors},hasValidationErrors:function(){var t=this,e=Object.keys(this.validationErrors.header).length>0,n=Object.keys(this.validationErrors.lines).some((function(e){return Object.keys(t.validationErrors.lines[e]).length>0}));return e||n},user:function(){return this.$auth.user||null}}),methods:{initializeForm:function(){var t=this;return Object(E.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.isloading=!0,e.next=4,t.loadChartOfAccount();case 4:if(n=(new Date).toISOString().substr(0,10),t.transaction.bookingDate=n,t.transaction.user=t.user,!t.isUpdate||!t.GLId){e.next=12;break}return e.next=10,t.loadTransaction();case 10:e.next=13;break;case 12:t.newRow();case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),t.showError("Failed to initialize form"),console.error("Initialization error:",e.t0);case 19:return e.prev=19,t.isloading=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[0,15,19,22]])})))()},loadChartOfAccount:function(){var t=this;return Object(E.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("api/account/findAll");case 3:n=e.sent,t.accountList=n.data,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t.showError("Failed to load chart of accounts"),console.error("Chart of accounts error:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},loadTransaction:function(){var t=this;return Object(E.a)(regeneratorRuntime.mark((function e(){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("api/gl/find/".concat(t.GLId));case 3:n=e.sent,data=n.data,t.transaction.bookingDate=data.bookingDate,t.transaction.reference=data.reference||"",t.transaction.description=data.description||"",t.transaction.id=data.id,data.lines&&data.lines.length>0?t.transaction.lines=data.lines.map((function(line,t){return N(N({},line),{},{tempId:"line_".concat(t,"_").concat(Date.now())})})):t.transaction.lines=[data],e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),t.showError("Failed to load transaction"),console.error("Load transaction error:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},newRow:function(){if(this.isUpdate)this.showError("Cannot add new lines in update mode");else{var t={tempId:"line_".concat(this.transaction.lines.length,"_").concat(Date.now()),postingReference:"DUMMY",bookingDate:this.transaction.bookingDate,amount:"",currencyId:null,rate:"1",drAccountId:null,crAccountId:null,description:"",localAmount:0,source:"GL",isActive:!0};this.transaction.lines.push(t),this.clearLineErrors(this.transaction.lines.length-1)}},deleteItem:function(t,e){var n=this;return Object(E.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!n.transaction.poHeaderId){r.next=4;break}return n.showError("Cannot delete lines from PO transactions"),r.abrupt("return");case 4:return r.next=6,Object(S.a)(n.$swal,"Delete Line","Are you sure you want to delete this line?");case 6:if(r.sent){r.next=9;break}return r.abrupt("return");case 9:if(!t.id){r.next=13;break}return n.isloading=!0,r.next=13,n.$axios.delete("api/gl/line/find/".concat(t.id));case 13:n.transaction.lines.splice(e,1),n.clearLineErrors(e),n.reindexLineErrors(e),r.next=22;break;case 18:r.prev=18,r.t0=r.catch(0),n.showError("Failed to delete line"),console.error("Delete line error:",r.t0);case 22:return r.prev=22,n.isloading=!1,r.finish(22);case 25:case"end":return r.stop()}}),r,null,[[0,18,22,25]])})))()},currencyChange:function(t,e){var n=this.currencyList.find((function(e){return e.id===t.currencyId}));n&&(t.rate=n.rate||1,this.calculateLocalAmount(t,e),this.validateLineField(e,"currencyId"))},amountChange:function(t,e){this.calculateLocalAmount(t,e),this.validateLineField(e,"amount")},rateChange:function(t,e){this.calculateLocalAmount(t,e),this.validateLineField(e,"rate")},calculateLocalAmount:function(t,e){var n=parseFloat(Object(S.h)(t.amount||"0",",","")),r=parseFloat(Object(S.h)(t.rate||"1",",",""));isNaN(n)||isNaN(r)?t.localAmount=0:t.localAmount=n*r},validateField:function(t){var e=this.transaction[t],n=[];switch(t){case"bookingDate":e?new Date(e)>new Date&&n.push("Booking date cannot be in the future"):n.push("Booking date is required");break;case"reference":e&&e.length>50&&n.push("Reference must be 50 characters or less")}n.length>0?this.validationErrors.header[t]=n:delete this.validationErrors.header[t]},validateLineField:function(t,e){var line=this.transaction.lines[t],n=[];switch(this.validationErrors.lines[t]||(this.validationErrors.lines[t]={}),e){case"currencyId":line.currencyId||n.push("Currency is required");break;case"amount":if(line.amount){var r=parseFloat(Object(S.h)(line.amount,",",""));(isNaN(r)||r<=0)&&n.push("Amount must be greater than 0")}else n.push("Amount is required");break;case"rate":if(line.rate){var o=parseFloat(Object(S.h)(line.rate,",",""));(isNaN(o)||o<=0)&&n.push("Rate must be greater than 0")}else n.push("Rate is required");break;case"drAccountId":line.drAccountId||n.push("Debit account is required");break;case"crAccountId":line.crAccountId||n.push("Credit account is required")}n.length>0?this.validationErrors.lines[t][e]=n:delete this.validationErrors.lines[t][e]},validateAllFields:function(){var t=this;return this.validateField("bookingDate"),this.validateField("reference"),this.transaction.lines.forEach((function(line,e){t.validateLineField(e,"currencyId"),t.validateLineField(e,"amount"),t.validateLineField(e,"rate"),t.validateLineField(e,"drAccountId"),t.validateLineField(e,"crAccountId")})),this.transaction.lines.forEach((function(line,e){line.drAccountId&&line.crAccountId&&line.drAccountId===line.crAccountId&&(t.validationErrors.lines[e]||(t.validationErrors.lines[e]={}),t.validationErrors.lines[e].drAccountId=["Debit and Credit accounts cannot be the same"],t.validationErrors.lines[e].crAccountId=["Debit and Credit accounts cannot be the same"])})),!this.hasValidationErrors},getFieldError:function(t){return this.validationErrors.header[t]||[]},getLineError:function(t,e){var n;return(null===(n=this.validationErrors.lines[t])||void 0===n?void 0:n[e])||[]},clearLineErrors:function(t){delete this.validationErrors.lines[t]},reindexLineErrors:function(t){var e=this,n={};Object.keys(this.validationErrors.lines).forEach((function(r){var o=parseInt(r);o>t?n[o-1]=e.validationErrors.lines[r]:o<t&&(n[o]=e.validationErrors.lines[r])})),this.validationErrors.lines=n},showError:function(t){this.validateErrorMessage=t,this.sheet=!0},showSuccess:function(t){this.successMessage=t,this.successSnackbar=!0},resetForm:function(){this.transaction={id:null,bookingDate:(new Date).toISOString().substr(0,10),reference:"",description:"",vendorId:null,status:"PENDING",isActive:!0,exchangeRate:1,total:0,poHeaderId:null,locationId:null,user:this.user,lines:[]},this.validationErrors={header:{},lines:{}},this.newRow()},printTransaction:function(){this.transaction.id?console.log("Printing transaction:",this.transaction.id):this.showError("Cannot print unsaved transaction")},toggleDialog:function(){this.$emit("close-dialog")},postTransaction:function(){var t=this;return Object(E.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isloading){e.next=2;break}return e.abrupt("return");case 2:if(t.validateAllFields()){e.next=5;break}return t.showError("Please fix validation errors before saving"),e.abrupt("return");case 5:if(e.prev=5,t.isloading=!0,(n=N({},t.transaction)).lines=n.lines.map((function(line){return N(N({},line),{},{amount:parseFloat(Object(S.h)(line.amount.toString(),",","")),rate:parseFloat(Object(S.h)(line.rate.toString(),",","")),localAmount:parseFloat(line.localAmount||0),bookingDate:n.bookingDate})})),!t.isUpdate){e.next=14;break}return e.next=12,t.updateTransaction(n);case 12:e.next=16;break;case 14:return e.next=16,t.createTransaction(n);case 16:t.showSuccess("Transaction saved successfully"),t.$emit("reload"),t.$emit("close-dialog"),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(5),t.handleSaveError(e.t0);case 24:return e.prev=24,t.isloading=!1,e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[5,21,24,27]])})))()},createTransaction:function(t){var e=this;return Object(E.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.lines.forEach((function(line){delete line.id,delete line.tempId})),n.next=3,e.$axios.post("api/gl/createMulti",t);case 3:return r=n.sent,n.abrupt("return",r.data);case 5:case"end":return n.stop()}}),n)})))()},updateTransaction:function(t){var e=this;return Object(E.a)(regeneratorRuntime.mark((function n(){var line,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(1!==t.lines.length){n.next=9;break}return(line=t.lines[0]).bookingDate=t.bookingDate,n.next=5,e.$axios.put("api/gl/update/".concat(e.GLId),line);case 5:return r=n.sent,n.abrupt("return",r.data);case 9:throw new Error("Multiple lines update not supported");case 10:case"end":return n.stop()}}),n)})))()},handleSaveError:function(t){var e;if(console.error("Save error:",t),null!==(e=t.response)&&void 0!==e&&e.data){var n=t.response.data;if(n.includes("#")){var r=n.split("#");if(r.length>1){var o=r[1],c=this.transaction.lines.findIndex((function(line){return line.productId==o}));c>=0&&(this.errorLineNumber=c)}}this.showError(n)}else this.showError("Failed to save transaction. Please try again.")},getFormatNum:function(t){return null==t||isNaN(t)?"0":new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}).format(t)},findCurrency:function(t){return this.currencyList.find((function(e){return e.id===t}))},validateBusinessRules:function(){var t=[],e=(this.transaction.lines.reduce((function(t,line){return t+(line.localAmount||0)}),0),this.transaction.lines.reduce((function(t,line){return t+(line.localAmount||0)}),0),new Set);this.transaction.lines.forEach((function(line,n){if(line.drAccountId&&line.crAccountId){var r="".concat(line.drAccountId,"-").concat(line.crAccountId);e.has(r)&&t.push({lineIndex:n,field:"drAccountId",message:"Duplicate account combination found"}),e.add(r)}}));var n=this.transaction.lines.map((function(line){return line.drAccountId&&line.crAccountId?[line.drAccountId,line.crAccountId].sort().join("-"):null})).filter(Boolean);return n.filter((function(t,e){return n.indexOf(t)!==e})).length>0&&t.push({lineIndex:-1,field:"general",message:"Circular account references detected"}),t},validateAccountingPeriod:function(){var t=new Date(this.transaction.bookingDate),e=new Date,n=new Date;return n.setDate(e.getDate()-365),t<n?"Booking date is too far in the past":t>e?"Booking date cannot be in the future":null},filterAccountsByType:function(t){return this.accountList.filter((function(e){return e.accountType===t}))},getDebitAccounts:function(){return this.accountList.filter((function(t){return["ASSET","EXPENSE"].includes(t.accountType)}))},getCreditAccounts:function(){return this.accountList.filter((function(t){return["LIABILITY","EQUITY","REVENUE"].includes(t.accountType)}))},handleKeyboardShortcuts:function(t){t.ctrlKey&&"s"===t.key&&(t.preventDefault(),this.postTransaction()),t.ctrlKey&&"n"===t.key&&(t.preventDefault(),this.newRow()),"Escape"===t.key&&this.toggleDialog()},exportToCSV:function(){var t=this,e=this.transaction.lines.map((function(line,e){var n,r,o;return[e+1,(null===(n=t.currencyList.find((function(t){return t.id===line.currencyId})))||void 0===n?void 0:n.code)||"",line.amount,line.rate,(null===(r=t.accountList.find((function(a){return a.id===line.drAccountId})))||void 0===r?void 0:r.accountNumber)||"",(null===(o=t.accountList.find((function(a){return a.id===line.crAccountId})))||void 0===o?void 0:o.accountNumber)||"",line.description,line.localAmount]})),n=[["Line#","Currency","Amount","Rate","Debit Account","Credit Account","Description","Local Amount"]].concat(Object(C.a)(e)).map((function(t){return t.map((function(t){return'"'.concat(t,'"')})).join(",")})).join("\n"),r=new Blob([n],{type:"text/csv"}),o=window.URL.createObjectURL(r),link=document.createElement("a");link.href=o,link.download="GL_Transaction_".concat(this.transaction.id||"New",".csv"),link.click(),window.URL.revokeObjectURL(o)},setupAutoSave:function(){var t=this;this.autoSaveInterval=setInterval((function(){t.transaction.lines.length>0&&!t.hasValidationErrors&&!t.isloading&&t.autoSave()}),3e4)},autoSave:function(){var t=this;return Object(E.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=N(N({},t.transaction),{},{status:"DRAFT"}),console.log("Auto-saving draft...",n)}catch(t){console.error("Auto-save failed:",t)}case 1:case"end":return e.stop()}}),e)})))()}},mounted:function(){document.addEventListener("keydown",this.handleKeyboardShortcuts),"true"===this.$route.query.autosave&&this.setupAutoSave()},beforeDestroy:function(){document.removeEventListener("keydown",this.handleKeyboardShortcuts),this.autoSaveInterval&&clearInterval(this.autoSaveInterval)},watch:{"transaction.bookingDate":function(t){t&&this.transaction.lines.forEach((function(line){line.bookingDate=t}))},"transaction.lines":{handler:function(){this.$nextTick((function(){}))},deep:!0}}},T=(n(971),n(32)),component=Object(T.a)(F,(function(){var t=this,e=t._self._c;return e("div",[e(v.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(v.a,{attrs:{"max-width":"1024"},model:{value:t.customerDialog,callback:function(e){t.customerDialog=e},expression:"customerDialog"}},[e("customer-list",{on:{"close-dialog":function(e){t.customerDialog=!1}}})],1),t._v(" "),e(v.a,{attrs:{"max-width":"1024"},model:{value:t.cancelConfirmDialog,callback:function(e){t.cancelConfirmDialog=e},expression:"cancelConfirmDialog"}},[e("cancel-ticket-form",{attrs:{id:t.headerId,customerId:t.onlineCustomerId},on:{refresh:function(e){return t.$emit("reload")},"close-dialog":function(e){t.cancelConfirmDialog=!1}}})],1),t._v(" "),e(o.a,{attrs:{inset:""},model:{value:t.sheet,callback:function(e){t.sheet=e},expression:"sheet"}},[e(k.a,{staticClass:"text-center",attrs:{height:"200px"}},[e(c.a,{staticClass:"mt-6",attrs:{text:"",color:"error"},on:{click:function(e){t.sheet=!1}}},[e(w.a,{attrs:{left:""}},[t._v("mdi-close")]),t._v("\n        Close\n      ")],1),t._v(" "),e("div",{staticClass:"my-3 error--text"},[t._v("\n        "+t._s(t.validateErrorMessage)+"\n      ")])],1)],1),t._v(" "),e(I.a,{attrs:{color:"success",timeout:"3000"},scopedSlots:t._u([{key:"action",fn:function(n){var r=n.attrs;return[e(c.a,t._b({attrs:{text:""},on:{click:function(e){t.successSnackbar=!1}}},"v-btn",r,!1),[e(w.a,[t._v("mdi-close")])],1)]}}]),model:{value:t.successSnackbar,callback:function(e){t.successSnackbar=e},expression:"successSnackbar"}},[t._v("\n    "+t._s(t.successMessage)+"\n    ")]),t._v(" "),e(l.a,[e(d.b,[e(y.a,[e(m.a,{attrs:{cols:"6"}},[e(f.a,{staticClass:"pa-5",attrs:{color:"primary",label:"","text-color":"white"}},[e(w.a,{attrs:{start:""}},[t._v("mdi-book-open-variant")]),t._v(" "),e("h3",[t._v("General Ledger")])],1)],1),t._v(" "),e(m.a,{staticClass:"text-right",attrs:{cols:"6"}},[e(c.a,{staticClass:"primary mr-2",attrs:{size:"large",variant:"outlined",rounded:"",disabled:!t.transaction.id},on:{click:t.printTransaction}},[e(w.a,{attrs:{left:""}},[t._v("mdi-printer")]),t._v("\n            Print\n          ")],1),t._v(" "),e(c.a,{attrs:{size:"large",variant:"outlined",color:"secondary",rounded:"",disabled:t.isloading},on:{click:t.resetForm}},[e(w.a,{attrs:{left:""}},[t._v("mdi-refresh")]),t._v("\n            Reset\n          ")],1)],1)],1)],1),t._v(" "),e(x.a),t._v(" "),e(d.c,{staticClass:"pa-4"},[e(l.a,{staticClass:"mb-4 pa-4",class:{"error-border":t.headerError},attrs:{elevation:"2"}},[e(d.d,{staticClass:"pb-2"},[e(w.a,{attrs:{left:"",color:"primary"}},[t._v("mdi-information")]),t._v("\n          Transaction Details\n          "),e(D.a),t._v(" "),t.transaction.id?e(f.a,{attrs:{color:"info",small:""}},[t._v("\n            RECID: "+t._s(t.transaction.id)+"\n          ")]):t._e()],1),t._v(" "),e(d.c,[e(y.a,[e(m.a,{attrs:{cols:"12",md:"4"}},[e(O.a,{attrs:{type:"date",label:"Booking Date *","error-messages":t.getFieldError("bookingDate"),outlined:"",dense:"",required:""},on:{blur:function(e){return t.validateField("bookingDate")}},model:{value:t.transaction.bookingDate,callback:function(e){t.$set(t.transaction,"bookingDate",e)},expression:"transaction.bookingDate"}}),t._v(" "),e(O.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"PO Reference Number",outlined:"",dense:"",disabled:""},model:{value:t.transaction.poHeaderId,callback:function(e){t.$set(t.transaction,"poHeaderId",e)},expression:"transaction.poHeaderId"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",md:"4"}},[e(O.a,{attrs:{label:"Reference",outlined:"",dense:"","error-messages":t.getFieldError("reference"),maxlength:"50"},on:{blur:function(e){return t.validateField("reference")}},model:{value:t.transaction.reference,callback:function(e){t.$set(t.transaction,"reference",e)},expression:"transaction.reference"}}),t._v(" "),e(A.a,{attrs:{label:"Transaction Description",outlined:"",dense:"",rows:"2",maxlength:"255"},model:{value:t.transaction.description,callback:function(e){t.$set(t.transaction,"description",e)},expression:"transaction.description"}})],1),t._v(" "),e(m.a,{staticClass:"text-right",attrs:{cols:"12",md:"4"}},[t.transaction.user?e("div",{staticClass:"mb-2"},[e("strong",[t._v("Created by:")]),t._v(" "+t._s(t.transaction.user.cus_id)),e("br"),t._v(" "),e("strong",[t._v("Name:")]),t._v(" "+t._s(t.transaction.user.cus_name)+"\n              ")]):t._e(),t._v(" "),e(l.a,{staticClass:"pa-3",attrs:{outlined:""}},[e("div",{staticClass:"text-h6 primary--text"},[t._v("\n                  Total Amount (LCY)\n                ")]),t._v(" "),e("div",{staticClass:"text-h5 font-weight-bold"},[t._v("\n                  "+t._s(t.getFormatNum(t.grandTotal))+"\n                ")])])],1)],1)],1)],1),t._v(" "),e(l.a,{attrs:{elevation:"2"}},[e(d.d,{staticClass:"pb-2"},[e(w.a,{attrs:{left:"",color:"primary"}},[t._v("mdi-format-list-bulleted")]),t._v("\n          Transaction Lines\n          "),e(D.a),t._v(" "),e(c.a,{attrs:{color:"primary",disabled:t.isUpdate||t.isloading,small:""},on:{click:t.newRow}},[e(w.a,{attrs:{left:""}},[t._v("mdi-plus")]),t._v("\n            Add Line\n          ")],1)],1),t._v(" "),e(d.c,[t.transaction.lines&&t.transaction.lines.length>0?e(h.a,{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.transaction.lines,search:t.search,"item-key":"tempId"},scopedSlots:t._u([{key:"top",fn:function(){return[e(O.a,{staticClass:"mb-3",attrs:{label:"Search lines...","prepend-inner-icon":"mdi-magnify","single-line":"","hide-details":"",clearable:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]},proxy:!0},{key:"item",fn:function(n){var o=n.item,l=n.index;return[e("tr",{class:{"error-row":t.errorLineNumber===l}},[e("td",{staticClass:"text-center"},[e(f.a,{attrs:{small:"",color:t.errorLineNumber===l?"error":"primary"}},[t._v("\n                    "+t._s(l+1)+"\n                  ")])],1),t._v(" "),e("td",{staticStyle:{"min-width":"150px"}},[e(r.a,{attrs:{items:t.currencyList,"item-text":"code","item-value":"id",label:"Currency *",outlined:"",dense:"","error-messages":t.getLineError(l,"currencyId"),required:""},on:{change:function(e){return t.currencyChange(o,l)},blur:function(e){return t.validateLineField(l,"currencyId")}},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item;return[t._v("\n                      "+t._s(n.code)+" - "+t._s(n.name)+"\n                    ")]}},{key:"item",fn:function(n){var r=n.item;return[e(_.a,[e(_.c,[t._v(t._s(r.code))]),t._v(" "),e(_.b,[t._v(t._s(r.name))])],1)]}}],null,!0),model:{value:o.currencyId,callback:function(e){t.$set(o,"currencyId",e)},expression:"item.currencyId"}})],1),t._v(" "),e("td",{staticStyle:{"min-width":"120px"}},[e(O.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"Amount *",outlined:"",dense:"","error-messages":t.getLineError(l,"amount"),required:""},on:{input:function(e){return t.amountChange(o,l)},blur:function(e){return t.validateLineField(l,"amount")}},model:{value:o.amount,callback:function(e){t.$set(o,"amount",e)},expression:"item.amount"}})],1),t._v(" "),e("td",{staticStyle:{"min-width":"120px"}},[e(O.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"Exchange Rate *",outlined:"",dense:"","error-messages":t.getLineError(l,"rate"),required:""},on:{input:function(e){return t.rateChange(o,l)},blur:function(e){return t.validateLineField(l,"rate")}},model:{value:o.rate,callback:function(e){t.$set(o,"rate",e)},expression:"item.rate"}})],1),t._v(" "),e("td",{staticStyle:{"min-width":"200px"}},[e(r.a,{attrs:{items:t.accountList,"item-text":"accountNumber","item-value":"id",label:"Debit Account *",outlined:"",dense:"","error-messages":t.getLineError(l,"drAccountId"),required:""},on:{blur:function(e){return t.validateLineField(l,"drAccountId")}},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item;return[t._v("\n                      "+t._s(n.accountNumber)+" - "+t._s(n.accountName)+"\n                    ")]}},{key:"item",fn:function(n){var r=n.item;return[e(_.a,[e(_.c,[t._v(t._s(r.accountNumber))]),t._v(" "),e(_.b,[t._v(t._s(r.accountName))])],1)]}}],null,!0),model:{value:o.drAccountId,callback:function(e){t.$set(o,"drAccountId",e)},expression:"item.drAccountId"}})],1),t._v(" "),e("td",{staticStyle:{"min-width":"200px"}},[e(r.a,{attrs:{items:t.accountList,"item-text":"accountNumber","item-value":"id",label:"Credit Account *",outlined:"",dense:"","error-messages":t.getLineError(l,"crAccountId"),required:""},on:{blur:function(e){return t.validateLineField(l,"crAccountId")}},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.item;return[t._v("\n                      "+t._s(n.accountNumber)+" - "+t._s(n.accountName)+"\n                    ")]}},{key:"item",fn:function(n){var r=n.item;return[e(_.a,[e(_.c,[t._v(t._s(r.accountNumber))]),t._v(" "),e(_.b,[t._v(t._s(r.accountName))])],1)]}}],null,!0),model:{value:o.crAccountId,callback:function(e){t.$set(o,"crAccountId",e)},expression:"item.crAccountId"}})],1),t._v(" "),e("td",{staticStyle:{"min-width":"150px"}},[e(O.a,{attrs:{label:"Description",outlined:"",dense:"",maxlength:"100"},model:{value:o.description,callback:function(e){t.$set(o,"description",e)},expression:"item.description"}})],1),t._v(" "),e("td",{staticClass:"text-right font-weight-bold"},[t._v("\n                  "+t._s(t.getFormatNum(o.localAmount))+"\n                ")]),t._v(" "),e("td",{staticClass:"text-center"},[e(c.a,{attrs:{color:"error",icon:"",small:"",disabled:t.isloading},on:{click:function(e){return t.deleteItem(o,l)}}},[e(w.a,[t._v("mdi-delete")])],1)],1)])]}}],null,!1,1715049908)}):e(l.a,{staticClass:"pa-8 text-center",staticStyle:{border:"2px dashed #ccc"},attrs:{outlined:""}},[e(w.a,{attrs:{size:"64",color:"grey"}},[t._v("mdi-format-list-bulleted")]),t._v(" "),e("h3",{staticClass:"mt-4 mb-2"},[t._v("No transaction lines")]),t._v(" "),e("p",{staticClass:"mb-4"},[t._v("Add your first transaction line to get started")]),t._v(" "),e(c.a,{attrs:{color:"primary",disabled:t.isUpdate||t.isloading},on:{click:t.newRow}},[e(w.a,{attrs:{left:""}},[t._v("mdi-plus")]),t._v("\n              Add First Line\n            ")],1)],1)],1)],1)],1),t._v(" "),e(d.a,{staticClass:"pa-4"},[t.transaction.lines.length>0?e(f.a,{attrs:{color:"info",outlined:""}},[t._v("\n        "+t._s(t.transaction.lines.length)+" line(s)\n      ")]):t._e(),t._v(" "),e(D.a),t._v(" "),e(c.a,{attrs:{color:"grey",text:"",disabled:t.isloading},on:{click:t.toggleDialog}},[e(w.a,{attrs:{left:""}},[t._v("mdi-close")]),t._v("\n        Cancel\n      ")],1),t._v(" "),e(c.a,{attrs:{color:"primary",disabled:t.isloading||!t.canSave,loading:t.isloading},on:{click:t.postTransaction}},[e(w.a,{attrs:{left:""}},[t._v("mdi-content-save")]),t._v("\n        "+t._s(t.isUpdate?"Update":"Save")+"\n      ")],1)],1)],1)],1)}),[],!1,null,"f09cae02",null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default,CustomerList:n(268).default,CancelTicketForm:n(823).default})},1751:function(t,e,n){"use strict";n.r(e);var r=n(316),o=n(313),c=n(18),l=n(785),d=n(794),f=n(1719),m=n(759),h=n(775),v=n(318),x=n(113),w=(n(34),n(131),n(20)),_=n(31),y=(n(92),n(30),n(332),n(35),n(5),n(8),n(902)),k=n(896),I=n(897),D=n(36),O=n(1326),A={components:{PoForm:y.default,PurchasingFormCRUD:k.default,ReceivingFormCRUD:I.default,GLForm:O.default},mounted:function(){this.loadTxn()},middleware:"auths",data:function(){return{userId:"",search:"",isEdit:!1,dialog:!1,apFormKey:1,isloading:!1,menu1:!1,menu2:!1,txnList:[],selectedId:"",headers:[{text:"RECID",align:"center",value:"id",sortable:!0},{text:"ວັນທີ",align:"center",value:"bookingDate",sortable:!0},{text:"SRC APP REF.",align:"center",value:"source",sortable:!0},{text:"ຈຳນວນ",align:"center",value:"amount"},{text:"ສະກຸນ",align:"center",value:"currency.code"},{text:"ອັດຕາແລກປ່ຽນ",align:"right",value:"rate"},{text:"DR",align:"center",value:"drAccount.accountNumber"},{text:"CR",align:"center",value:"crAccount.accountNumber"},{text:"Local amount",align:"right",value:"localAmount"},{text:"ເນື້ອໃນ",align:"center",value:"description"},{text:"ເວລາສ້າງ",align:"center",value:"createdAt"},{text:"ແກ້ໄຂ",align:"end",value:"function",sortable:!1}],date:Object(D.d)(),date2:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),dateFormatted:this.formatDate(Object(D.d)()),dateFormatted2:this.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10))}},watch:{date:function(t){this.dateFormatted=this.formatDate(this.date),this.loadTxn()},date2:function(t){this.dateFormatted2=this.formatDate(this.date2),this.loadTxn()}},methods:{numberWithCommas:function(t){return Object(D.e)(t)},triggerDialog:function(){this.apFormKey+=1,this.selectedId=null,this.isEdit=!1,this.dialog=!0},editItem:function(t){console.log("PO HEADER ID ".concat(t.id)),this.selectedId=t.id,this.isEdit=!0,this.apFormKey+=1,this.dialog=!0},formatDate:function(t){if(!t)return null;console.log("DATE FORMAT METHOD1: "+t);var e=this.formatDateToISO(t).split("-"),n=Object(_.a)(e,3),r=n[0],o=n[1],c=n[2];return"".concat(o,"/").concat(c,"/").concat(r)},parseDate:function(t){if(console.log("DATE PARSE METHOD1: "+t),!t)return null;var e=t.split("/"),n=Object(_.a)(e,3),r=n[0],o=n[1],c=n[2];return"".concat(c,"-").concat(r.padStart(2,"0"),"-").concat(o.padStart(2,"0"))},formatDateToISO:function(t){t instanceof Date||(t=new Date(t));var e=t.getFullYear(),n="".concat(t.getMonth()+1).padStart(2,"0"),r="".concat(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(r)},loadTxn:function(){var t=this;return Object(w.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isloading=!0,n={startDate:t.date,endDate:t.date2},e.prev=2,e.next=5,t.$axios.get("/api/gl/findByDate",{params:{date:n}});case 5:r=e.sent,t.txnList=r.data,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),Object(D.j)(t.$swal,"Error","ເກີດຂໍ້ຜິດພາດ ກະລຸນາລອງໃຫມ່ ພາຍຫລັງ "+e.t0);case 12:t.isloading=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))()},postToPayment:function(t){var e=this;return Object(w.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r={receivingId:t.id,bookingDate:t.bookingDate,paymentNumber:"POST FROM REC: ".concat(t.id),payee:t.vendor.name,paymentId:null,currencyId:t.currencyId,rate:t.exchangeRate,totalAmount:t.total,notes:t.notes,update_user:1,drAccount:null,crAccount:1,isActive:!0},Object(D.a)(e.$swal,"You are posting to Payment ?",Object(w.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,t.prev=1,t.next=4,e.$axios.post("/api/finanicial/ap/header/api/create",r);case 4:n=t.sent,console.log("Transaction complete ".concat(JSON.stringify(n.data))),Object(D.k)(e.$swal,"Succeed","Your transaction completed"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error("Something went wrong ".concat(t.t0)),Object(D.j)(e.$swal,"Error","ເກີດຂໍ້ຜິດພາດ ກະລຸນາລອງໃຫມ່ ພາຍຫລັງ "+t.t0);case 13:e.isloading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])}))));case 2:case"end":return n.stop()}}),n)})))()}},computed:{GLCurrencyGrouping:function(){var t={};this.txnList.forEach((function(e){var n=e.amount,r=e.currency;t[r.code]||(t[r.code]=0),t[r.code]+=n}));var e=[];for(var n in t)console.log("Total for ".concat(n,": ").concat(t[n])),e.push({currency:n,amount:t[n]});return e},totalLCYAmount:function(){return this.txnList.reduce((function(t,e){return t+e.localAmount}),0)}}},C=n(32),component=Object(C.a)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center"},[e("div",[e(m.a,{attrs:{width:"90%"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e("GLForm",{key:t.apFormKey,attrs:{isUpdate:t.isEdit,GLId:t.selectedId},on:{"close-dialog":function(e){t.dialog=!1},reload:t.loadTxn}})],1)],1),t._v(" "),e(m.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(o.a,[e(c.d,[e(h.a,{attrs:{row:"",wrap:""}},[e(l.a,{attrs:{cols:"6"}},[e(v.a,{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(x.a,t._g(t._b({attrs:{label:"ຈາກວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(e){t.date=t.parseDate(t.dateFormatted)}},model:{value:t.dateFormatted,callback:function(e){t.dateFormatted=e},expression:"dateFormatted"}},"v-text-field",o,!1),r))]}}]),model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[t._v(" "),e(f.a,{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),e(v.a,{ref:"menu2",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(x.a,t._g(t._b({attrs:{label:"ຫາວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(e){t.date2=t.parseDate(t.dateFormatted2)}},model:{value:t.dateFormatted2,callback:function(e){t.dateFormatted2=e},expression:"dateFormatted2"}},"v-text-field",o,!1),r))]}}]),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[t._v(" "),e(f.a,{attrs:{"no-title":""},on:{input:function(e){t.menu2=!1}},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1),t._v(" "),e(r.a,{staticClass:"primary",attrs:{rounded:""},on:{click:t.triggerDialog}},[t._v(" ເພີ່ມລາຍການ GL ")])],1),t._v(" "),e(l.a,{attrs:{cols:"6"}},[e(x.a,{attrs:{"append-icon":"mdi-magnify",label:"ຊອກຫາ","single-line":"","hide-detailsx":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),e(x.a,{attrs:{"append-icon":"mdi-magnify",label:"ລະຫັດຜູ້ຂາຍ","single-line":"","hide-detailsx":""},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}}),t._v(" "),e(r.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.loadTxn}},[t._v(" ດຶງລາຍງານ\n                    ")])],1)],1)],1),t._v(" "),e(c.c,[t.GLCurrencyGrouping.length>0?e("table",{attrs:{border:"1"}},[e("thead",[e("tr",[e("th",[t._v("ສະກຸນເງິນ")]),t._v(" "),e("th",[t._v("ລວມຍອດ")])])]),t._v(" "),e("tbody",[t._l(t.GLCurrencyGrouping,(function(n){return e("tr",{key:n.currency},[e("td",[t._v(t._s(n.currency))]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.numberWithCommas(n.amount)))])])})),t._v(" "),e("tr",[e("td",[t._v("ຍອດລວມສະກຸນ LCY")]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.numberWithCommas(t.totalLCYAmount)))])])],2)]):t._e()]),t._v(" "),t.txnList?e(d.a,{attrs:{headers:t.headers,search:t.search,items:t.txnList},scopedSlots:t._u([{key:"item.function",fn:function(n){var o=n.item;return[e(r.a,{attrs:{color:"primary",text:""},on:{click:function(e){return t.editItem(o)}}},[e("i",{staticClass:"fa-regular fa-pen-to-square"})])]}},{key:"item.POST",fn:function(n){var o=n.item;return[e(r.a,{attrs:{color:"primary",text:""},on:{click:function(e){return t.postToPayment(o)}}},[e("i",{staticClass:"fa-solid fa-file-invoice-dollar"})])]}},{key:"item.amount",fn:function(e){var n=e.item;return[t._v("\n                "+t._s(t.numberWithCommas(n.amount))+"\n            ")]}},{key:"item.localAmount",fn:function(e){var n=e.item;return[t._v("\n                "+t._s(t.numberWithCommas(n.localAmount))+"\n            ")]}},{key:"item.rate",fn:function(e){var n=e.item;return[t._v("\n                "+t._s(t.numberWithCommas(n.rate))+"\n            ")]}},{key:"item.createdAt",fn:function(e){var n=e.item;return[t._v("\n                "+t._s(n.createdAt.split(".")[0])+"\n            ")]}}],null,!0)}):t._e()],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},808:function(t,e,n){var r=n(37).isFinite;t.exports=Number.isFinite||function(t){return"number"==typeof t&&r(t)}},818:function(t,e,n){n(11)({target:"Number",stat:!0},{isFinite:n(808)})},855:function(t,e,n){var content=n(856);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(16).default)("59f225a8",content,!0,{sourceMap:!1})},856:function(t,e,n){var r=n(15)((function(i){return i[1]}));r.push([t.i,".theme--light.v-input--switch .v-input--switch__thumb{color:#fff}.theme--light.v-input--switch .v-input--switch__track{color:rgba(0,0,0,.38)}.theme--light.v-input--switch.v-input--is-disabled:not(.v-input--is-dirty) .v-input--switch__thumb{color:#fafafa!important}.theme--light.v-input--switch.v-input--is-disabled:not(.v-input--is-dirty) .v-input--switch__track{color:rgba(0,0,0,.12)!important}.theme--dark.v-input--switch .v-input--switch__thumb{color:#bdbdbd}.theme--dark.v-input--switch .v-input--switch__track{color:hsla(0,0%,100%,.3)}.theme--dark.v-input--switch.v-input--is-disabled:not(.v-input--is-dirty) .v-input--switch__thumb{color:#424242!important}.theme--dark.v-input--switch.v-input--is-disabled:not(.v-input--is-dirty) .v-input--switch__track{color:hsla(0,0%,100%,.1)!important}.v-input--switch__thumb,.v-input--switch__track{background-color:currentColor;pointer-events:none;transition:inherit}.v-input--switch__track{border-radius:8px;height:14px;left:2px;opacity:.6;position:absolute;right:2px;top:calc(50% - 7px);width:36px}.v-input--switch__thumb{align-items:center;border-radius:50%;display:flex;height:20px;justify-content:center;position:relative;top:calc(50% - 10px);transition:.3s cubic-bezier(.25,.8,.5,1);width:20px}.v-input--switch .v-input--selection-controls__input{transition:opacity .3s cubic-bezier(.25,.8,.5,1);width:38px}.v-input--switch .v-input--selection-controls__ripple{top:calc(50% - 24px)}.v-input--switch.v-input--dense .v-input--switch__thumb{height:18px;width:18px}.v-input--switch.v-input--dense .v-input--switch__track{height:12px;width:32px}.v-input--switch.v-input--dense.v-input--switch--inset .v-input--switch__track{height:22px;left:-3px;top:calc(50% - 12px);width:44px}.v-input--switch.v-input--dense .v-input--selection-controls__ripple{top:calc(50% - 22px)}.v-input--switch.v-input--is-dirty.v-input--is-disabled .v-input--selection-controls__input{opacity:.6}.v-application--is-ltr .v-input--switch .v-input--selection-controls__ripple{left:-14px}.v-application--is-ltr .v-input--switch.v-input--dense .v-input--selection-controls__ripple{left:-12px}.v-application--is-ltr .v-input--switch.v-input--is-dirty .v-input--selection-controls__ripple,.v-application--is-ltr .v-input--switch.v-input--is-dirty .v-input--switch__thumb{transform:translate(20px)}.v-application--is-rtl .v-input--switch .v-input--selection-controls__ripple{right:-14px}.v-application--is-rtl .v-input--switch.v-input--dense .v-input--selection-controls__ripple{right:-12px}.v-application--is-rtl .v-input--switch.v-input--is-dirty .v-input--selection-controls__ripple,.v-application--is-rtl .v-input--switch.v-input--is-dirty .v-input--switch__thumb{transform:translate(-20px)}.v-input--switch:not(.v-input--switch--flat):not(.v-input--switch--inset) .v-input--switch__thumb{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.v-input--switch--inset .v-input--selection-controls__input,.v-input--switch--inset .v-input--switch__track{width:48px}.v-input--switch--inset .v-input--switch__track{border-radius:14px;height:28px;left:-4px;opacity:.32;top:calc(50% - 14px)}.v-application--is-ltr .v-input--switch--inset .v-input--selection-controls__ripple,.v-application--is-ltr .v-input--switch--inset .v-input--switch__thumb{transform:translate(0)!important}.v-application--is-rtl .v-input--switch--inset .v-input--selection-controls__ripple,.v-application--is-rtl .v-input--switch--inset .v-input--switch__thumb{transform:translate(-6px)!important}.v-application--is-ltr .v-input--switch--inset.v-input--is-dirty .v-input--selection-controls__ripple,.v-application--is-ltr .v-input--switch--inset.v-input--is-dirty .v-input--switch__thumb{transform:translate(20px)!important}.v-application--is-rtl .v-input--switch--inset.v-input--is-dirty .v-input--selection-controls__ripple,.v-application--is-rtl .v-input--switch--inset.v-input--is-dirty .v-input--switch__thumb{transform:translate(-26px)!important}",""]),r.locals={},t.exports=r},857:function(t,e,n){var r=n(59),o=Math.floor;t.exports=Number.isInteger||function(t){return!r(t)&&isFinite(t)&&o(t)===t}},859:function(t,e,n){n(11)({target:"Number",stat:!0},{isInteger:n(857)})},869:function(t,e,n){"use strict";n(10),n(7),n(9),n(5),n(12),n(8),n(13);var r=n(99),o=n(3),c=(n(178),n(179),n(446),n(855),n(175)),l=n(49),d=n(336),f=n(86),m=n(251),h=n(1),v=["title"];function x(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function w(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}e.a=c.a.extend({name:"v-switch",directives:{Touch:d.a},props:{inset:Boolean,loading:{type:[Boolean,String],default:!1},flat:{type:Boolean,default:!1}},computed:{classes:function(){return w(w({},l.a.options.computed.classes.call(this)),{},{"v-input--selection-controls v-input--switch":!0,"v-input--switch--flat":this.flat,"v-input--switch--inset":this.inset})},attrs:function(){return{"aria-checked":String(this.isActive),"aria-disabled":String(this.isDisabled),role:"switch"}},validationState:function(){return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":null!==this.hasColor?this.computedColor:void 0},switchData:function(){return this.setTextColor(this.loading?void 0:this.validationState,{class:this.themeClasses})}},methods:{genDefaultSlot:function(){return[this.genSwitch(),this.genLabel()]},genSwitch:function(){var t=this.attrs$,e=(t.title,Object(r.a)(t,v));return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.genInput("checkbox",w(w({},this.attrs),e)),this.genRipple(this.setTextColor(this.validationState,{directives:[{name:"touch",value:{left:this.onSwipeLeft,right:this.onSwipeRight}}]})),this.$createElement("div",w({staticClass:"v-input--switch__track"},this.switchData)),this.$createElement("div",w({staticClass:"v-input--switch__thumb"},this.switchData),[this.genProgress()])])},genProgress:function(){return this.$createElement(f.c,{},[!1===this.loading?null:this.$slots.progress||this.$createElement(m.a,{props:{color:!0===this.loading||""===this.loading?this.color||"primary":this.loading,size:16,width:2,indeterminate:!0}})])},onSwipeLeft:function(){this.isActive&&this.onChange()},onSwipeRight:function(){this.isActive||this.onChange()},onKeydown:function(t){(t.keyCode===h.y.left&&this.isActive||t.keyCode===h.y.right&&!this.isActive)&&this.onChange()}}})},896:function(t,e,n){"use strict";n.r(e);var r=n(787),o=n(841),c=n(316),l=n(313),d=n(18),f=n(317),m=n(785),h=n(794),v=n(759),x=n(312),w=n(167),_=n(784),y=n(90),k=n(782),I=n(113),D=n(816),O=(n(34),n(131),n(63),n(35),n(69),n(54),n(7),n(67),n(93),n(53),n(10),n(9),n(12),n(8),n(13),n(3)),A=n(27),C=n(20),L=(n(92),n(22),n(104),n(66),n(5),n(30),n(121),n(818),n(85),n(843)),E=n(40),R=n(267),j=n(36),S=n(823);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function N(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Object(O.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function F(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var P={components:{PricingOption:R.default,CancelTicketForm:S.default},props:{headerId:{type:Number,default:0},isQuotation:{type:Boolean,default:!1},isUpdate:{type:Boolean,default:!1},updateAllow:{type:Boolean,default:!0}},directives:{commaThousand:L.a},created:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isUpdate){e.next=8;break}return console.log("View old record"),t.isloading=!0,e.next=5,t.loadTransaction();case 5:t.isloading=!1,e.next=15;break;case 8:n=(new Date).toISOString().substr(0,10),t.transaction.bookingDate=n,t.transaction.deliveryDate=n,t.transaction.clientId=1,t.transaction.paymentId=1,t.transaction.currencyId=1,t.newRow();case 15:return e.next=17,t.loadVendor();case 17:case"end":return e.stop()}}),e)})))()},methods:{loadVendor:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("api/vendor/find").then((function(e){t.isloading=!0,t.vendorList=e.data})).catch((function(t){console.log("Error ",t)}));case 2:t.isloading=!1;case 3:case"end":return e.stop()}}),e)})))()},cancelOrder:function(){this.onlineCustomerId=this.transaction.dynamic_customer.id,this.cancelConfirmDialog=!0},updatePricing:function(t){var e=this,n=t.amount;console.log("New pricing ".concat(n)),console.log("New pricing ".concat(JSON.stringify(this.transaction.lines[0])));var r=this.transaction.lines.findIndex((function(t){return t.productId==e.productPricingSelected}));if(!(r<0)){var o=this.transaction.lines[r].qty,c=this.transaction.lines[r].rate,l=this.transaction.lines[r].discount;if("Price"!=t.type){var d=this.transaction.lines[r].price,f=d*n/100+d;this.transaction.lines[r].total=o*c*f-l,this.transaction.lines[r].price=f}else this.transaction.lines[r].total=o*c*n-l,this.transaction.lines[r].price=n}},pricingLogig:function(t){console.log("PRINCING CLICK....".concat(JSON.stringify(t))),this.productPricingSelected=t.productId,this.pricingDialogKey+=1,this.pricingDialog=!0},findCurrency:function(t){return this.findAllCurrency.find((function(e){return e.id==t}))},quotationPreview:function(){var path=this.isQuotation?"PDFQuotation":"PDFInvoice";window.open("/admin/".concat(path,"/").concat(this.headerId),"_blank")},handleKeyDown:function(t){"Tab"===t.key&&(console.log("Tab key pressed"),this.newRow())},currencyChange:function(){var t=this,e=this.currencyList.find((function(e){return e.id==t.transaction.currencyId}));e&&(this.transaction.exchangeRate=e.rate,console.log("Rate exchange ".concat(e.rate," real value ").concat(this.transaction.exchangeRate)))},deleteItem:function(t){var e=this;return Object(C.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.id){n.next=8;break}return console.log("Line has id"),e.isloading=!0,n.next=5,e.$axios.delete("api/".concat(e.apiLine,"/line/find/").concat(t.id)).then((function(n){e.transaction.lines.splice(e.transaction.lines.indexOf(t),1)})).catch((function(t){Object(j.j)(e.$swal,"Error","Operation fail "+t.Error)}));case 5:e.isloading=!1,n.next=10;break;case 8:e.transaction.lines.splice(e.transaction.lines.indexOf(t),1),console.log("Line has no id");case 10:case"end":return n.stop()}}),n)})))()},quantityChange:function(data){console.log("Qty change");var t=this.transaction.lines.indexOf(data),e=Object(j.h)(this.transaction.lines[t].qty,",",""),n=Object(j.h)(this.transaction.lines[t].rate,",",""),r=Object(j.h)(this.transaction.lines[t].price,",","");this.transaction.lines[t].total=n*e*r},unitRateChange:function(data){console.log("Unit rate change");var t=this.transaction.lines.indexOf(data),e=Object(j.h)(this.transaction.lines[t].qty,",",""),n=Object(j.h)(this.transaction.lines[t].rate,",",""),r=Object(j.h)(this.transaction.lines[t].price,",","");this.transaction.lines[t].total=n*e*r},priceChange:function(data){var t=this.transaction.lines.indexOf(data),e=Object(j.h)(this.transaction.lines[t].qty,",",""),n=Object(j.h)(this.transaction.lines[t].rate,",",""),r=Object(j.h)(this.transaction.lines[t].price,",","");console.log("Price change...",r),this.transaction.lines[t].total=n*e*r},discountChange:function(data){console.log("Discount change");var t=this.transaction.lines.indexOf(data),e=Object(j.h)(this.transaction.lines[t].qty,",",""),n=Object(j.h)(this.transaction.lines[t].rate,",",""),r=Object(j.h)(this.transaction.lines[t].price,",","");this.transaction.lines[t].total=n*e*r},unitChange:function(data){console.log("Unit change");var t=this.unitList.find((function(t){return t.id==data.unitId}));if(null!=t){var e=this.transaction.lines.indexOf(data);this.transaction.lines[e].rate=t.rate;var n=Object(j.h)(this.transaction.lines[e].qty,",",""),r=Object(j.h)(this.transaction.lines[e].price,",","");this.transaction.lines[e].total=t.rate*n*r}},productChange:function(data){console.log("Product change");var t=this.productList.find((function(t){return t.id==data.productId}));if(null!=t){var e=this.transaction.lines.indexOf(data),n=this.findCurrency(t.saleCurrencyId);console.log("$$$$$$ ".concat(n.id," $$$$$$"));var r=t.cost_price*n.rate;this.transaction.lines[e].price=r;var o=Object(j.h)(this.transaction.lines[e].qty,",",""),c=Object(j.h)(this.transaction.lines[e].price,",",""),l=Object(j.h)(this.transaction.lines[e].rate,",","");this.transaction.lines[e].total=l*o*c}else console.log("Product is not define")},newRow:function(){this.transaction.lines.push({qty:0,rate:1,price:0,total:0,isActive:!0,productId:0,unitId:1})},openCustomerDialog:function(){this.customerDialog=!0},loadTransaction:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("api/".concat(t.apiLine,"/find/").concat(t.headerId)).then((function(e){t.transaction=e.data,console.log("Data ",e.data)})).catch((function(e){Object(j.j)(t.$swal,"Error","Could no load data "+e.Error)}));case 2:case"end":return e.stop()}}),e)})))()},post:function(){this.errorLineNumber=null;var t,e=F(this.transaction.lines);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(this.errorLineNumber=this.transaction.lines.indexOf(n),!this.validateLine(n,this.errorLineNumber+1))return void(this.sheet=!0);n.total=n.qty*n.rate*n.price-n.discount}}catch(t){e.e(t)}finally{e.f()}console.log("******** No error found process posting ********"),this.errorLineNumber=null},validateLine:function(t,e){var n=t.qty,r=t.rate,o=t.price,c=t.discount,l=t.total,d=t.productId,f=t.unitId;return c=parseInt(c),r=parseInt(r),n=parseInt(n),!Number.isFinite(n)||Number(n)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ຈຳນວນ ຕ້ອງໃຫຍ່ກ່ອນ 0  current value is ").concat(n,"********"),!1):!Number.isFinite(r)||Number(r)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ອັດຕາຫົວຫນ່ວຍ ຕ້ອງໃຫຍ່ກ່ອນ 0  current value is ").concat(r,"********"),!1):("string"==typeof o&&(o=o.replace(/,/g,"")),o=Number(o),console.log("Type of price ",Object(A.a)(o)," [price] ",o),!Number.isFinite(o)||Number(o)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ລາຄາ ຕ້ອງໃຫຍ່ກ່ອນ 0  current value is ").concat(o,"********"),!1):(console.log("Type of discount1 ",Object(A.a)(c)),!Number.isFinite(l)||Number(l)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ຍອດລວມ ຕ້ອງໃຫຍ່ກ່ອນ 0 current value is ").concat(l,"********"),!1):Number.isFinite(d)?!!Number.isFinite(f)||(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ຫົວຫນ່ວຍບໍ່ຖືກຕ້ອງ  current value is ").concat(f,"********"),!1):(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ສິນຄ້າບໍ່ຖືກຕ້ອງ  current value is ").concat(d,"********"),!1)))},validateHeader:function(){return this.headerError=!0,this.sheet=!0,console.log("=== currency id ",this.transaction.currencyId),this.transaction.currencyId?0==this.transaction.lines.length?(this.validateErrorMessage="******** Error Header ບໍ່ມີລາຍການສິນຄ້າ ********",!1):(this.sheet=!1,this.headerError=!1,!0):(this.validateErrorMessage="******** Error Currency in Header #".concat(this.transaction.currencyId," ບໍ່ສາມາດເປັນຄ່າວ່າງ ********"),!1)},getFormatNum:function(t){return(new Intl.NumberFormat).format(t)},toggleDialog:function(){this.$emit("close-dialog")},postToInvoice:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isloading&&t.validateHeader()){e.next=2;break}return e.abrupt("return");case 2:t.isloading=!0,t.errorLineNumber=null,n=[],r=F(t.transaction.lines),e.prev=6,r.s();case 8:if((o=r.n()).done){e.next=21;break}if(c=o.value,t.errorLineNumber=t.transaction.lines.indexOf(c),t.validateLine(c,t.errorLineNumber+1)){e.next=15;break}return t.sheet=!0,t.isloading=!1,e.abrupt("return");case 15:c.discount=parseInt(Object(j.h)(c.discount,",","")),c.qty=parseInt(Object(j.h)(c.qty,",","")),c.rate=parseInt(Object(j.h)(c.rate,",","")),n.push(c);case 19:e.next=8;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),r.e(e.t0);case 26:return e.prev=26,r.f(),e.finish(26);case 29:for(l=0,d=n;l<d.length;l++)d[l].id=null;return console.log("******** No error found process posting ********"),t.errorLineNumber=null,t.transaction.userId=t.user.id,t.transaction.total=t.grandTotal,t.transaction.referenceNo=t.headerId,t.transaction.lines=n,t.transaction.locationId=t.currentTerminal.locationId,console.log("Amount total ".concat(t.transaction.total)),e.next=40,t.$axios.post("api/sale/create",t.transaction).then((function(e){t.$emit("reload"),Object(j.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")})).catch((function(e){console.error(e),Object(j.j)(t.$swal,"Error",e.response.data);var n=e.response.data.split("#")[1];null!=n&&(t.validateErrorMessage="********  ສິນຄ້າໃນສ້າງບໍ່ພຽງພໍ ********",t.errorLineNumber=t.transaction.lines.indexOf(t.transaction.lines.find((function(t){return t.productId==n}))),t.sheet=!0),console.log("Error ===>: "+e)}));case 40:t.isloading=!1;case 41:case"end":return e.stop()}}),e,null,[[6,23,26,29]])})))()},postTransaction:function(){var t=this;return Object(C.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isloading&&t.validateHeader()){e.next=2;break}return e.abrupt("return");case 2:t.isloading=!0,t.errorLineNumber=null,n=F(t.transaction.lines),e.prev=5,n.s();case 7:if((r=n.n()).done){e.next=20;break}if(o=r.value,t.errorLineNumber=t.transaction.lines.indexOf(o),t.validateLine(o,t.errorLineNumber+1)){e.next=14;break}return t.sheet=!0,t.isloading=!1,e.abrupt("return");case 14:o.discount=parseInt(Object(j.h)(o.discount,",","")),o.qty=parseInt(Object(j.h)(o.qty,",","")),o.rate=parseInt(Object(j.h)(o.rate,",","")),o.price=parseInt(Object(j.h)(o.price,",",""));case 18:e.next=7;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),n.e(e.t0);case 25:return e.prev=25,n.f(),e.finish(25);case 28:if(console.log("******** No error found process posting ********"),t.errorLineNumber=null,t.transaction.userId=t.user.id,t.transaction.total=t.grandTotal,t.transaction.locationId=t.currentTerminal.locationId,console.log("Amount total ".concat(t.transaction.total)),!t.isUpdate){e.next=39;break}return e.next=37,t.$axios.put("api/".concat(t.apiLine,"/update/").concat(t.headerId),t.transaction).then((function(e){t.$emit("reload"),t.$emit("close-dialog"),Object(j.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")})).catch((function(e){console.error(e),Object(j.j)(t.$swal,"Error",e.response.data);var n=e.response.data.split("#")[1];if(null!=n){var r=t.productList.find((function(t){return t.id==n}));t.validateErrorMessage="********  ສິນຄ້າ ".concat(r.pro_name," ໃນສ້າງບໍ່ພຽງພໍ ********"),t.errorLineNumber=t.transaction.lines.indexOf(t.transaction.lines.find((function(t){return t.productId==n}))),t.sheet=!0}console.log("Error ===>: "+e)}));case 37:e.next=41;break;case 39:return e.next=41,t.$axios.post("api/".concat(t.apiLine,"/create"),t.transaction).then((function(e){t.$emit("reload"),t.$emit("close-dialog"),Object(j.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")})).catch((function(e){console.error(e),Object(j.j)(t.$swal,"Error",e.response.data);var n=e.response.data.split("#")[1];null!=n&&(t.validateErrorMessage="********  ສິນຄ້າໃນສ້າງບໍ່ພຽງພໍ ********",t.errorLineNumber=t.transaction.lines.indexOf(t.transaction.lines.find((function(t){return t.productId==n}))),t.sheet=!0),console.log("Error ===>: "+e)}));case 41:t.isloading=!1;case 42:case"end":return e.stop()}}),e,null,[[5,22,25,28]])})))()}},computed:N(N({},Object(E.c)(["findAllProduct","findAllClient","findAllPayment","findAllUnit","findAllCurrency","findAllTerminal","findSelectedTerminal"])),{},{clientList:function(){return this.findAllClient},currentTerminal:function(){var t=this;return console.log("ALL TEMINAL ".concat(this.findAllTerminal.length," SELECTED ").concat(this.findSelectedTerminal)),this.findAllTerminal.find((function(e){return e.id==t.findSelectedTerminal}))},user:function(){return this.$auth.user||""},apiLine:function(){return"purchasing"},productList:function(){return this.findAllProduct},paymentList:function(){return this.findAllPayment},unitList:function(){return this.findAllUnit},currencyList:function(){return this.findAllCurrency},numberRule:function(){return[function(t){return null!=t&&""!==t||"Field is required"},function(t){return/^(\d+(\.\d{1,2})?)|(0(\.\d{1,2})?)$/.test(t)||"Rate must be a number with up to 2 decimal places"}]},grandTotal:function(){return this.transaction.lines.reduce((function(t,e){return t+e.total}),0)}}),data:function(){return{poStatus:[{name:"PENDING"},{name:"PARTIAL"},{name:"COMPLETED"}],cancelConfirmDialog:!1,productPricingSelected:null,pricingDialogKey:1,pricingDialog:!1,search:"",vendorList:[],numberCommaRule:function(t){return/^[0-9,]*$/.test(t)||"Only numbers and commas are allowed"},headerError:!1,customerDialog:!1,validateErrorMessage:"",sheet:!1,errorLineNumber:null,onlineCustomerId:null,isloading:!1,transaction:{vendorId:null,status:"PENDING",isActive:!0,exchangeRate:1,total:0,lines:[]},headers:[{text:"#",align:"start",value:""},{text:"ສິນຄ້າ",align:"start",value:"product.pro_name"},{text:"ຈຳນວນ",align:"end",value:"qty"},{text:"ຫົວຫນ່ວຍ",align:"end",value:"unitId",sortable:!0},{text:"unit rate",align:"end",value:"rate",sortable:!0},{text:"ລາຄາ",align:"end",value:"price",sortable:!0},{text:"ລວມ",align:"end",value:"total",sortable:!1},{text:"delete",align:"end",value:"id",sortable:!1}]}}},M=n(32),component=Object(M.a)(P,(function(){var t=this,e=t._self._c;return e("div",[e(v.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(v.a,{attrs:{"max-width":"1024"},model:{value:t.customerDialog,callback:function(e){t.customerDialog=e},expression:"customerDialog"}},[e("customer-list",{on:{"close-dialog":function(e){t.customerDialog=!1}}})],1),t._v(" "),e(v.a,{attrs:{"max-width":"1024"},model:{value:t.cancelConfirmDialog,callback:function(e){t.cancelConfirmDialog=e},expression:"cancelConfirmDialog"}},[e("cancel-ticket-form",{attrs:{id:t.headerId,customerId:t.onlineCustomerId},on:{refresh:function(e){return t.$emit("reload")},"close-dialog":function(e){t.cancelConfirmDialog=!1}}})],1),t._v(" "),e(v.a,{attrs:{"max-width":"1024"},model:{value:t.pricingDialog,callback:function(e){t.pricingDialog=e},expression:"pricingDialog"}},[e("pricing-option",{key:t.pricingDialogKey,attrs:{isBackend:!0,"record-id":t.productPricingSelected},on:{"new-price-update":t.updatePricing,"close-dialog":function(e){t.pricingDialog=!1}}})],1),t._v(" "),e(o.a,{attrs:{inset:""},model:{value:t.sheet,callback:function(e){t.sheet=e},expression:"sheet"}},[e(y.a,{staticClass:"text-center",attrs:{height:"200px"}},[e(c.a,{staticClass:"mt-6",attrs:{text:"",color:"error"},on:{click:function(e){t.sheet=!t.sheet}}},[t._v("\n                close\n            ")]),t._v(" "),e("div",{staticClass:"my-3"},[t._v("\n                "+t._s(t.validateErrorMessage)+"\n            ")])],1)],1),t._v(" "),e(l.a,[e(d.b,[e(_.a,[e(m.a,{attrs:{cols:"6"}},[e(f.a,{staticClass:"pa-5",attrs:{color:"primary",label:"","text-color":"white"}},[e(w.a,{attrs:{start:""}},[t._v("mdi-label")]),t._v(" "),e("h3",[t._v("PURCHASING")])],1)],1),t._v(" "),e(m.a,{staticStyle:{"text-align":"right"},attrs:{cols:"6"}},[t.isQuotation?e(c.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.postToInvoice}},[e("span",{staticClass:"mdi mdi-cancel"}),t._v("Make to invoice\n                    ")]):t._e(),t._v(" "),e(c.a,{staticClass:"warning",attrs:{disabled:!t.isUpdate||!t.transaction.isActive,size:"large",variant:"outlined",rounded:""},on:{click:t.cancelOrder}},[e("span",{staticClass:"mdi mdi-printer-outline"}),t._v("ຍົກເລີກບິນ\n                    ")]),t._v(" "),e(c.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.quotationPreview}},[e("span",{staticClass:"mdi mdi-printer-outline"}),t._v("Print\n                    ")])],1)],1)],1),t._v(" "),e(x.a),t._v(" "),e(d.c,{staticClass:"pa-1"},[e(l.a,{staticClass:"pa-1",style:t.headerError?"outline:1px solid red":""},[t._v("\n                RECID: "+t._s(t.transaction.id)+"\n                "),e(d.c,[e("div",[e(_.a,[e(m.a,{attrs:{cols:"4"}},[e(_.a,[e(m.a,{attrs:{cols:"12"}},[e(I.a,{attrs:{type:"date",label:"ວັນທີ*",hint:"ເດຶອນ/ວັນ/ປີ 12/31/2023"},model:{value:t.transaction.bookingDate,callback:function(e){t.$set(t.transaction,"bookingDate",e)},expression:"transaction.bookingDate"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12"}},[e(r.a,{attrs:{"item-text":"name","item-value":"name",items:t.poStatus,label:"ສະຖານະ*"},model:{value:t.transaction.status,callback:function(e){t.$set(t.transaction,"status",e)},expression:"transaction.status"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12"}},[e(I.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"Q-ReferenceNo",disabled:""},model:{value:t.transaction.referenceNo,callback:function(e){t.$set(t.transaction,"referenceNo",e)},expression:"transaction.referenceNo"}})],1)],1)],1),t._v(" "),e(m.a,{attrs:{cols:"4"}},[e(_.a,[e(m.a,{attrs:{cols:"12"}},[e(I.a,{attrs:{type:"date",label:"ວັນທີຮັບເຄື່ອງ*",hint:"ເດຶອນ/ວັນ/ປີ 12/31/2023"},model:{value:t.transaction.deliveryDate,callback:function(e){t.$set(t.transaction,"deliveryDate",e)},expression:"transaction.deliveryDate"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12"}},[e(r.a,{attrs:{"item-text":"name","item-value":"id",items:t.vendorList,label:"ຮ້ານຄ້າ*"},model:{value:t.transaction.vendorId,callback:function(e){t.$set(t.transaction,"vendorId",e)},expression:"transaction.vendorId"}})],1),t._v(" "),e(m.a,{attrs:{cols:"6"}},[e(r.a,{attrs:{"item-text":"code","item-value":"id",items:t.currencyList,label:"ສະກຸນເງິນ*"},on:{input:t.currencyChange},model:{value:t.transaction.currencyId,callback:function(e){t.$set(t.transaction,"currencyId",e)},expression:"transaction.currencyId"}})],1),t._v(" "),e(m.a,{attrs:{cols:"6"}},[t._v("ອັດຕາແລກປ່ຽນ: "+t._s(t.getFormatNum(t.transaction.exchangeRate)))])],1)],1),t._v(" "),e(m.a,{staticStyle:{"text-align":"end"},attrs:{cols:"4"}},[e(_.a,[e(m.a,{attrs:{cols:"12"}},[e(D.a,{attrs:{label:"Notes"},model:{value:t.transaction.remark,callback:function(e){t.$set(t.transaction,"remark",e)},expression:"transaction.remark"}})],1),t._v(" "),t.transaction.user?e(m.a,{attrs:{cols:"12"}},[t._v("ຜູ້ລົງ: "+t._s(t.transaction.user.cus_id)+"\n                                    ")]):t._e(),t._v(" "),t.transaction.user?e(m.a,{attrs:{cols:"12"}},[t._v("ຊື່: "+t._s(t.transaction.user.cus_name))]):t._e(),t._v(" "),e(m.a,{attrs:{cols:"12"}},[e(I.a,{attrs:{disabled:""},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",{staticStyle:{color:"black","font-weight":"bold"}},[t._v(t._s("Total Amount:\n                                                    ".concat(t.getFormatNum(t.grandTotal))))])]},proxy:!0}])})],1)],1)],1)],1)],1)])],1),t._v(" "),e(x.a),t._v(" "),t.transaction.lines?e(h.a,{attrs:{headers:t.headers,search:t.search,items:t.transaction.lines},scopedSlots:t._u([{key:"item",fn:function(n){var o=n.item;return[e("tr",{style:t.errorLineNumber==t.transaction.lines.indexOf(o)?"outline: 1px solid red":""},[e("td",{class:t.errorLineNumber==t.transaction.lines.indexOf(o)?"error":""},[t._v("\n                            "+t._s(t.transaction.lines.indexOf(o)+1)+"\n                        ")]),t._v(" "),e("td",[e(r.a,{attrs:{"item-text":"pro_name","item-value":"id",items:t.productList,label:"ສິນຄ້າ*"},on:{input:function(e){return t.productChange(o)}},model:{value:o.productId,callback:function(e){t.$set(o,"productId",e)},expression:"item.productId"}})],1),t._v(" "),e("td",[e(I.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ຈຳນວນ",rules:[t.numberCommaRule]},on:{input:function(e){return t.quantityChange(o)}},model:{value:o.qty,callback:function(e){t.$set(o,"qty",e)},expression:"item.qty"}})],1),t._v(" "),e("td",[e(r.a,{attrs:{"item-text":"name","item-value":"id",items:t.unitList,label:"ຫົວຫນ່ວຍ*"},on:{input:function(e){return t.unitChange(o)}},model:{value:o.unitId,callback:function(e){t.$set(o,"unitId",e)},expression:"item.unitId"}})],1),t._v(" "),e("td",[e(I.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ຈນ ຕໍ່ ຫົວຫນ່ວຍ",rules:[t.numberCommaRule]},on:{input:function(e){return t.unitRateChange(o)}},model:{value:o.rate,callback:function(e){t.$set(o,"rate",e)},expression:"item.rate"}})],1),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[e(I.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ລາຄາ",rules:[t.numberCommaRule]},on:{input:function(e){return t.priceChange(o)}},model:{value:o.price,callback:function(e){t.$set(o,"price",e)},expression:"item.price"}})],1),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("\n                            "+t._s(t.getFormatNum(o.total))+"\n                        ")]),t._v(" "),e("td",[e(c.a,{attrs:{disabled:!t.transaction.isActive||!t.updateAllow,color:"error",text:""},on:{click:function(e){return t.deleteItem(o)},keydown:t.handleKeyDown}},[e("i",{staticClass:"fas fa-trash"})])],1)])]}}],null,!1,378898369)}):t._e(),t._v(" "),0==t.transaction.lines.length?e("tr",[e("td",[e(c.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.newRow}},[e("span",{staticClass:"mdi mdi-plus"})])],1)]):t._e()],1),t._v(" "),e(d.a,[e(k.a),t._v(" "),e(c.a,{attrs:{color:"warning",rounded:"",variant:"text"},on:{click:t.toggleDialog}},[t._v("\n                Close\n            ")]),t._v(" "),e(c.a,{attrs:{disabled:!t.transaction.isActive||!t.updateAllow,color:"primary",rounded:"",variant:"text"},on:{click:t.postTransaction}},[t._v("\n                Save\n            ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default,CustomerList:n(268).default,CancelTicketForm:n(823).default,PricingOption:n(267).default})},902:function(t,e,n){"use strict";n.r(e);var r=n(787),o=n(316),c=n(313),l=n(18),d=n(785),f=n(780),m=n(794),h=n(759),v=n(312),x=n(786),w=n(784),_=n(782),y=n(869),k=n(113),I=(n(63),n(35),n(69),n(54),n(7),n(67),n(93),n(20)),D=(n(92),n(22),n(34),n(39),n(51),n(121),n(5),n(8),n(818),n(859),n(53),n(44),n(337));n(36);function O(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var C={props:{isEdit:{type:Boolean,default:!1},headerId:{type:Number,default:null}},data:function(){return{productList:[],currencyList:[],showAddRowDialog:!1,dialog:!1,title:"ສ້າງ ໃບສັ່ງຊື້",valid:!1,isLoading:!1,form:{header:{bookingDate:"",deliveryDate:"",vendor:"Acme Inc.",notes:"Please deliver to loading dock B.",isActive:!0,locking_session_id:""}},rules:{required:function(t){return!!t||"This field is required"},dateAfter:function(t){return function(e){return!t||(new Date(e)>=new Date(t)||"Date must be after start date")}},dateAfterToday:function(t){return new Date(t)>=new Date||"Date must be after today"},number:function(t){return!isNaN(parseFloat(t))&&isFinite(t)||"Value must be a number"}},headers:[{text:"ສິນຄ້າ",value:"date"},{text:"ລາຄາຕໍ່ຫນ່ວຍ",value:"reach"},{text:"ຈຳນວນ",value:"results"},{text:"ສະກຸນ",value:"reach"},{text:"ອັດຕາແລກປ່ຽນ",value:"comments"},{text:"ລວມ",value:"purchaseQty"}],lines:[],lineError:[],newRow:{rate:1,qty:1,price:25,total:250,isActive:!0,currencyId:1,productId:2,locking_session_id:""}}},mounted:function(){var t=(new Date).toISOString().substr(0,10);this.form.header.bookingDate=t,this.form.header.deliveryDate=t,this.loadPurchaseOrder(),this.loadProduct(),this.loadCurrency()},computed:{dateRules:function(){return[function(t){return!!t||"Field is required"},function(t){return/^(\d{4})-(\d{2})-(\d{2})$/.test(t)||"Invalid date format (YYYY-MM-DD)"}]},rateRules:function(){return[function(t){return!!t||"Rate is required"},function(t){return/^[0-9]+(\.[0-9]{1,2})?$/.test(t)||"Rate must be a number with up to 2 decimal places"}]},qtyRules:function(){return[function(t){return!!t||"Quantity is required"},function(t){return/^\d+$/.test(t)||"Quantity must be a whole number"}]},priceRules:function(){return[function(t){return!!t||"Price is required"},function(t){return/^\d+(\.\d{1,2})?$/.test(t)||"Price must be a number with up to 2 decimal places"}]},totalRules:function(){return[function(t){return!!t||"Total is required"},function(t){return/^\d+(\.\d{1,2})?$/.test(t)||"Total must be a number with up to 2 decimal places"}]},currencyIdRules:function(){return[function(t){return!!t||"Currency ID is required"},function(t){return/^\d+$/.test(t)||"Currency ID must be a whole number"}]},productIdRules:function(){return[function(t){return!!t||"Product ID is required"},function(t){return/^\d+$/.test(t)||"Product ID must be a whole number"}]}},methods:{deleteItem:function(t){var e=this,n=this.lines.indexOf(t);n>-1&&(this.isEdit&&t.id?Object(D.a)(this.$swal,"warning",Object(I.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("Delete record function"),e.isLoading=!0,r.next=4,e.$axios.delete("/api/purchasing/line/find/".concat(t.id)).then((function(t){console.log("response=>",t.data),t.data.includes("successfully")&&e.lines.splice(n,1)})).catch((function(t){Object(D.b)(e.$swal,"ເກີດຂໍ້ຜິດພາດ",t.response.data)}));case 4:e.isLoading=!1;case 5:case"end":return r.stop()}}),r)})))):this.lines.splice(n,1))},open:function(){this.dialog=!0},close:function(){this.dialog=!1},validateLine:function(){var t=this;this.lines.forEach((function(e,n){var r=e.rate,o=e.qty,c=e.price,l=e.total,d=e.isActive,f=e.currencyId,m=e.productId;console.log("===>Rate ",r),r&&Number.isFinite(r)||t.lineError.push(" Rate must be a number"),o&&Number.isInteger(o)||t.lineError.push(" Quantity must be an integer"),c&&Number.isFinite(c)||t.lineError.push(" Price must be a number"),l&&Number.isFinite(l)||t.lineError.push(" Total must be a number"),"boolean"!=typeof d&&t.lineError.push(" isActive must be a boolean"),f&&Number.isInteger(f)||t.lineError.push(" Currency ID must be an integer"),m&&Number.isInteger(m)||t.lineError.push(" Product ID must be an integer")}))},loadPurchaseOrder:function(){var t=this;return Object(I.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoading=!0,!t.isEdit){e.next=4;break}return e.next=4,t.$axios.get("/api/purchasing/find/".concat(t.campaignId)).then((function(e){t.form.header=e.data,t.form.header.start=e.data.start.split("T")[0],t.form.header.end=e.data.end.split("T")[0],t.campaignEntry.length=0;var n,r=O(e.data.entries);try{for(r.s();!(n=r.n()).done;){var o=n.value,c=o;c.date=o.date.split("T")[0],t.campaignEntry.push(c)}}catch(t){r.e(t)}finally{r.f()}})).catch((function(t){console.log("Load cammpaign error",t)}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;return Object(I.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoading){e.next=20;break}if(t.isLoading=!0,0!=t.lines.length){e.next=5;break}return t.isLoading=!1,e.abrupt("return",Object(D.b)(t.$swal,"ເກີດຂໍ້ຜິດພາດ","ບໍ່ມີລາຍການ ກະລຸນາເພີ່ມຢ່າງນ້ອຍ 1 ລາຍການ"));case 5:if(t.validateLine(),!(t.lineError.length>0)){e.next=10;break}return Object(D.b)(t.$swal,"ເກີດຂໍ້ຜິດພາດ","ກະລຸນາ ກວດຂໍ້ມູນຄືນໃຫ້ຖືກຕ້ອງ ".concat(t.lineError," ")),t.isLoading=!1,e.abrupt("return",t.lineError.length=0);case 10:if(t.form.header.lines=t.lines,!t.isEdit||!t.headerId){e.next=17;break}return console.log("====> update campaign"),e.next=15,t.$axios.put("/api/purchasing/update/".concat(t.headerId),t.form.header).then((function(e){200==e.status?Object(D.c)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ"):Object(D.b)(t.$swal,"ເກີດຂໍ້ຜິດພາດ",e.data)})).catch((function(e){Object(D.b)(t.$swal,"ເກີດຂໍ້ຜິດພາດ",e.response.data)}));case 15:e.next=19;break;case 17:return e.next=19,t.$axios.post("/api/purchasing/create",t.form.header).then((function(e){200==e.status?Object(D.c)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ"):Object(D.b)(t.$swal,"ເກີດຂໍ້ຜິດພາດ",e.data)})).catch((function(e){Object(D.b)(t.$swal,"ເກີດຂໍ້ຜິດພາດ",e.response.data)}));case 19:t.isLoading=!1;case 20:t.close();case 21:case"end":return e.stop()}}),e)})))()},addRow:function(){this.$refs.addRowForm.validate()&&(this.lines.push(this.newRow),this.newRow={rate:2.5,qty:10,price:25,total:250,isActive:!0},this.showAddRowDialog=!1)},loadProduct:function(){var t=this;return Object(I.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.$axios.get("product_mobile_f").then((function(e){t.productList=e.data.map((function(t){return t})),console.log("all data1: ",t.productList[0].img_path)})).catch((function(t){console.log("Data: "+t)}));case 3:t.isLoading=!1;case 4:case"end":return e.stop()}}),e)})))()},loadCurrency:function(){var t=this;return Object(I.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.$axios.get("api/currency/find").then((function(e){t.currencyList=e.data.map((function(t){return t}))})).catch((function(t){console.log("Data: "+t)}));case 3:t.isLoading=!1;case 4:case"end":return e.stop()}}),e)})))()}}},L=n(32),component=Object(L.a)(C,(function(){var t=this,e=t._self._c;return e("div",[e(h.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[e("loading-indicator")],1),t._v(" "),e(h.a,{attrs:{"max-width":"800"},model:{value:t.showAddRowDialog,callback:function(e){t.showAddRowDialog=e},expression:"showAddRowDialog"}},[e(c.a,[e(l.d,[t._v("ເພີ່ມລາຍການໃຫມ່")]),t._v(" "),e(l.c,[e(x.a,{ref:"addRowForm"},[e(r.a,{attrs:{"item-text":"pro_name","item-value":"id",items:t.productList,label:"ເລືອກສິນຄ້າ *",rules:t.productIdRules},model:{value:t.newRow.productId,callback:function(e){t.$set(t.newRow,"productId",e)},expression:"newRow.productId"}}),t._v(" "),e(k.a,{attrs:{type:"number",step:"0.01",min:"0",label:"ລາຄາຕໍ່ຫນ່ວຍ",required:"",rules:t.priceRules},model:{value:t.newRow.price,callback:function(e){t.$set(t.newRow,"price",t._n(e))},expression:"newRow.price"}}),t._v(" "),e(k.a,{attrs:{type:"number",label:"ຈຳນວນ",required:"",rules:t.qtyRules},model:{value:t.newRow.qty,callback:function(e){t.$set(t.newRow,"qty",t._n(e))},expression:"newRow.qty"}}),t._v(" "),e(r.a,{attrs:{"item-text":"code","item-value":"id",items:t.currencyList,label:"ສະກຸນ *",rules:t.currencyIdRules},model:{value:t.newRow.currencyId,callback:function(e){t.$set(t.newRow,"currencyId",e)},expression:"newRow.currencyId"}}),t._v(" "),e(k.a,{attrs:{type:"number",step:"0.01",min:"0",label:"ອັດຕາແລກປ່ຽນ",rules:t.rateRules,required:""},model:{value:t.newRow.rate,callback:function(e){t.$set(t.newRow,"rate",t._n(e))},expression:"newRow.rate"}}),t._v(" "),e(k.a,{attrs:{type:"number",step:"0.01",min:"0",label:"ລວມ",rules:t.totalRules,required:""},model:{value:t.newRow.total,callback:function(e){t.$set(t.newRow,"total",t._n(e))},expression:"newRow.total"}})],1)],1),t._v(" "),e(l.a,[e(o.a,{attrs:{color:"primary"},on:{click:t.addRow}},[t._v("ເພີ່ມ")]),t._v(" "),e(o.a,{attrs:{color:"secondary"},on:{click:function(e){t.showAddRowDialog=!1}}},[t._v("ປິດ")])],1)],1)],1),t._v(" "),e(c.a,[e(l.d,[e("span",{staticClass:"headline"},[t._v(t._s(t.title))])]),t._v(" "),e(l.c,[e(f.a,[e(w.a,[e(d.a,{attrs:{cols:"12",sm:"4",md:"4"}},[e(x.a,{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e(k.a,{attrs:{label:"Vendor",rules:[t.rules.required],required:""},model:{value:t.form.header.vendor,callback:function(e){t.$set(t.form.header,"vendor",e)},expression:"form.header.vendor"}}),t._v(" "),e(k.a,{attrs:{label:"Remark",rules:[t.rules.required],required:""},model:{value:t.form.header.notes,callback:function(e){t.$set(t.form.header,"notes",e)},expression:"form.header.notes"}})],1)],1),t._v(" "),e(d.a,{attrs:{cols:"12",sm:"4",md:"4"}},[e(x.a,{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e(k.a,{attrs:{type:"date",label:"ວັນທີສັ່ງ*",hint:"example of helper text only on focus"},model:{value:t.form.header.bookingDate,callback:function(e){t.$set(t.form.header,"bookingDate",e)},expression:"form.header.bookingDate"}})],1)],1),t._v(" "),e(d.a,{attrs:{cols:"12",sm:"4",md:"4"}},[e(x.a,{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e(k.a,{attrs:{type:"date",label:"ວັນທີຮັບເຄື່ອງ*",hint:"example of helper text only on focus"},model:{value:t.form.header.deliveryDate,callback:function(e){t.$set(t.form.header,"deliveryDate",e)},expression:"form.header.deliveryDate"}}),t._v(" "),e(y.a,{attrs:{label:"Active","true-value":!0,"false-value":!1},model:{value:t.form.header.isActive,callback:function(e){t.$set(t.form.header,"isActive",e)},expression:"form.header.isActive"}})],1)],1)],1),t._v(" "),e(v.a),t._v(" "),e(o.a,{attrs:{color:"primary"},on:{click:function(e){t.showAddRowDialog=!0}}},[t._v("ເພີ່ມລາຍການ")]),t._v(" "),e(m.a,{attrs:{headers:t.headers,items:t.lines},scopedSlots:t._u([{key:"item",fn:function(n){var c=n.item;return[e("tr",[e("td",[e(r.a,{attrs:{"item-text":"pro_name","item-value":"id",items:t.productList,rules:t.productIdRules,label:"ເລືອກສິນຄ້າ *"},model:{value:c.productId,callback:function(e){t.$set(c,"productId",e)},expression:"item.productId"}})],1),t._v(" "),e("td",[e(k.a,{attrs:{type:"number",label:"ລາຄາ",rules:t.priceRules},model:{value:c.price,callback:function(e){t.$set(c,"price",t._n(e))},expression:"item.price"}})],1),t._v(" "),e("td",[e(k.a,{attrs:{type:"number",label:"ຈຳນວນ",rules:t.qtyRules},model:{value:c.qty,callback:function(e){t.$set(c,"qty",t._n(e))},expression:"item.qty"}})],1),t._v(" "),e("td",[e(r.a,{attrs:{"item-text":"code","item-value":"id",items:t.currencyList,label:"ສະກຸນ *",rules:t.currencyIdRules},model:{value:c.currencyId,callback:function(e){t.$set(c,"currencyId",e)},expression:"item.currencyId"}})],1),t._v(" "),e("td",[e(k.a,{attrs:{type:"number",step:"0.01",min:"0",label:"ອັດຕາແລກປ່ຽນ",rules:t.rateRules},model:{value:c.rate,callback:function(e){t.$set(c,"rate",t._n(e))},expression:"item.rate"}})],1),t._v(" "),e("td",[e(k.a,{attrs:{type:"number",step:"0.01",min:"0",label:"ລວມ",rules:t.totalRules},model:{value:c.total,callback:function(e){t.$set(c,"total",t._n(e))},expression:"item.total"}})],1),t._v(" "),e("td",[e(o.a,{attrs:{color:"warning",variant:"text"},on:{click:function(e){return t.deleteItem(c)}}},[t._v("\n                                    ລົບ\n                                ")])],1)])]}}])})],1),t._v(" "),e("small",[t._v("* ສະແດງເຖິງຟິວທີ່ຕ້ອງໃສ່ຂໍ້ມູນ")])],1),t._v(" "),e(l.a,[e(_.a),t._v(" "),e(o.a,{attrs:{color:"warning",rounded:"",variant:"text"},on:{click:function(e){return t.$emit("close-dialog")}}},[t._v("\n                Close\n            ")]),t._v(" "),e(o.a,{attrs:{color:"primary",rounded:"",variant:"text"},on:{click:t.submit}},[t._v("\n                Save\n            ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},916:function(t,e,n){var content=n(972);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(16).default)("de5ee156",content,!0,{sourceMap:!1})},971:function(t,e,n){"use strict";n(916)},972:function(t,e,n){var r=n(15)((function(i){return i[1]}));r.push([t.i,".error-border[data-v-f09cae02]{border:2px solid #f44336!important}.error-row[data-v-f09cae02]{background-color:#ffebee!important}.error-row td[data-v-f09cae02]{border-bottom:1px solid #f44336!important}.v-data-table tbody tr[data-v-f09cae02]:hover{background-color:#f5f5f5!important}.v-card[data-v-f09cae02]{transition:box-shadow .3s ease}.v-card[data-v-f09cae02]:hover{box-shadow:0 4px 8px rgba(0,0,0,.12)!important}.v-text-field--outlined .v-input__control .v-input__slot[data-v-f09cae02]{min-height:40px}.v-autocomplete--is-dirty .v-select__selection[data-v-f09cae02]{color:rgba(0,0,0,.87)}.loading-overlay[data-v-f09cae02]{align-items:center;background:hsla(0,0%,100%,.8);bottom:0;display:flex;justify-content:center;left:0;position:absolute;right:0;top:0;z-index:1000}.v-data-table th[data-v-f09cae02]{background-color:#f8f9fa;font-weight:600}.v-data-table .v-data-table__wrapper[data-v-f09cae02]{border-radius:8px;overflow:hidden}.success--text[data-v-f09cae02]{color:#4caf50!important}.error--text[data-v-f09cae02]{color:#f44336!important}@media (max-width:768px){.v-data-table[data-v-f09cae02]{font-size:.875rem}.v-btn[data-v-f09cae02]{min-width:auto;padding:0 12px}}@media print{.v-btn[data-v-f09cae02],.v-card-actions[data-v-f09cae02]{display:none!important}.v-card[data-v-f09cae02]{border:1px solid #ddd;box-shadow:none!important}}",""]),r.locals={},t.exports=r}}]);