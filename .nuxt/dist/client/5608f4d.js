(window.webpackJsonp=window.webpackJsonp||[]).push([[173,51,147],{1341:function(e,t,n){"use strict";n.r(t);var r=n(799),o=n(321),c=n(318),l=n(19),d=n(322),m=n(797),f=n(792),h=n(771),v=n(168),y=n(796),x=n(794),_=n(112),k=(n(10),n(7),n(9),n(12),n(13),n(17)),w=n(3),D=(n(85),n(24),n(64),n(5),n(8),n(855)),O=n(44),A=n(342);function I(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?I(Object(source),!0).forEach((function(t){Object(w.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):I(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var S={props:{receiveHeaderId:{type:Number,default:""},isEdit:{type:Boolean,default:!1}},directives:{commaThousand:D.a},data:function(){return{account:[],drAccount:"",crAccount:"",amount:"",isloading:!1,bookingDate:"",paymentDescription:"",postingReference:"",paymentType:["Cash","Check","Credit Card","Bank transfer"],paymentList:[],form:{header:{bookingDate:"",receiveNumber:"DEFAULT",payee:"ຮ້ານຄ້າທົ່ວໄປ",paymentId:1,currencyId:1,rate:1,totalAmount:"1,000",notes:"",update_user:1,drAccountId:1,crAccountId:13,isActive:!0},line:{}}}},mounted:function(){this.loadAccount(),this.loadPayment();var e=(new Date).toISOString().substr(0,10);this.bookingDate=e,this.form.header.bookingDate=e,this.form.header.currencyId=this.currencyList[0].id,this.isEdit&&(console.log("Load payment header"),this.loadReceiveById())},computed:j(j({},Object(O.c)(["findAllProduct","findAllClient","findAllPayment","findAllUnit","findAllCurrency","findAllTerminal","findSelectedTerminal"])),{},{today:function(){var e=(new Date).toLocaleDateString();return console.log(e),e},currencyList:function(){return this.findAllCurrency}}),methods:{currencyChange:function(){var e=this,t=this.currencyList.find((function(t){return t.id==e.form.header.currencyId}));t&&(this.form.header.rate=t.rate)},loadPayment:function(){var e=this;return Object(k.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,e.paymentList=[],t.next=4,e.$axios.get("/api/paymentMethod/find").then((function(t){e.paymentList=t.data,e.form.header.paymentId=e.paymentList[0].id})).catch((function(t){Object(A.b)(e.$swal,"Error",t)}));case 4:e.isloading=!1;case 5:case"end":return t.stop()}}),t)})))()},loadAccount:function(){var e=this;return Object(k.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,t.next=3,e.$axios.get("/api/account/find");case 3:t.sent.data.forEach((function(element){e.account.push({id:element.id,desc:element.accountName+" - "+element.accountNumber})})),e.isloading=!1;case 6:case"end":return t.stop()}}),t)})))()},loadReceiveById:function(){var e=this;return Object(k.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,t.next=3,e.$axios.get("/api/finanicial/ar/header/find/".concat(e.receiveHeaderId)).then((function(t){e.form.header=t.data,e.form.header.bookingDate=t.data.bookingDate.split("T")[0],e.form.header.totalAmount=e.getFormatNum(e.form.header.totalAmount)})).catch((function(t){Object(A.b)(e.$swal,"Error",t.response.data)}));case 3:case"end":return t.stop()}}),t)})))()},getFormatNum:function(e){return(new Intl.NumberFormat).format(e)},submitData:function(){var e=this;return Object(k.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isloading){t.next=2;break}return t.abrupt("return");case 2:if(e.isloading=!0,!e.isEdit){t.next=8;break}return t.next=6,e.$axios.put("/api/finanicial/ar/header/update/".concat(e.receiveHeaderId),e.form.header).then((function(t){Object(A.c)(e.$swal,"Succeed","ດຳເນີນການສຳເລັດ"),e.$emit("reload"),e.$emit("close-dialog")})).catch((function(t){Object(A.b)(e.$swal,"Error",t.response.data)}));case 6:t.next=10;break;case 8:return t.next=10,e.$axios.post("/api/finanicial/ar/header/create",e.form.header).then((function(t){Object(A.c)(e.$swal,"Succeed","ດຳເນີນການສຳເລັດ"),e.$emit("reload"),e.$emit("close-dialog")})).catch((function(t){Object(A.b)(e.$swal,"Error",t.response.data.errors[0].msg)}));case 10:e.isloading=!1;case 11:case"end":return t.stop()}}),t)})))()}}},$=n(31),component=Object($.a)(S,(function(){var e=this,t=e._self._c;return t(y.a,{attrs:{justify:"center"},scopedSlots:e._u([{key:"activator",fn:function(n){var r=n.props;return[t(o.a,e._b({attrs:{color:"primary"}},"v-btn",r,!1),[e._v("\n            Open Dialog\n        ")])]}}])},[e._v(" "),t(h.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.isloading,callback:function(t){e.isloading=t},expression:"isloading"}},[t("loading-indicator")],1),e._v(" "),t(c.a,{staticClass:"pa-4"},[t(l.d,[t(d.a,{staticClass:"ma-0",attrs:{color:"primary",label:"","text-color":"white"}},[t(v.a,{attrs:{start:""}},[e._v("mdi-label")]),e._v("\n                ລາຍຮັບ "+e._s(e.today)+"\n            ")],1)],1),e._v(" "),t(l.c,[t(f.a,[t(y.a,[t(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.a,{attrs:{label:"ເລກເອກະສານອ້າງອີງ*",required:""},model:{value:e.form.header.receiveNumber,callback:function(t){e.$set(e.form.header,"receiveNumber",t)},expression:"form.header.receiveNumber"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.a,{attrs:{type:"date",label:"ວັນທີ*",hint:"ເດຶອນ/ວັນ/ປີ 12/31/2023"},model:{value:e.form.header.bookingDate,callback:function(t){e.$set(e.form.header,"bookingDate",t)},expression:"form.header.bookingDate"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.a,{attrs:{label:"ຊຶ ບໍ່ລິສັດ ຫລື ຜູ້ຮັບ ການຊຳລະ*",hint:"ຊື່ບຸກຄົນ,ບໍລິສັດ ຫລື ຜູ້ຮັບການຊຳລະ","persistent-hint":"",required:""},model:{value:e.form.header.payee,callback:function(t){e.$set(e.form.header,"payee",t)},expression:"form.header.payee"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12"}},[t(_.a,{attrs:{label:"ເນື້ອໃນລາຍການ*",required:""},model:{value:e.form.header.notes,callback:function(t){e.$set(e.form.header,"notes",t)},expression:"form.header.notes"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ຈຳນວນເງິນ*",required:""},model:{value:e.form.header.totalAmount,callback:function(t){e.$set(e.form.header,"totalAmount",t)},expression:"form.header.totalAmount"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[t(r.a,{attrs:{items:e.currencyList,label:"ສະກຸນເງິນ*","item-text":"code","item-value":"id"},on:{input:e.currencyChange},model:{value:e.form.header.currencyId,callback:function(t){e.$set(e.form.header,"currencyId",t)},expression:"form.header.currencyId"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[t(_.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ອັດຕາແລກປ່ຽນ*",required:""},model:{value:e.form.header.rate,callback:function(t){e.$set(e.form.header,"rate",t)},expression:"form.header.rate"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12"}},[t(r.a,{attrs:{"item-text":"payment_code","item-value":"id",items:e.paymentList,label:"ປະເພດການຊຳລະ *"},model:{value:e.form.header.paymentId,callback:function(t){e.$set(e.form.header,"paymentId",t)},expression:"form.header.paymentId"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6"}},[t(r.a,{attrs:{"item-text":"desc","item-value":"id",items:e.account,label:"ບັນຊີແຍກປະເພດ DR ACCOUNT*"},model:{value:e.form.header.drAccountId,callback:function(t){e.$set(e.form.header,"drAccountId",t)},expression:"form.header.drAccountId"}})],1),e._v(" "),t(m.a,{attrs:{cols:"12",sm:"6"}},[t(r.a,{attrs:{"item-text":"desc","item-value":"id",items:e.account,label:"ບັນຊີແຍກປະເພດ CR ACCOUNT*"},model:{value:e.form.header.crAccountId,callback:function(t){e.$set(e.form.header,"crAccountId",t)},expression:"form.header.crAccountId"}})],1)],1)],1),e._v(" "),t("small",[e._v("* ສະແດງເຖິງຟິວທີ່ຕ້ອງໃສ່ຂໍ້ມູນ")])],1),e._v(" "),t(l.a,[t(x.a),e._v(" "),t(o.a,{attrs:{color:"warning",rounded:"",variant:"text"},on:{click:function(t){return e.$emit("close-dialog")}}},[e._v("\n                Close\n            ")]),e._v(" "),t(o.a,{attrs:{color:"primary",rounded:"",variant:"text"},on:{click:e.submitData}},[e._v("\n                Save\n            ")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},1758:function(e,t,n){"use strict";n.r(t);var r=n(321),o=n(318),c=n(19),l=n(797),d=n(806),m=n(1746),f=n(771),h=n(787),v=n(323),y=n(112),x=(n(34),n(130),n(63),n(35),n(69),n(54),n(7),n(67),n(93),n(53),n(17)),_=n(32),k=(n(85),n(30),n(337),n(5),n(8),n(37));function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var O={components:{ArReceivable:n(1341).default},mounted:function(){this.loadTxn()},data:function(){return{userId:"",search:"",isEdit:!1,dialog:!1,arFormKey:1,isloading:!1,menu1:!1,menu2:!1,txnList:[],selectedId:"",headers:[{text:"ວັນທີ",align:"center",value:"bookingDate",sortable:!0},{text:"ເລກອ້າງອີງ",align:"center",value:"paymentNumber"},{text:"ຍອດລວມ",align:"center",value:"totalAmount"},{text:"ສະກຸນ",align:"center",value:"currency.code"},{text:"ອັດຕາແລກປ່ຽນ",align:"center",value:"rate"},{text:"ຊຳລະດ້ວຍ",align:"center",value:"payment.payment_code"},{text:"ເບື້ອງຫນີ້",align:"center",value:"drAccount"},{text:"ເບື້ອງມີ",align:"center",value:"crAccount"},{text:"ເນື້ອໃນ",align:"center",value:"notes"},{text:"ເວລາສ້າງ",align:"center",value:"createdAt"},{text:"ແກ້ໄຂ",align:"end",value:"function",sortable:!1}],date:Object(k.d)(),date2:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),dateFormatted:this.formatDate(Object(k.d)()),dateFormatted2:this.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10))}},watch:{date:function(e){this.dateFormatted=this.formatDate(this.date),this.loadTxn()},date2:function(e){this.dateFormatted2=this.formatDate(this.date2),this.loadTxn()}},methods:{triggerDialog:function(){this.arFormKey+=1,this.selectedId=null,this.isEdit=!1,this.dialog=!0},numberWithFormat:function(e){return Object(k.e)(e)},editItem:function(e){this.selectedId=e.id,this.isEdit=!0,this.arFormKey+=1,this.dialog=!0},formatDate:function(e){if(!e)return null;console.log("DATE FORMAT METHOD1: "+e);var t=this.formatDateToISO(e).split("-"),n=Object(_.a)(t,3),r=n[0],o=n[1],c=n[2];return"".concat(o,"/").concat(c,"/").concat(r)},parseDate:function(e){if(console.log("DATE PARSE METHOD1: "+e),!e)return null;var t=e.split("/"),n=Object(_.a)(t,3),r=n[0],o=n[1],c=n[2];return"".concat(c,"-").concat(r.padStart(2,"0"),"-").concat(o.padStart(2,"0"))},formatDateToISO:function(e){e instanceof Date||(e=new Date(e));var t=e.getFullYear(),n="".concat(e.getMonth()+1).padStart(2,"0"),r="".concat(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)},loadTxn:function(){var e=this;return Object(x.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,n={startDate:e.date,endDate:e.date2},t.next=4,e.$axios.get("/api/finanicial/ar/header/findByDate",{params:{date:n}}).then((function(t){e.txnList=[];var n,r=w(t.data);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.bookingDate=o.bookingDate.split("T")[0],e.txnList.push(o)}}catch(e){r.e(e)}finally{r.f()}console.log("====> "+e.txnList[0])})).catch((function(e){}));case 4:e.isloading=!1;case 5:case"end":return t.stop()}}),t)})))()}},computed:{paymentCurrencyGrouping:function(){var e={};this.txnList.forEach((function(t){var n=t.totalAmount,r=t.currency;e[r.code]||(e[r.code]=0),e[r.code]+=n}));var t=[];for(var n in e)console.log("Total for ".concat(n,": ").concat(e[n])),t.push({currency:n,amount:e[n]});return t}}},A=n(31),component=Object(A.a)(O,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-center"},[t("div",[t(f.a,{attrs:{persistent:"",width:"1024"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("ar-receivable",{key:e.arFormKey,attrs:{"is-edit":e.isEdit,"receive-header-id":e.selectedId},on:{close:e.triggerDialog,"close-dialog":function(t){e.dialog=!1},reload:e.loadTxn}})],1)],1),e._v(" "),t(f.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.isloading,callback:function(t){e.isloading=t},expression:"isloading"}},[t("loading-indicator")],1),e._v(" "),t(o.a,[t(c.d,[t(h.a,{attrs:{row:"",wrap:""}},[t(l.a,{attrs:{cols:"6"}},[t(v.a,{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[t(y.a,e._g(e._b({attrs:{label:"ຈາກວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(t){e.date=e.parseDate(e.dateFormatted)}},model:{value:e.dateFormatted,callback:function(t){e.dateFormatted=t},expression:"dateFormatted"}},"v-text-field",o,!1),r))]}}]),model:{value:e.menu1,callback:function(t){e.menu1=t},expression:"menu1"}},[e._v(" "),t(m.a,{attrs:{"no-title":""},on:{input:function(t){e.menu1=!1}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),e._v(" "),t(v.a,{ref:"menu2",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[t(y.a,e._g(e._b({attrs:{label:"ຫາວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(t){e.date2=e.parseDate(e.dateFormatted2)}},model:{value:e.dateFormatted2,callback:function(t){e.dateFormatted2=t},expression:"dateFormatted2"}},"v-text-field",o,!1),r))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[e._v(" "),t(m.a,{attrs:{"no-title":""},on:{input:function(t){e.menu2=!1}},model:{value:e.date2,callback:function(t){e.date2=t},expression:"date2"}})],1),e._v(" "),t(r.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:e.triggerDialog}},[e._v("\n                        ເພີ່ມລາຍຮັບ\n                    ")])],1),e._v(" "),t(l.a,{attrs:{cols:"6"}},[t(y.a,{attrs:{"append-icon":"mdi-magnify",label:"ຊອກຫາ","single-line":"","hide-detailsx":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),t(y.a,{attrs:{"append-icon":"mdi-magnify",label:"ລະຫັດຜູ້ຂາຍ","single-line":"","hide-detailsx":""},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}}),e._v(" "),t(r.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:e.loadTxn}},[e._v(" ດຶງລາຍງານ\n                    ")])],1)],1)],1),e._v(" "),t(c.c,[e.paymentCurrencyGrouping.length>0?t("table",{attrs:{border:"1"}},[t("thead",[t("tr",[t("th",[e._v("ສະກຸນເງິນ")]),e._v(" "),t("th",[e._v("ລວມຍອດ")])])]),e._v(" "),t("tbody",e._l(e.paymentCurrencyGrouping,(function(n){return t("tr",{key:n.currency},[t("td",[e._v(e._s(n.currency))]),e._v(" "),t("td",{staticStyle:{"text-align":"right"}},[e._v(e._s(e.numberWithFormat(n.amount)))])])})),0)]):e._e()]),e._v(" "),e.txnList?t(d.a,{attrs:{headers:e.headers,search:e.search,items:e.txnList},scopedSlots:e._u([{key:"item.function",fn:function(n){var o=n.item;return[t(r.a,{attrs:{color:"primary",text:""},on:{click:function(t){e.editItem(o),e.wallet=!0}}},[t("i",{staticClass:"fa-regular fa-pen-to-square"})])]}},{key:"item.totalAmount",fn:function(t){var n=t.item;return[e._v("\n\n                "+e._s(e.numberWithFormat(n.totalAmount))+"\n\n\n            ")]}}],null,!0)}):e._e()],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},855:function(e,t,n){"use strict";n(34),n(75);t.a={bind:function(e,t,n){e.addEventListener("input",(function(e){var t=e.target.value.replace(/[^0-9]/g,"");"NaN"===(t=parseInt(t,10).toLocaleString("en-US"))&&(t="0"),n.componentInstance.$emit("input",t)}))}}}}]);