(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1235:function(t,e,n){var content=n(1515);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(16).default)("59ca2aba",content,!0,{sourceMap:!1})},1514:function(t,e,n){"use strict";n(1235)},1515:function(t,e,n){var o=n(15)((function(i){return i[1]}));o.push([t.i,'.audit-section-header[data-v-49f64b14]{align-items:center;display:flex;justify-content:space-between;margin-bottom:20px}.btn-view-audit[data-v-49f64b14]{border-radius:6px;font-size:14px;font-weight:500;padding:8px 16px;transition:all .2s ease}.btn-view-audit[data-v-49f64b14]:hover{box-shadow:0 4px 8px rgba(102,126,234,.2);transform:translateY(-1px)}.btn-outline-primary[data-v-49f64b14]{background:#fff;border:2px solid #667eea;color:#667eea}.btn-outline-primary[data-v-49f64b14]:hover{background:#667eea;color:#fff}.modal-overlay[data-v-49f64b14]{align-items:center;background-color:rgba(0,0,0,.6);display:flex;height:100%;justify-content:center;left:0;padding:20px;position:fixed;top:0;width:100%;z-index:1050}.enhanced-dialog[data-v-49f64b14]{background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.3);display:flex;flex-direction:column;max-height:90vh;max-width:1200px;overflow:hidden;width:100%}.modal-header[data-v-49f64b14]{background:linear-gradient(135deg,#667eea,#764ba2);border-bottom:1px solid #e9ecef;color:#fff;justify-content:space-between;padding:20px}.modal-header[data-v-49f64b14],.modal-title[data-v-49f64b14]{align-items:center;display:flex}.modal-title[data-v-49f64b14]{font-size:18px;font-weight:600;gap:10px;margin:0}.close-button[data-v-49f64b14]{background:none;border:none;border-radius:4px;color:#fff;cursor:pointer;font-size:20px;padding:5px;transition:background .2s}.close-button[data-v-49f64b14]:hover{background:hsla(0,0%,100%,.2)}.modal-body[data-v-49f64b14]{flex:1;overflow:hidden}.loading-state[data-v-49f64b14],.modal-body[data-v-49f64b14]{display:flex;flex-direction:column}.loading-state[data-v-49f64b14]{align-items:center;color:#666;justify-content:center;padding:40px}.spinner[data-v-49f64b14]{animation:spin-49f64b14 1s linear infinite;border:4px solid #f3f3f3;border-radius:50%;border-top-color:#3498db;height:40px;margin-bottom:15px;width:40px}@keyframes spin-49f64b14{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.invoice-form[data-v-49f64b14]{display:flex;flex:1;flex-direction:column;overflow:hidden}.tab-navigation[data-v-49f64b14]{background:#f8f9fa;border-bottom:1px solid #e9ecef;display:flex}.tab-btn[data-v-49f64b14]{align-items:center;background:none;border:none;color:#666;cursor:pointer;display:flex;flex:1;font-size:14px;font-weight:500;gap:8px;justify-content:center;padding:15px 20px;position:relative;transition:all .2s}.tab-btn[data-v-49f64b14]:hover{background:rgba(102,126,234,.1);color:#667eea}.tab-btn.active[data-v-49f64b14]{background:#fff;border-bottom:3px solid #667eea;color:#667eea}.line-count[data-v-49f64b14]{background:#667eea;border-radius:12px;color:#fff;font-size:12px;min-width:20px;padding:2px 8px;text-align:center}.tab-content[data-v-49f64b14]{flex:1;overflow-y:auto;padding:0}.form-section[data-v-49f64b14]{border-bottom:1px solid #f0f0f0;padding:25px}.form-section[data-v-49f64b14]:last-child{border-bottom:none}.section-title[data-v-49f64b14]{align-items:center;border-bottom:2px solid #e9ecef;color:#333;display:flex;font-size:16px;font-weight:600;gap:10px;margin-bottom:20px;padding-bottom:10px}.section-title i[data-v-49f64b14]{color:#667eea}.form-row[data-v-49f64b14]{display:flex;flex-wrap:wrap;margin:-10px}.form-group[data-v-49f64b14]{margin-bottom:20px;padding:10px}.col-md-6[data-v-49f64b14]{flex:0 0 50%;max-width:50%}.form-group label[data-v-49f64b14]{color:#333;display:block;font-size:14px;font-weight:500;margin-bottom:5px}.form-group label.required[data-v-49f64b14]:after{color:#e74c3c;content:" *"}.form-control[data-v-49f64b14]{border:1px solid #ddd;border-radius:6px;font-size:14px;padding:10px 12px;transition:border-color .2s,box-shadow .2s;width:100%}.form-control[data-v-49f64b14]:focus{border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1);outline:none}.form-control.is-invalid[data-v-49f64b14]{border-color:#e74c3c;box-shadow:0 0 0 3px rgba(231,76,60,.1)}.form-control-sm[data-v-49f64b14]{font-size:13px;padding:6px 8px}.invalid-feedback[data-v-49f64b14]{color:#e74c3c;display:block;width:100%}.form-text[data-v-49f64b14],.invalid-feedback[data-v-49f64b14]{font-size:12px;margin-top:5px}.text-muted[data-v-49f64b14]{color:#6c757d}.exchange-rate-input-group[data-v-49f64b14]{align-items:center;display:flex;position:relative}.exchange-rate-addon[data-v-49f64b14]{color:#667eea;font-size:14px;pointer-events:none;position:absolute;right:10px}.currency-info[data-v-49f64b14]{color:#666;font-size:12px;font-weight:400}.exchange-display[data-v-49f64b14]{background:#f8f9fa;border:1px solid #e9ecef;border-radius:6px;margin-top:20px;padding:12px}.exchange-label[data-v-49f64b14]{color:#666;display:block;font-size:13px;font-weight:500;margin-bottom:8px}.exchange-amount[data-v-49f64b14]{align-items:center;display:flex;font-size:14px;font-weight:600;gap:10px}.foreign-amount[data-v-49f64b14]{color:#667eea}.exchange-arrow[data-v-49f64b14]{color:#28a745;font-size:12px}.local-amount[data-v-49f64b14]{color:#28a745}.local-currency[data-v-49f64b14]{background:#e8f5e8;border:1px solid #28a745;border-radius:4px;padding:8px 12px}.local-currency .amount.local[data-v-49f64b14]{color:#28a745;font-weight:700}.amount-summary[data-v-49f64b14]{background:#f8f9fa;border-left:4px solid #667eea;border-radius:8px;margin:20px 25px;padding:20px}.totals-grid[data-v-49f64b14]{grid-gap:15px;display:grid;gap:15px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}.total-item[data-v-49f64b14]{align-items:center;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;padding:8px 0}.total-item[data-v-49f64b14]:last-child{border-bottom:none}.total-item.grand-total[data-v-49f64b14]{border-top:2px solid #667eea;font-size:16px;font-weight:600;grid-column:1/-1;margin-top:8px;padding-top:12px}.total-item .amount[data-v-49f64b14]{color:#333;font-weight:600}.total-item .amount.discount[data-v-49f64b14]{color:#e67e22}.audit-trail-section[data-v-49f64b14]{background:#f8f9fa;border:1px solid #e9ecef;border-radius:8px;margin:20px 0;padding:20px}.audit-trail-container[data-v-49f64b14]{display:flex;flex-direction:column;gap:16px}.audit-card[data-v-49f64b14]{background:#fff;border-left:4px solid #007bff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);padding:16px}.maker-card[data-v-49f64b14]{border-left-color:#28a745}.checker-card[data-v-49f64b14]{border-left-color:#17a2b8}.audit-header[data-v-49f64b14]{gap:12px;margin-bottom:12px}.audit-header[data-v-49f64b14],.audit-icon[data-v-49f64b14]{align-items:center;display:flex}.audit-icon[data-v-49f64b14]{border-radius:50%;color:#fff;font-size:18px;height:40px;justify-content:center;width:40px}.maker-icon[data-v-49f64b14]{background:#28a745}.checker-icon[data-v-49f64b14]{background:#17a2b8}.audit-title h6[data-v-49f64b14]{color:#495057;font-weight:600;margin:0}.audit-status[data-v-49f64b14]{border-radius:12px;display:inline-block;font-size:11px;font-weight:500;letter-spacing:.5px;padding:2px 8px;text-transform:uppercase}.status-created[data-v-49f64b14]{background:#d4edda;color:#155724}.status-approved[data-v-49f64b14]{background:#d1ecf1;color:#0c5460}.status-pending[data-v-49f64b14]{background:#fff3cd;color:#856404}.audit-details[data-v-49f64b14]{grid-gap:8px;display:grid;gap:8px;grid-template-columns:1fr 1fr}.audit-row[data-v-49f64b14]{align-items:center;display:flex;justify-content:space-between;padding:4px 0}.audit-label[data-v-49f64b14]{color:#6c757d}.audit-label[data-v-49f64b14],.audit-value[data-v-49f64b14]{font-size:13px;font-weight:500}.audit-value[data-v-49f64b14]{color:#495057}.audit-value.comment[data-v-49f64b14]{background:#f8f9fa;border-radius:4px;color:#6c757d;font-style:italic;grid-column:1/-1;margin-top:8px;padding:8px}.approval-status-summary[data-v-49f64b14]{background:#fff;border:1px solid #e9ecef;border-radius:8px;padding:20px}.status-info-header[data-v-49f64b14]{align-items:center;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;margin-bottom:20px;padding-bottom:10px}.status-info-header h6[data-v-49f64b14]{color:#495057;font-weight:600;margin:0}.status-badge[data-v-49f64b14]{border-radius:16px;font-size:12px;font-weight:600;letter-spacing:.5px;padding:4px 12px;text-transform:uppercase}.status-badge.status-draft[data-v-49f64b14]{background:#e9ecef;color:#6c757d}.status-badge.status-pending[data-v-49f64b14]{background:#fff3cd;color:#856404}.status-badge.status-approved[data-v-49f64b14]{background:#d1ecf1;color:#0c5460}.status-badge.status-rejected[data-v-49f64b14]{background:#f8d7da;color:#721c24}.status-badge.status-paid[data-v-49f64b14]{background:#d4edda;color:#155724}.status-badge.status-cancelled[data-v-49f64b14]{background:#f8d7da;color:#721c24}.status-workflow[data-v-49f64b14]{align-items:center;display:flex;gap:20px;justify-content:center}.workflow-step[data-v-49f64b14]{align-items:center;display:flex;flex-direction:column;gap:8px;opacity:.4;transition:opacity .3s ease}.workflow-step.active[data-v-49f64b14]{opacity:1}.step-icon[data-v-49f64b14]{align-items:center;background:#e9ecef;border-radius:50%;color:#6c757d;display:flex;font-size:20px;height:50px;justify-content:center;transition:all .3s ease;width:50px}.workflow-step.active .step-icon[data-v-49f64b14]{background:#007bff;color:#fff;transform:scale(1.1)}.step-created.active .step-icon[data-v-49f64b14]{background:#28a745}.step-approved.active .step-icon[data-v-49f64b14]{background:#17a2b8}.step-label[data-v-49f64b14]{color:#6c757d;font-size:12px;font-weight:500;text-align:center}.workflow-step.active .step-label[data-v-49f64b14]{color:#495057;font-weight:600}.workflow-arrow[data-v-49f64b14]{color:#dee2e6;font-size:16px}.workflow-step.active+.workflow-arrow[data-v-49f64b14]{color:#007bff}.line-items-section[data-v-49f64b14]{padding:25px}.add-line-header[data-v-49f64b14]{align-items:center;display:flex;justify-content:space-between;margin-bottom:20px}.add-line-actions[data-v-49f64b14]{align-items:center;display:flex;gap:15px}.btn[data-v-49f64b14]{align-items:center;border:none;border-radius:4px;cursor:pointer;display:inline-flex;font-size:14px;gap:8px;padding:8px 16px;transition:all .2s ease}.btn-primary[data-v-49f64b14]{background:#007bff;color:#fff}.btn-secondary[data-v-49f64b14]{background:#6c757d;color:#fff}.btn-danger[data-v-49f64b14]{background:#dc3545;color:#fff}.btn[data-v-49f64b14]:hover:not(:disabled){opacity:.9;transform:translateY(-1px)}.btn[data-v-49f64b14]:disabled{cursor:not-allowed;opacity:.6;transform:none}.btn-add-line[data-v-49f64b14]{font-size:16px;font-weight:600;padding:12px 24px}.btn-lg[data-v-49f64b14]{font-size:16px;padding:12px 30px}.btn-sm[data-v-49f64b14]{align-items:center;border-radius:50%;display:flex;font-size:11px;height:28px;justify-content:center;padding:0;width:28px}.line-count-info[data-v-49f64b14]{background:#e9ecef;border-radius:20px;color:#666;font-size:12px;font-weight:500;padding:8px 12px}.empty-line-state[data-v-49f64b14]{background:#f8f9fa;border:2px dashed #dee2e6;border-radius:8px;padding:60px 20px;text-align:center}.empty-content i[data-v-49f64b14]{color:#dee2e6;font-size:64px;margin-bottom:20px}.empty-content h4[data-v-49f64b14]{color:#666;margin-bottom:10px}.empty-content p[data-v-49f64b14]{color:#999;margin-bottom:30px}.line-items-table-container[data-v-49f64b14]{border:1px solid #e9ecef;border-radius:8px;margin-bottom:20px;overflow:hidden}.line-items-table .table[data-v-49f64b14]{border-collapse:collapse;margin:0;width:100%}.line-items-table .table th[data-v-49f64b14]{background:#f8f9fa;border-bottom:2px solid #dee2e6;font-size:13px;font-weight:600;padding:12px 8px;text-align:center}.line-items-table .table td[data-v-49f64b14]{border-top:1px solid #dee2e6;font-size:13px;padding:8px;vertical-align:middle}.line-number[data-v-49f64b14]{color:#666;font-weight:600;text-align:center}.line-total[data-v-49f64b14]{color:#333;font-weight:600;text-align:right}.line-row[data-v-49f64b14]{transition:background-color .2s}.line-row[data-v-49f64b14]:hover{background-color:rgba(102,126,234,.05)}.add-more-lines[data-v-49f64b14]{border-top:1px solid #e9ecef;padding:20px 0;text-align:center}.btn-add-more[data-v-49f64b14]{margin-right:15px}.quick-add-buttons[data-v-49f64b14]{display:inline-flex;gap:10px;margin-left:15px}.line-totals-summary[data-v-49f64b14]{background:#f8f9fa;border-left:4px solid #667eea;border-radius:8px;margin-top:20px;padding:20px}.modal-footer[data-v-49f64b14]{background:#f8f9fa;border-top:1px solid #e9ecef;padding:20px}.footer-actions[data-v-49f64b14]{display:flex;gap:10px;justify-content:flex-end}@media (max-width:768px){.enhanced-dialog[data-v-49f64b14]{border-radius:0;height:100%;max-height:100vh;max-width:100%}.totals-grid[data-v-49f64b14]{grid-template-columns:1fr}.add-line-header[data-v-49f64b14]{flex-direction:column;gap:15px}.line-items-table-container[data-v-49f64b14]{overflow-x:auto}.line-items-table .table[data-v-49f64b14]{min-width:800px}.footer-actions[data-v-49f64b14]{flex-direction:column}.footer-actions .btn[data-v-49f64b14]{justify-content:center;width:100%}.tab-btn[data-v-49f64b14]{flex-direction:column;font-size:12px;gap:4px;padding:12px 8px}.quick-add-buttons[data-v-49f64b14]{margin-left:0;margin-top:10px}.form-row[data-v-49f64b14],.quick-add-buttons[data-v-49f64b14]{flex-direction:column}.col-md-6[data-v-49f64b14]{flex:1;max-width:100%}.audit-section-header[data-v-49f64b14]{align-items:flex-start;flex-direction:column;gap:10px}.audit-details[data-v-49f64b14]{grid-template-columns:1fr}.status-workflow[data-v-49f64b14]{flex-direction:column;gap:16px}.workflow-arrow[data-v-49f64b14]{transform:rotate(90deg)}.audit-trail-container[data-v-49f64b14]{gap:12px}.audit-card[data-v-49f64b14]{padding:12px}.exchange-amount[data-v-49f64b14]{align-items:flex-start;flex-direction:column}.exchange-arrow[data-v-49f64b14]{transform:rotate(90deg)}}@media (max-width:480px){.modal-header[data-v-49f64b14]{padding:15px}.modal-title[data-v-49f64b14]{font-size:16px}.form-section[data-v-49f64b14]{padding:20px 15px}.section-title[data-v-49f64b14]{font-size:14px}.modal-footer[data-v-49f64b14]{padding:15px}.line-items-section[data-v-49f64b14]{padding:20px 15px}.empty-line-state[data-v-49f64b14]{padding:40px 15px}.empty-content i[data-v-49f64b14]{font-size:48px}}',""]),o.locals={},t.exports=o},1631:function(t,e,n){"use strict";n.r(e);n(44),n(9),n(5),n(34),n(7),n(67),n(11),n(12);var o=n(3),r=n(20);n(92),n(66),n(8),n(121),n(10),n(100);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d={name:"APInvoiceDialog",components:{AuditLogDialog:n(1632).default},props:{visible:{type:Boolean,default:!1},invoice:{type:Object,default:null},vendors:{type:Array,default:function(){return[]}},currencies:{type:Array,default:function(){return[]}},glAccounts:{type:Array,default:function(){return[]}},user:{type:Object,default:null}},emits:["close","save"],data:function(){return{activeTab:"header",formLoading:!1,saving:!1,errors:{},lineItems:[],nextTempId:1,selectedVendor:null,selectedCurrency:null,auditDialogVisible:!1,form:{id:null,invoiceNumber:"",vendorInvoiceNumber:"",vendorId:"",invoiceDate:"",dueDate:"",description:"",totalAmount:"",exchangeRate:1,currencyId:"",makerId:"",note:"",reason:""}}},computed:{isEdit:function(){return!!this.invoice},auditTrail:function(){var t,e,n,o;if(!this.invoice)return{makerName:(null===(t=this.user)||void 0===t?void 0:t.cus_name)||(null===(e=this.user)||void 0===e?void 0:e.name)||"ຜູ້ໃຊ້ປະຈຸບັນ",makerPosition:"ພະນັກງານບັນຊີ",makerEmail:(null===(n=this.user)||void 0===n?void 0:n.cus_email)||(null===(o=this.user)||void 0===o?void 0:o.email)||"",createdDate:(new Date).toISOString().split("T")[0],createdTime:(new Date).toLocaleTimeString("en-GB"),isChecked:!1,isApproved:!1,checkerName:null,checkerPosition:null,checkerEmail:null,checkedDate:null,checkedTime:null,checkerComment:null};var r=this.invoice.maker||{},c=this.invoice.checker||null,l=new Date(this.invoice.createdAt),d=this.invoice.approvedAt?new Date(this.invoice.approvedAt):null;return{makerName:r.cus_name||"ບໍ່ມີຂໍ້ມູນ",makerPosition:r.position||"ພະນັກງານບັນຊີ",makerEmail:r.cus_email||"",makerId:r.cus_id||r.id,createdDate:l.toISOString().split("T")[0],createdTime:l.toLocaleTimeString("en-GB"),createdDateTime:this.invoice.createdAt,checkerName:(null==c?void 0:c.cus_name)||null,checkerPosition:(null==c?void 0:c.position)||"ຫົວໜ້າຝ່າຍບັນຊີ",checkerEmail:(null==c?void 0:c.cus_email)||null,checkerId:(null==c?void 0:c.cus_id)||(null==c?void 0:c.id)||null,checkedDate:d?d.toISOString().split("T")[0]:null,checkedTime:d?d.toLocaleTimeString("en-GB"):null,checkedDateTime:this.invoice.approvedAt,isChecked:!!this.invoice.checkerId&&!!this.invoice.approvedAt,isApproved:"approved"===this.invoice.status,checkerComment:this.invoice.checkerComment||null,status:this.invoice.status||"draft",version:this.invoice.version||1}},calculatedSubtotal:function(){return this.lineItems.reduce((function(t,line){return t+(parseFloat(line.quantity)||0)*(parseFloat(line.unitPrice)||0)}),0)},calculatedDiscount:function(){return this.lineItems.reduce((function(t,line){return t+(parseFloat(line.discountAmount)||0)}),0)},calculatedTax:function(){return this.lineItems.reduce((function(t,line){return t+(parseFloat(line.taxAmount)||0)}),0)},calculatedTotal:function(){return this.lineItems.reduce((function(t,line){return t+(parseFloat(line.lineTotal)||0)}),0)},isFormValid:function(){var t=this.form.invoiceNumber&&this.form.vendorInvoiceNumber&&this.form.vendorId&&this.form.invoiceDate&&this.form.dueDate&&this.form.currencyId&&this.form.exchangeRate&&parseFloat(this.form.exchangeRate)>0&&(!this.isEdit||this.form.reason),e=this.lineItems.length>0&&this.lineItems.every((function(line){return line.description&&(parseFloat(line.quantity)||0)>0&&(parseFloat(line.unitPrice)||0)>=0&&line.DRglAccountId&&line.CRglAccountId}));return t&&e}},watch:{visible:{handler:function(t){t?this.initializeDialog():this.resetDialog()},immediate:!0},invoice:{handler:function(){this.visible&&this.initializeDialog()}}},methods:{initializeDialog:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.activeTab="header",t.clearErrors(),!t.invoice){e.next=8;break}return t.form={id:t.invoice.id,invoiceNumber:t.invoice.invoiceNumber,vendorInvoiceNumber:t.invoice.vendorInvoiceNumber,vendorId:t.invoice.vendorId,invoiceDate:t.invoice.invoiceDate?t.invoice.invoiceDate.split("T")[0]:"",dueDate:t.invoice.dueDate?t.invoice.dueDate.split("T")[0]:"",description:t.invoice.description||"",totalAmount:t.invoice.totalAmount,exchangeRate:t.invoice.exchangeRate||1,currencyId:t.invoice.currencyId,makerId:t.invoice.makerId,note:t.invoice.note||"",reason:""},e.next=6,t.loadLineItems(t.invoice.id);case 6:e.next=11;break;case 8:t.resetForm(),t.currencies.length>0&&(n=t.currencies.find((function(t){return"LAK"===t.code}))||t.currencies.find((function(t){return"USD"===t.code}))||t.currencies[0],t.form.currencyId=n.id,t.selectedCurrency=n,t.form.exchangeRate=(n.code,1)),t.lineItems=[t.createEmptyLine()];case 11:t.updateSelectedVendor(),t.updateSelectedCurrency();case 13:case"end":return e.stop()}}),e)})))()},resetDialog:function(){this.resetForm(),this.lineItems=[],this.selectedVendor=null,this.selectedCurrency=null,this.clearErrors(),this.activeTab="header",this.formLoading=!1,this.saving=!1,this.auditDialogVisible=!1},loadLineItems:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.get("/api/ap-invoices-lines/invoice/".concat(t));case 3:o=n.sent,data=o.data,e.lineItems=data.data||[e.createEmptyLine()],e.lineItems.forEach((function(line){line.tempId||(line.tempId=e.nextTempId++),e.calculateLineTotal(line)})),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.error("Error loading line items:",n.t0),e.lineItems=[e.createEmptyLine()];case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()},openAuditDialog:function(){this.form.id&&(this.auditDialogVisible=!0)},closeAuditDialog:function(){this.auditDialogVisible=!1},getInvoiceInfo:function(){return this.invoice?{invoiceNumber:this.form.invoiceNumber,vendorInvoiceNumber:this.form.vendorInvoiceNumber,totalAmount:this.calculatedTotal,status:this.invoice.status}:null},createEmptyLine:function(){return{tempId:this.nextTempId++,lineNumber:this.lineItems.length+1,description:"",quantity:1,unitPrice:0,DRglAccountId:"",CRglAccountId:"",discountRate:0,discountAmount:0,taxRate:0,taxAmount:0,lineTotal:0,note:""}},addNewLine:function(){this.lineItems.push(this.createEmptyLine())},addMultipleLines:function(t){for(var i=0;i<t;i++)this.lineItems.push(this.createEmptyLine())},removeLine:function(t){this.lineItems.length>1&&(this.lineItems.splice(t,1),this.updateLineNumbers())},updateLineNumbers:function(){this.lineItems.forEach((function(line,t){line.lineNumber=t+1}))},calculateLineTotal:function(line){var t=parseFloat(line.quantity)||0,e=parseFloat(line.unitPrice)||0,n=parseFloat(line.discountRate)||0,o=parseFloat(line.taxRate)||0,r=t*e,c=r*(n/100);line.discountAmount=c;var l=r-c,d=l*(o/100);line.taxAmount=d,line.lineTotal=l+d,this.calculateExchangeAmounts()},calculateExchangeAmounts:function(){this.clearFieldError("exchangeRate")},updateSelectedVendor:function(){var t=this;this.form.vendorId&&this.vendors.length>0?this.selectedVendor=this.vendors.find((function(e){return e.id===t.form.vendorId})):this.selectedVendor=null},updateSelectedCurrency:function(){var t=this;this.form.currencyId&&this.currencies.length>0?(this.selectedCurrency=this.currencies.find((function(e){return e.id===t.form.currencyId})),this.selectedCurrency&&"LAK"===this.selectedCurrency.code&&(this.form.exchangeRate=1)):this.selectedCurrency=null},onVendorChange:function(){this.updateSelectedVendor(),this.calculateDueDate(),this.clearFieldError("vendorId")},onCurrencyChange:function(){this.updateSelectedCurrency(),this.clearFieldError("currencyId")},calculateDueDate:function(){var t;if(this.form.invoiceDate&&null!==(t=this.selectedVendor)&&void 0!==t&&t.paymentTerms){var e=new Date(this.form.invoiceDate),n=new Date(e);n.setDate(n.getDate()+parseInt(this.selectedVendor.paymentTerms)),this.form.dueDate=n.toISOString().split("T")[0]}},validateForm:function(){if(this.errors={},this.form.invoiceNumber||(this.errors.invoiceNumber="ກະລຸນາໃສ່ເລກທີໃບແຈ້ງໜີ້"),this.form.vendorInvoiceNumber||(this.errors.vendorInvoiceNumber="ກະລຸນາໃສ່ເລກທີໃບແຈ້ງໜີ້ຜູ້ຂາຍ"),this.form.vendorId||(this.errors.vendorId="ກະລຸນາເລືອກຜູ້ຂາຍ"),this.form.currencyId||(this.errors.currencyId="ກະລຸນາເລືອກສະກຸນເງິນ"),this.form.exchangeRate?parseFloat(this.form.exchangeRate)<=0&&(this.errors.exchangeRate="ອັດຕາແລກປ່ຽນຕ້ອງຫຼາຍກວ່າ 0"):this.errors.exchangeRate="ກະລຸນາໃສ່ອັດຕາແລກປ່ຽນ",this.form.invoiceDate||(this.errors.invoiceDate="ກະລຸນາໃສ່ວັນທີໃບແຈ້ງໜີ້"),this.form.dueDate||(this.errors.dueDate="ກະລຸນາໃສ່ວັນທີຄົບກຳນົດ"),this.form.invoiceDate&&this.form.dueDate){var t=new Date(this.form.invoiceDate);new Date(this.form.dueDate)<=t&&(this.errors.dueDate="ວັນທີຄົບກຳນົດຕ້ອງຫຼັງຈາກວັນທີໃບແຈ້ງໜີ້")}if(0===this.lineItems.length)this.errors.lineItems="ກະລຸນາເພີ່ມລາຍການສິນຄ້າຢ່າງໜ້ອຍ 1 ລາຍການ";else for(var i=0;i<this.lineItems.length;i++){var line=this.lineItems[i];line.description||(this.errors["line_".concat(i,"_description")]="ກະລຸນາໃສ່ລາຍລະອຽດສິນຄ້າ"),(!line.quantity||parseFloat(line.quantity)<=0)&&(this.errors["line_".concat(i,"_quantity")]="ຈຳນວນຕ້ອງຫຼາຍກວ່າ 0"),(""===line.unitPrice||parseFloat(line.unitPrice)<0)&&(this.errors["line_".concat(i,"_unitPrice")]="ລາຄາຕ້ອງເປັນຄ່າບວກ"),line.DRglAccountId||(this.errors["line_".concat(i,"_DRglAccountId")]="ກະລຸນາເລືອກ DR Account"),line.CRglAccountId||(this.errors["line_".concat(i,"_CRglAccountId")]="ກະລຸນາເລືອກ CR Account")}return this.isEdit&&!this.form.reason&&(this.errors.reason="ກະລຸນາລະບຸເຫດຜົນຂອງການແກ້ໄຂ"),0===Object.keys(this.errors).length},clearErrors:function(){this.errors={}},clearFieldError:function(t){this.errors[t]&&this.$delete(this.errors,t)},handleSubmit:function(){var t;if(this.validateForm()){this.saving=!0;var e=l(l({},this.form),{},{makerId:this.form.makerId||(null===(t=this.user)||void 0===t?void 0:t.id),totalAmount:this.calculatedTotal,exchangeRate:parseFloat(this.form.exchangeRate)||1,lineItems:this.lineItems.map((function(line,t){return l(l({},line),{},{lineNumber:t+1,quantity:parseFloat(line.quantity)||0,unitPrice:parseFloat(line.unitPrice)||0,discountRate:parseFloat(line.discountRate)||0,taxRate:parseFloat(line.taxRate)||0})}))});this.$emit("save",e)}else Object.keys(this.errors).some((function(t){return t.startsWith("line_")}))?this.activeTab="lines":this.activeTab="header"},handleOverlayClick:function(){this.saving||this.handleClose()},handleClose:function(){this.$emit("close")},resetForm:function(){this.form={id:null,invoiceNumber:"",vendorInvoiceNumber:"",vendorId:"",invoiceDate:"",dueDate:"",description:"",totalAmount:"",exchangeRate:1,currencyId:"",makerId:"",note:"",reason:""}},formatCurrency:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD")||"USD",n=new Intl.NumberFormat("en-US",{style:"currency",currency:"LAK"===e?"USD":e,minimumFractionDigits:"LAK"===e?0:2,maximumFractionDigits:"LAK"===e?0:2});return"LAK"===e?"₭".concat(new Intl.NumberFormat("en-US").format(t||0)):n.format(t||0)},getStatusText:function(t){return{draft:"ຮ່າງ",pending:"ລໍຖ້າການອະນຸມັດ",approved:"ອະນຸມັດແລ້ວ",rejected:"ປະຕິເສດ",paid:"ຈ່າຍແລ້ວ",cancelled:"ຍົກເລີກ"}[t]||t}}},v=d,f=(n(1514),n(32)),component=Object(f.a)(v,(function(){var t,e,n,o,r,c,l,d,v,f=this,m=f._self._c;return f.visible?m("div",{staticClass:"modal-overlay",on:{click:f.handleOverlayClick}},[m("div",{staticClass:"enhanced-dialog",on:{click:function(t){t.stopPropagation()}}},[m("div",{staticClass:"modal-header"},[m("h4",{staticClass:"modal-title"},[m("i",{staticClass:"fas fa-file-invoice"}),f._v("\n        "+f._s(f.isEdit?"ແກ້ໄຂໃບແຈ້ງໜີ້":"ເພີ່ມໃບແຈ້ງໜີ້ໃໝ່")+"\n      ")]),f._v(" "),m("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:f.handleClose}},[m("i",{staticClass:"fas fa-times"})])]),f._v(" "),m("div",{staticClass:"modal-body"},[f.formLoading?m("div",{staticClass:"loading-state"},[m("div",{staticClass:"spinner"}),f._v(" "),m("p",[f._v("ກຳລັງໂຫຼດຂໍ້ມູນ...")])]):m("div",{staticClass:"invoice-form"},[m("div",{staticClass:"tab-navigation"},[m("button",{class:["tab-btn",{active:"header"===f.activeTab}],attrs:{type:"button"},on:{click:function(t){f.activeTab="header"}}},[m("i",{staticClass:"fas fa-file-alt"}),f._v("\n            ຂໍ້ມູນໃບແຈ້ງໜີ້\n          ")]),f._v(" "),m("button",{class:["tab-btn",{active:"lines"===f.activeTab}],attrs:{type:"button"},on:{click:function(t){f.activeTab="lines"}}},[m("i",{staticClass:"fas fa-list"}),f._v("\n            ລາຍການສິນຄ້າ\n            "),f.lineItems.length>0?m("span",{staticClass:"line-count"},[f._v(f._s(f.lineItems.length))]):f._e()])]),f._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:"header"===f.activeTab,expression:"activeTab === 'header'"}],staticClass:"tab-content"},[m("form",{on:{submit:function(t){return t.preventDefault(),f.handleSubmit.apply(null,arguments)}}},[m("div",{staticClass:"form-section"},[f._m(0),f._v(" "),m("div",{staticClass:"form-row"},[m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"invoiceNumber"}},[f._v("ເລກທີໃບແຈ້ງໜີ້")]),f._v(" "),m("input",{directives:[{name:"model",rawName:"v-model",value:f.form.invoiceNumber,expression:"form.invoiceNumber"}],staticClass:"form-control",class:{"is-invalid":f.errors.invoiceNumber},attrs:{id:"invoiceNumber",type:"text",placeholder:"ເຊັ່ນ: INV-2025-001",readonly:f.isEdit},domProps:{value:f.form.invoiceNumber},on:{input:function(t){t.target.composing||f.$set(f.form,"invoiceNumber",t.target.value)}}}),f._v(" "),f.errors.invoiceNumber?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.invoiceNumber)+"\n                  ")]):f._e()]),f._v(" "),m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"vendorInvoiceNumber"}},[f._v("ເລກທີໃບແຈ້ງໜີ້ຜູ້ຂາຍ")]),f._v(" "),m("input",{directives:[{name:"model",rawName:"v-model",value:f.form.vendorInvoiceNumber,expression:"form.vendorInvoiceNumber"}],staticClass:"form-control",class:{"is-invalid":f.errors.vendorInvoiceNumber},attrs:{id:"vendorInvoiceNumber",type:"text",placeholder:"ເລກທີໃບແຈ້ງໜີ້ຂອງຜູ້ຂາຍ"},domProps:{value:f.form.vendorInvoiceNumber},on:{input:function(t){t.target.composing||f.$set(f.form,"vendorInvoiceNumber",t.target.value)}}}),f._v(" "),f.errors.vendorInvoiceNumber?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.vendorInvoiceNumber)+"\n                  ")]):f._e()])]),f._v(" "),m("div",{staticClass:"form-row"},[m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"vendorId"}},[f._v("ຜູ້ຂາຍ")]),f._v(" "),m("select",{directives:[{name:"model",rawName:"v-model",value:f.form.vendorId,expression:"form.vendorId"}],staticClass:"form-control",class:{"is-invalid":f.errors.vendorId},attrs:{id:"vendorId"},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));f.$set(f.form,"vendorId",t.target.multiple?e:e[0])},f.onVendorChange]}},[m("option",{attrs:{value:""}},[f._v("ເລືອກຜູ້ຂາຍ")]),f._v(" "),f._l(f.vendors,(function(t){return m("option",{key:t.id,domProps:{value:t.id}},[f._v("\n                      "+f._s(t.name)+" ("+f._s(t.vendorCode)+")\n                    ")])}))],2),f._v(" "),f.errors.vendorId?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.vendorId)+"\n                  ")]):f._e()]),f._v(" "),m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"currencyId"}},[f._v("ສະກຸນເງິນ")]),f._v(" "),m("select",{directives:[{name:"model",rawName:"v-model",value:f.form.currencyId,expression:"form.currencyId"}],staticClass:"form-control",class:{"is-invalid":f.errors.currencyId},attrs:{id:"currencyId"},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));f.$set(f.form,"currencyId",t.target.multiple?e:e[0])},f.onCurrencyChange]}},[m("option",{attrs:{value:""}},[f._v("ເລືອກສະກຸນເງິນ")]),f._v(" "),f._l(f.currencies,(function(t){return m("option",{key:t.id,domProps:{value:t.id}},[f._v("\n                      "+f._s(t.name)+" ("+f._s(t.code)+")\n                    ")])}))],2),f._v(" "),f.errors.currencyId?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.currencyId)+"\n                  ")]):f._e()])]),f._v(" "),m("div",{staticClass:"form-row"},[m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"exchangeRate"}},[f._v("\n                    ອັດຕາແລກປ່ຽນ\n                    "),f.selectedCurrency?m("span",{staticClass:"currency-info"},[f._v("\n                      ("+f._s(f.selectedCurrency.code)+" ຕໍ່ LAK)\n                    ")]):f._e()]),f._v(" "),m("div",{staticClass:"exchange-rate-input-group"},[m("input",{directives:[{name:"model",rawName:"v-model",value:f.form.exchangeRate,expression:"form.exchangeRate"}],staticClass:"form-control",class:{"is-invalid":f.errors.exchangeRate},attrs:{id:"exchangeRate",type:"number",step:"0.0001",min:"0",placeholder:"1.0000"},domProps:{value:f.form.exchangeRate},on:{blur:f.calculateExchangeAmounts,input:function(t){t.target.composing||f.$set(f.form,"exchangeRate",t.target.value)}}}),f._v(" "),f._m(1)]),f._v(" "),f.errors.exchangeRate?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.exchangeRate)+"\n                  ")]):f._e(),f._v(" "),m("small",{staticClass:"form-text text-muted"},[f._v("\n                    ໃຊ້ 1.0000 ສຳລັບ LAK ຫຼື ປ້ອນອັດຕາແລກປ່ຽນປັດຈຸບັນ\n                  ")])]),f._v(" "),m("div",{staticClass:"form-group col-md-6"},[f.selectedCurrency&&f.form.exchangeRate?m("div",{staticClass:"exchange-display"},[m("label",{staticClass:"exchange-label"},[f._v("ຍອດເງິນໃນສະກຸນທ້ອງຖິ່ນ")]),f._v(" "),m("div",{staticClass:"exchange-amount"},[m("span",{staticClass:"foreign-amount"},[f._v("\n                        "+f._s(f.formatCurrency(f.calculatedTotal,(null===(t=f.selectedCurrency)||void 0===t?void 0:t.code)||"USD"))+"\n                      ")]),f._v(" "),m("i",{staticClass:"fas fa-arrow-right exchange-arrow"}),f._v(" "),m("span",{staticClass:"local-amount"},[f._v("\n                        "+f._s(f.formatCurrency(f.calculatedTotal*parseFloat(f.form.exchangeRate||1),"LAK"))+"\n                      ")])])]):f._e()])])]),f._v(" "),m("div",{staticClass:"form-section"},[f._m(2),f._v(" "),m("div",{staticClass:"form-row"},[m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"invoiceDate"}},[f._v("ວັນທີໃບແຈ້ງໜີ້")]),f._v(" "),m("input",{directives:[{name:"model",rawName:"v-model",value:f.form.invoiceDate,expression:"form.invoiceDate"}],staticClass:"form-control",class:{"is-invalid":f.errors.invoiceDate},attrs:{id:"invoiceDate",type:"date"},domProps:{value:f.form.invoiceDate},on:{change:f.calculateDueDate,input:function(t){t.target.composing||f.$set(f.form,"invoiceDate",t.target.value)}}}),f._v(" "),f.errors.invoiceDate?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.invoiceDate)+"\n                  ")]):f._e()]),f._v(" "),m("div",{staticClass:"form-group col-md-6"},[m("label",{staticClass:"required",attrs:{for:"dueDate"}},[f._v("ວັນທີຄົບກຳນົດ")]),f._v(" "),m("input",{directives:[{name:"model",rawName:"v-model",value:f.form.dueDate,expression:"form.dueDate"}],staticClass:"form-control",class:{"is-invalid":f.errors.dueDate},attrs:{id:"dueDate",type:"date"},domProps:{value:f.form.dueDate},on:{input:function(t){t.target.composing||f.$set(f.form,"dueDate",t.target.value)}}}),f._v(" "),f.errors.dueDate?m("div",{staticClass:"invalid-feedback"},[f._v("\n                    "+f._s(f.errors.dueDate)+"\n                  ")]):f._e()])])]),f._v(" "),m("div",{staticClass:"form-section"},[f._m(3),f._v(" "),m("div",{staticClass:"form-group"},[m("label",{attrs:{for:"description"}},[f._v("ຄຳອະທິບາຍ")]),f._v(" "),m("textarea",{directives:[{name:"model",rawName:"v-model",value:f.form.description,expression:"form.description"}],staticClass:"form-control",attrs:{id:"description",rows:"3",placeholder:"ລາຍລະອຽດກ່ຽວກັບໃບແຈ້ງໜີ້..."},domProps:{value:f.form.description},on:{input:function(t){t.target.composing||f.$set(f.form,"description",t.target.value)}}})]),f._v(" "),m("div",{staticClass:"form-group"},[m("label",{attrs:{for:"note"}},[f._v("ໝາຍເຫດເພີ່ມເຕີມ")]),f._v(" "),m("textarea",{directives:[{name:"model",rawName:"v-model",value:f.form.note,expression:"form.note"}],staticClass:"form-control",attrs:{id:"note",rows:"2",placeholder:"ໝາຍເຫດເພີ່ມເຕີມ (ຖ້າມີ)..."},domProps:{value:f.form.note},on:{input:function(t){t.target.composing||f.$set(f.form,"note",t.target.value)}}})]),f._v(" "),f.isEdit?m("div",{staticClass:"form-group"},[m("label",{staticClass:"required",attrs:{for:"reason"}},[f._v("ເຫດຜົນຂອງການແກ້ໄຂ")]),f._v(" "),m("input",{directives:[{name:"model",rawName:"v-model",value:f.form.reason,expression:"form.reason"}],staticClass:"form-control",class:{"is-invalid":f.errors.reason},attrs:{id:"reason",type:"text",placeholder:"ລະບຸເຫດຜົນຂອງການແກ້ໄຂ..."},domProps:{value:f.form.reason},on:{input:function(t){t.target.composing||f.$set(f.form,"reason",t.target.value)}}}),f._v(" "),f.errors.reason?m("div",{staticClass:"invalid-feedback"},[f._v("\n                  "+f._s(f.errors.reason)+"\n                ")]):f._e()]):f._e()]),f._v(" "),m("div",{staticClass:"amount-summary"},[m("div",{staticClass:"totals-grid"},[m("div",{staticClass:"total-item"},[m("label",[f._v("ລວມຍ່ອຍ:")]),f._v(" "),m("span",{staticClass:"amount"},[f._v(f._s(f.formatCurrency(f.calculatedSubtotal,null===(e=f.selectedCurrency)||void 0===e?void 0:e.code)))])]),f._v(" "),m("div",{staticClass:"total-item"},[m("label",[f._v("ສ່ວນຫຼຸດ:")]),f._v(" "),m("span",{staticClass:"amount discount"},[f._v("-"+f._s(f.formatCurrency(f.calculatedDiscount,null===(n=f.selectedCurrency)||void 0===n?void 0:n.code)))])]),f._v(" "),m("div",{staticClass:"total-item"},[m("label",[f._v("ພາສີ:")]),f._v(" "),m("span",{staticClass:"amount"},[f._v("+"+f._s(f.formatCurrency(f.calculatedTax,null===(o=f.selectedCurrency)||void 0===o?void 0:o.code)))])]),f._v(" "),m("div",{staticClass:"total-item grand-total"},[m("label",[f._v("ລວມທັງໝົດ:")]),f._v(" "),m("span",{staticClass:"amount"},[f._v(f._s(f.formatCurrency(f.calculatedTotal,null===(r=f.selectedCurrency)||void 0===r?void 0:r.code)))])]),f._v(" "),f.selectedCurrency&&"LAK"!==f.selectedCurrency.code&&f.form.exchangeRate?m("div",{staticClass:"total-item local-currency"},[m("label",[f._v("ລວມເປັນ LAK:")]),f._v(" "),m("span",{staticClass:"amount local"},[f._v(f._s(f.formatCurrency(f.calculatedTotal*parseFloat(f.form.exchangeRate||1),"LAK")))])]):f._e()])]),f._v(" "),f.isEdit?m("div",{staticClass:"form-section audit-trail-section"},[m("div",{staticClass:"audit-section-header"},[f._m(4),f._v(" "),m("button",{staticClass:"btn btn-outline-primary btn-view-audit",attrs:{type:"button"},on:{click:f.openAuditDialog}},[m("i",{staticClass:"fas fa-external-link-alt"}),f._v("\n                  ເບິ່ງປະຫວັດລະອຽດ\n                ")])]),f._v(" "),m("div",{staticClass:"audit-trail-container"},[m("div",{staticClass:"audit-card maker-card"},[f._m(5),f._v(" "),m("div",{staticClass:"audit-details"},[m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ຊື່ຜູ້ສ້າງ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.makerName))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ຕຳແໜ່ງ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.makerPosition))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ອີເມວ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.makerEmail||"-"))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ວັນທີສ້າງ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.createdDate))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ເວລາສ້າງ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.createdTime))])])])]),f._v(" "),m("div",{staticClass:"audit-card checker-card"},[m("div",{staticClass:"audit-header"},[f._m(6),f._v(" "),m("div",{staticClass:"audit-title"},[m("h6",[f._v("ຜູ້ກວດສອບ (Checker)")]),f._v(" "),m("span",{class:["audit-status",f.auditTrail.isChecked?"status-approved":"status-pending"]},[f._v("\n                        "+f._s(f.auditTrail.isChecked?"ອະນຸມັດແລ້ວ":"ລໍຖ້າການອະນຸມັດ")+"\n                      ")])])]),f._v(" "),m("div",{staticClass:"audit-details"},[m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ຊື່ຜູ້ກວດ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.checkerName||"-"))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ຕຳແໜ່ງ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.checkerPosition||"-"))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ອີເມວ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.checkerEmail||"-"))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ວັນທີກວດ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.checkedDate||"-"))])]),f._v(" "),m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ເວລາກວດ:")]),f._v(" "),m("span",{staticClass:"audit-value"},[f._v(f._s(f.auditTrail.checkedTime||"-"))])]),f._v(" "),f.auditTrail.checkerComment?m("div",{staticClass:"audit-row"},[m("span",{staticClass:"audit-label"},[f._v("ຄຳເຫັນ:")]),f._v(" "),m("span",{staticClass:"audit-value comment"},[f._v(f._s(f.auditTrail.checkerComment))])]):f._e()])]),f._v(" "),m("div",{staticClass:"approval-status-summary"},[m("div",{staticClass:"status-info-header"},[m("h6",[f._v("ສະຖານະເອກະສານ")]),f._v(" "),m("span",{class:["status-badge","status-".concat(f.auditTrail.status)]},[f._v("\n                      "+f._s(f.getStatusText(f.auditTrail.status))+"\n                    ")])]),f._v(" "),m("div",{staticClass:"status-workflow"},[m("div",{class:["workflow-step","step-created",{active:!0}]},[f._m(7),f._v(" "),m("span",{staticClass:"step-label"},[f._v("ສ້າງເອກະສານ")])]),f._v(" "),f._m(8),f._v(" "),m("div",{class:["workflow-step","step-pending",{active:f.auditTrail.isChecked}]},[f._m(9),f._v(" "),m("span",{staticClass:"step-label"},[f._v("ລໍຖ້າການອະນຸມັດ")])]),f._v(" "),f._m(10),f._v(" "),m("div",{class:["workflow-step","step-approved",{active:f.auditTrail.isApproved}]},[f._m(11),f._v(" "),m("span",{staticClass:"step-label"},[f._v("ອະນຸມັດແລ້ວ")])])])])])]):f._e()])]),f._v(" "),m("div",{directives:[{name:"show",rawName:"v-show",value:"lines"===f.activeTab,expression:"activeTab === 'lines'"}],staticClass:"tab-content"},[m("div",{staticClass:"line-items-section"},[m("div",{staticClass:"add-line-header"},[f._m(12),f._v(" "),m("div",{staticClass:"add-line-actions"},[m("button",{staticClass:"btn btn-primary btn-add-line",attrs:{type:"button"},on:{click:f.addNewLine}},[m("i",{staticClass:"fas fa-plus-circle"}),f._v("\n                  ເພີ່ມລາຍການສິນຄ້າ\n                ")]),f._v(" "),m("span",{staticClass:"line-count-info"},[f._v(f._s(f.lineItems.length)+" ລາຍການ")])])]),f._v(" "),0===f.lineItems.length?m("div",{staticClass:"empty-line-state"},[m("div",{staticClass:"empty-content"},[m("i",{staticClass:"fas fa-shopping-cart"}),f._v(" "),m("h4",[f._v("ຍັງບໍ່ມີລາຍການສິນຄ້າ")]),f._v(" "),m("p",[f._v("\n                  ກະລຸນາເພີ່ມສິນຄ້າຫຼືການບໍລິການພ້ອມກັບບັນຊີ GL\n                  ເພື່ອສ້າງໃບແຈ້ງໜີ້\n                ")]),f._v(" "),m("button",{staticClass:"btn btn-lg btn-primary",attrs:{type:"button"},on:{click:f.addNewLine}},[m("i",{staticClass:"fas fa-plus-circle"}),f._v("\n                  ເພີ່ມລາຍການທຳອິດ\n                ")])])]):m("div",{staticClass:"line-items-table-container"},[m("div",{staticClass:"line-items-table"},[m("table",{staticClass:"table"},[f._m(13),f._v(" "),m("tbody",f._l(f.lineItems,(function(line,t){var e;return m("tr",{key:line.tempId||line.id,staticClass:"line-row"},[m("td",{staticClass:"line-number"},[f._v(f._s(t+1))]),f._v(" "),m("td",[m("input",{directives:[{name:"model",rawName:"v-model",value:line.description,expression:"line.description"}],staticClass:"form-control form-control-sm",class:{"is-invalid":f.errors["line_".concat(t,"_description")]},attrs:{type:"text",placeholder:"ລາຍລະອຽດສິນຄ້າ/ການບໍລິການ..."},domProps:{value:line.description},on:{blur:function(t){return f.calculateLineTotal(line)},input:function(t){t.target.composing||f.$set(line,"description",t.target.value)}}})]),f._v(" "),m("td",[m("input",{directives:[{name:"model",rawName:"v-model",value:line.quantity,expression:"line.quantity"}],staticClass:"form-control form-control-sm",class:{"is-invalid":f.errors["line_".concat(t,"_quantity")]},attrs:{type:"number",step:"0.001",min:"0"},domProps:{value:line.quantity},on:{blur:function(t){return f.calculateLineTotal(line)},input:function(t){t.target.composing||f.$set(line,"quantity",t.target.value)}}})]),f._v(" "),m("td",[m("input",{directives:[{name:"model",rawName:"v-model",value:line.unitPrice,expression:"line.unitPrice"}],staticClass:"form-control form-control-sm",class:{"is-invalid":f.errors["line_".concat(t,"_unitPrice")]},attrs:{type:"number",step:"0.01",min:"0"},domProps:{value:line.unitPrice},on:{blur:function(t){return f.calculateLineTotal(line)},input:function(t){t.target.composing||f.$set(line,"unitPrice",t.target.value)}}})]),f._v(" "),m("td",[m("select",{directives:[{name:"model",rawName:"v-model",value:line.DRglAccountId,expression:"line.DRglAccountId"}],staticClass:"form-control form-control-sm",class:{"is-invalid":f.errors["line_".concat(t,"_DRglAccountId")]},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));f.$set(line,"DRglAccountId",t.target.multiple?e:e[0])}}},[m("option",{attrs:{value:""}},[f._v("ເລືອກ DR Account")]),f._v(" "),f._l(f.glAccounts,(function(t){return m("option",{key:t.id,domProps:{value:t.id}},[f._v("\n                            "+f._s(t.accountNumber)+" -\n                            "+f._s(t.accountName)+"\n                          ")])}))],2)]),f._v(" "),m("td",[m("select",{directives:[{name:"model",rawName:"v-model",value:line.CRglAccountId,expression:"line.CRglAccountId"}],staticClass:"form-control form-control-sm",class:{"is-invalid":f.errors["line_".concat(t,"_CRglAccountId")]},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));f.$set(line,"CRglAccountId",t.target.multiple?e:e[0])}}},[m("option",{attrs:{value:""}},[f._v("ເລືອກ CR Account")]),f._v(" "),f._l(f.glAccounts,(function(t){return m("option",{key:t.id,domProps:{value:t.id}},[f._v("\n                            "+f._s(t.accountNumber)+" -\n                            "+f._s(t.accountName)+"\n                          ")])}))],2)]),f._v(" "),m("td",[m("input",{directives:[{name:"model",rawName:"v-model",value:line.discountRate,expression:"line.discountRate"}],staticClass:"form-control form-control-sm",attrs:{type:"number",step:"0.01",min:"0",max:"100"},domProps:{value:line.discountRate},on:{blur:function(t){return f.calculateLineTotal(line)},input:function(t){t.target.composing||f.$set(line,"discountRate",t.target.value)}}})]),f._v(" "),m("td",[m("input",{directives:[{name:"model",rawName:"v-model",value:line.taxRate,expression:"line.taxRate"}],staticClass:"form-control form-control-sm",attrs:{type:"number",step:"0.01",min:"0",max:"100"},domProps:{value:line.taxRate},on:{blur:function(t){return f.calculateLineTotal(line)},input:function(t){t.target.composing||f.$set(line,"taxRate",t.target.value)}}})]),f._v(" "),m("td",{staticClass:"line-total"},[f._v("\n                        "+f._s(f.formatCurrency(line.lineTotal||0,null===(e=f.selectedCurrency)||void 0===e?void 0:e.code))+"\n                      ")]),f._v(" "),m("td",[m("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button",title:"ລຶບລາຍການ"},on:{click:function(e){return f.removeLine(t)}}},[m("i",{staticClass:"fas fa-trash"})])])])})),0)])]),f._v(" "),m("div",{staticClass:"add-more-lines"},[m("button",{staticClass:"btn btn-outline-primary btn-add-more",attrs:{type:"button"},on:{click:f.addNewLine}},[m("i",{staticClass:"fas fa-plus"}),f._v("\n                  ເພີ່ມລາຍການໃໝ່\n                ")]),f._v(" "),m("div",{staticClass:"quick-add-buttons"},[m("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(t){return f.addMultipleLines(3)}}},[f._v("\n                    ເພີ່ມ 3 ລາຍການ\n                  ")]),f._v(" "),m("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(t){return f.addMultipleLines(5)}}},[f._v("\n                    ເພີ່ມ 5 ລາຍການ\n                  ")])])]),f._v(" "),m("div",{staticClass:"line-totals-summary"},[m("div",{staticClass:"totals-grid"},[m("div",{staticClass:"total-item"},[m("label",[f._v("ລວມຍ່ອຍ:")]),f._v(" "),m("span",{staticClass:"amount"},[f._v(f._s(f.formatCurrency(f.calculatedSubtotal,null===(c=f.selectedCurrency)||void 0===c?void 0:c.code)))])]),f._v(" "),m("div",{staticClass:"total-item"},[m("label",[f._v("ສ່ວນຫຼຸດ:")]),f._v(" "),m("span",{staticClass:"amount discount"},[f._v("-"+f._s(f.formatCurrency(f.calculatedDiscount,null===(l=f.selectedCurrency)||void 0===l?void 0:l.code)))])]),f._v(" "),m("div",{staticClass:"total-item"},[m("label",[f._v("ພາສີ:")]),f._v(" "),m("span",{staticClass:"amount"},[f._v("+"+f._s(f.formatCurrency(f.calculatedTax,null===(d=f.selectedCurrency)||void 0===d?void 0:d.code)))])]),f._v(" "),m("div",{staticClass:"total-item grand-total"},[m("label",[f._v("ລວມທັງໝົດ:")]),f._v(" "),m("span",{staticClass:"amount"},[f._v(f._s(f.formatCurrency(f.calculatedTotal,null===(v=f.selectedCurrency)||void 0===v?void 0:v.code)))])]),f._v(" "),f.selectedCurrency&&"LAK"!==f.selectedCurrency.code&&f.form.exchangeRate?m("div",{staticClass:"total-item local-currency"},[m("label",[f._v("ລວມເປັນ LAK:")]),f._v(" "),m("span",{staticClass:"amount local"},[f._v(f._s(f.formatCurrency(f.calculatedTotal*parseFloat(f.form.exchangeRate||1),"LAK")))])]):f._e()])])])])])])]),f._v(" "),m("div",{staticClass:"modal-footer"},[m("div",{staticClass:"footer-actions"},[m("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:f.saving},on:{click:f.handleClose}},[m("i",{staticClass:"fas fa-times"}),f._v("\n          ຍົກເລີກ\n        ")]),f._v(" "),m("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:f.saving||!f.isFormValid},on:{click:f.handleSubmit}},[f.saving?m("i",{staticClass:"fas fa-spinner fa-spin"}):m("i",{staticClass:"fas fa-save"}),f._v("\n          "+f._s(f.saving?"ກຳລັງບັນທຶກ...":f.isEdit?"ອັບເດດ":"ບັນທຶກ")+"\n        ")])])])]),f._v(" "),m("audit-log-dialog",{attrs:{visible:f.auditDialogVisible,"invoice-id":f.form.id,"invoice-info":f.getInvoiceInfo()},on:{close:f.closeAuditDialog}})],1):f._e()}),[function(){var t=this._self._c;return t("h5",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-info-circle"}),this._v("\n                ຂໍ້ມູນພື້ນຖານ\n              ")])},function(){var t=this._self._c;return t("div",{staticClass:"exchange-rate-addon"},[t("i",{staticClass:"fas fa-exchange-alt"})])},function(){var t=this._self._c;return t("h5",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-calendar-alt"}),this._v("\n                ວັນທີ\n              ")])},function(){var t=this._self._c;return t("h5",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-clipboard-list"}),this._v("\n                ລາຍລະອຽດ\n              ")])},function(){var t=this._self._c;return t("h5",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-history"}),this._v("\n                  ປະຫວັດການດຳເນີນງານ\n                ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"audit-header"},[e("div",{staticClass:"audit-icon maker-icon"},[e("i",{staticClass:"fas fa-user-edit"})]),t._v(" "),e("div",{staticClass:"audit-title"},[e("h6",[t._v("ຜູ້ສ້າງເອກະສານ (Maker)")]),t._v(" "),e("span",{staticClass:"audit-status status-created"},[t._v("ສ້າງແລ້ວ")])])])},function(){var t=this._self._c;return t("div",{staticClass:"audit-icon checker-icon"},[t("i",{staticClass:"fas fa-user-check"})])},function(){var t=this._self._c;return t("div",{staticClass:"step-icon"},[t("i",{staticClass:"fas fa-plus-circle"})])},function(){var t=this._self._c;return t("div",{staticClass:"workflow-arrow"},[t("i",{staticClass:"fas fa-arrow-right"})])},function(){var t=this._self._c;return t("div",{staticClass:"step-icon"},[t("i",{staticClass:"fas fa-clock"})])},function(){var t=this._self._c;return t("div",{staticClass:"workflow-arrow"},[t("i",{staticClass:"fas fa-arrow-right"})])},function(){var t=this._self._c;return t("div",{staticClass:"step-icon"},[t("i",{staticClass:"fas fa-check-circle"})])},function(){var t=this._self._c;return t("h5",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-list"}),this._v("\n                ລາຍການສິນຄ້າ / ການບໍລິການ\n              ")])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{staticStyle:{width:"40px"}},[t._v("#")]),t._v(" "),e("th",{staticStyle:{width:"180px"}},[t._v("ລາຍລະອຽດ *")]),t._v(" "),e("th",{staticStyle:{width:"70px"}},[t._v("ຈຳນວນ *")]),t._v(" "),e("th",{staticStyle:{width:"80px"}},[t._v("ລາຄາຕໍ່ຫົວ *")]),t._v(" "),e("th",{staticStyle:{width:"120px"}},[t._v("DR Account *")]),t._v(" "),e("th",{staticStyle:{width:"120px"}},[t._v("CR Account *")]),t._v(" "),e("th",{staticStyle:{width:"60px"}},[t._v("ສ່ວນຫຼຸດ%")]),t._v(" "),e("th",{staticStyle:{width:"60px"}},[t._v("ພາສີ%")]),t._v(" "),e("th",{staticStyle:{width:"100px"}},[t._v("ລວມ")]),t._v(" "),e("th",{staticStyle:{width:"60px"}},[t._v("ລຶບ")])])])}],!1,null,"49f64b14",null);e.default=component.exports}}]);