(window.webpackJsonp=window.webpackJsonp||[]).push([[5,77,232],{815:function(e,t,r){"use strict";r.r(t);var o=r(317),n=r(314),l=r(18),c=r(313),d=r(783),m={props:{message:{type:String,default:""}},methods:{toggleDialog:function(){this.$emit("closedialog")}}},f=r(32),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;return t(n.a,[t(l.d,{staticClass:"text-h5 grey lighten-2"},[e._v(" ຂໍ້ຄວາມ ")]),e._v(" "),t(l.c,[e._v("\n    "+e._s(e.message)+"\n  ")]),e._v(" "),t(c.a),e._v(" "),t(l.a,[t(d.a),e._v(" "),t(o.a,{attrs:{color:"primary",text:""},on:{click:e.toggleDialog}},[e._v(" ຕົກລົງ ")])],1)],1)}),[],!1,null,null,null);t.default=component.exports},862:function(e,t,r){"use strict";r.r(t);var o=r(788),n=r(311),l=r(317),c=r(1716),d=r(314),m=r(18),f=r(821),v=r(318),h=r(786),_=r(760),y=r(955),x=r(787),D=r(167),w=r(244),C=r(785),k=r(783),P=r(870),L=r(113),I=r(817),O=(r(10),r(7),r(9),r(12),r(13),r(20)),$=r(3),R=(r(92),r(34),r(5),r(8),r(30),r(68),r(62),r(44),r(35),r(54),r(53),r(36)),S=r(899),j=r(40);function M(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?M(Object(source),!0).forEach((function(t){Object($.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):M(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var U={middleware:"auths",mixins:[S.default],data:function(){return{priceListFormKey:1,pricingRecordId:null,priceListDialog:!1,threeColPaper:!1,preview:!1,previewSrc:null,dialog:!1,dialogMessage:!1,message:"",isloading:!1,valid:!0,barcodeImage:"",name:"",title:"ເພີ່ມສິນຄ້າ",rules:{nameRule:[function(e){return!!e||"ກະລຸນາ ໃສ່ຊື່ສິນຄ້າ "},function(e){return e&&e.length<=150||"ຊື່ສິນຄ້າ ຍາວເກີນໄປ ກຳນົດ 150 ຕົວ"}],priceRule:[function(e){return+e>=0||"ກະລຸນ ໃສ່ຈຳນວ > 0"},function(e){return!!/^\d+$/.test(e)||"ກະລຸນສາໃສ່ຈຳນວນ ເປັນຕົວເລກ ເທົ່ານັ້ນ"}],minRule:[function(e){return!!/^\d+$/.test(e)||"ກະລຸນສາໃສ່ຈຳນວນ ເປັນຕົວເລກ ເທົ່ານັ້ນ"}],costPrice:[function(e){return!!/^\d+$/.test(e)||"ກະລຸນສາໃສ່ ເປັນຕົວເລກ ເທົ່ານັ້ນ"}],retailRule:[function(e){return+e>=0||"ກະລຸນ ໃສ່ເປີເຊັນ > 0"},function(e){return!!/^\d+$/.test(e)||"ກະລຸນສາໃສ່ ເປັນຕົວເລກ ເທົ່ານັ້ນ"}],imageRule:[function(e){var t=0,r=0;return e?(e.forEach((function(e){t+=e.size,console.log("Size: "+e.size)})),r=t/e.length,console.log("File size: aaa"+e.length+" Each: "+r||!1)):console.log("File: "+e),console.log("Total: "+r),r<2e6||"ຂະຫນາດເກີນ"}]},category:[],formData:{companyId:1,pro_category:1001,pro_id:null,pro_name:"",pro_price:0,pro_retail_price:0,pro_desc:"",pro_status:!1,pro_cost_price:0,createdAt:null,minStock:0,barCode:"",receiveUnitId:1,stockUnitId:1,saleCurrencyId:1,costCurrencyId:1,isActive:!0,vendorName:""},companyList:[]}},mounted:function(){this.fetchCategory(),this.fetchCompany()},watch:{message:function(e){this.dialogMessage=null!=e},formData:function(e){console.log("Watch fromData"+e)}},computed:N(N({},Object(j.c)(["findAllProductPriceListToCreate","findAllProduct","findAllClient","findAllPayment","findAllUnit","findAllCurrency"])),{},{unitList:function(){return this.findAllUnit},barcode3by2cm:function(){return"\n      <!DOCTYPE html>\n          <html>\n          <head\n          <title></title>\n          <style>\n\n          @font-face {\n            font-family: 'DM Sans';\n            font-style: normal;\n            font-weight: 200;\n            font-display: swap;\n            src: url('/notosan/NotoSansLao-Bold.ttf') format('truetype');\n        }\n          *{\n            font-family: 'DM Sans';\n          }\n        </style>\n            </head>\n            <body>\n              <div style=\"text-align: center;\">\n      <table style=\"width: 200px; text-align: center;\" >\n  <tr>\n    <td style=\"width: 50px; height: 20px;font-size:9px;\">\n        ລາຄາ:".concat(this.formatNumber(this.formData.pro_price),'\n      <img src="').concat(this.barcodeImage,'">\n    </td>\n    <td style="width: 50px; height: 20px;font-size:9px;">\n        ລາຄາ:').concat(this.formatNumber(this.formData.pro_price),'\n        <img src="').concat(this.barcodeImage,'">\n    </td>\n    <td style="width: 50px; height: 20px;font-size:9px;">\n        ລາຄາ:').concat(this.formatNumber(this.formData.pro_price),'\n        <img src="').concat(this.barcodeImage,'">\n       \n    </td>\n  \n  </tr>\n</table>\n</div>\n</body>\n            </html>\n')},barcodeNormal:function(){return"\n          <!DOCTYPE html>\n          <html>\n          <head\n          <title></title>\n          <style>\n\n          @font-face {\n            font-family: 'DM Sans';\n            font-style: normal;\n            font-weight: 400;\n            font-display: swap;\n            src: url('/notosan/NotoSansLao-Bold.ttf') format('truetype');\n        }\n          *{\n            font-family: 'DM Sans';\n          }\n        </style>\n            </head>\n            <body>\n              <div style=\"text-align: center;\">\n                    <table style=\"width: 200px; text-align: center;\" >\n                        <tr>\n                          <td style=\"width: 500px; height: 15px;font-size:8px;\">\n                            ລາຄາ:".concat(this.formatNumber(this.formData.pro_price),'\n                            </br>\n                            <img src="').concat(this.barcodeImage,'">\n                          </td>               \n                        </tr>\n                      </table>\n                </div>\n            </body>\n            </html>\n        ')}}),methods:N(N({},Object(j.b)(["clearProductPricesToCreate","addProductPricesToCreate","deleteProductPricesToCreate"])),{},{fetchData:function(){},triggerPriceListForm:function(){this.pricingRecordId=this.headerId,this.priceListFormKey+=1,this.priceListDialog=!0},validate:function(){this.$refs.form.validate()},formatNumber:function(e){return Object(R.e)(e)},generateBarcode:function(){var e=Math.floor(9e11*Math.random())+1e11,canvas=document.createElement("canvas");JsBarcode(canvas,e.toString(),{format:"code128",displayValue:!0,fontSize:20,margin:10}),this.formData.barCode=e.toString(),this.generateBarcodeImage(e)},generateBarcodeImage:function(e){var canvas=this.$refs.barcodeCanvas;console.log(".....Canvas logger....."),console.log(canvas),console.log(canvas.width,canvas.height),JsBarcode(canvas,e,{format:"code128",displayValue:!0,fontSize:12,width:1,height:13}),this.barcodeImage=canvas.toDataURL()},printBarcode:function(){var e=this.threeColPaper?this.barcode3by2cm:this.barcodeNormal,t=window.open("","","left=0,top=0,width=2480,height=3508,toolbar=0,scrollbars=0,status=0");t.document.open(),t.document.write(e),setTimeout((function(){t.print(),t.close()}),1e3)},reset:function(){this.$refs.form.reset()},resetValidation:function(){this.$refs.form.resetValidation()},fetchCategory:function(){var e=this;return Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,t.next=3,e.$axios.get("category_f").then((function(t){console.log("=>category"+t.data),e.category=t.data.map((function(e){return{categ_id:e.categ_id,categ_name:e.categ_name,categ_desc:e.categ_desc}})),e.formData.pro_category=e.category[0].categ_id})).catch((function(e){console.log("error: "+e.response.data)}));case 3:e.isloading=!1;case 4:case"end":return t.stop()}}),t)})))()},fetchCompany:function(){var e=this;return Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,e.$axios.get("api/company/find").then((function(t){console.log("=>Company"+t.data),e.companyList=t.data.map((function(e){return{id:e.id,name:e.name}})),e.formData.companyId=e.companyList[0].id})).catch((function(e){console.log("error: "+e.response.data)}));case 3:e.isLoading=!1;case 4:case"end":return t.stop()}}),t)})))()},uploadFiles:function(){var e=this;return Object(O.a)(regeneratorRuntime.mark((function t(){var r,o,n,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$refs.form.validate()){t.next=2;break}return t.abrupt("return");case 2:return e.isloading=!0,(r=new FormData).append("FORM",JSON.stringify(e.formData)),e.files.forEach((function(element){r.append("files",element)})),t.prev=6,t.next=9,e.$axios.post("uploadmulti",r,{headers:{"Content-Type":"multipart/form-data"}});case 9:return o=t.sent,n=o.data.split("|")[1],console.log("Product ID created: ".concat(n)),t.next=14,e.commitPriceListRecord(n);case 14:l=t.sent,console.info("Commit response ".concat(l)),e.isloading=!1,Object(R.k)(e.$swal,"Succeed","ດຳເນີນການສຳເລັດ"),console.info("Create product complete: response => ".concat(JSON.stringify(o))),e.$emit("refresh"),e.$emit("close-dialog"),t.next=28;break;case 23:t.prev=23,t.t0=t.catch(6),e.isloading=!1,Object(R.j)(e.$swal,"Error",t.t0),console.error("Error response:",t.t0.response);case 28:case"end":return t.stop()}}),t,null,[[6,23]])})))()},commitPriceListRecord:function(e){var t=this;return Object(O.a)(regeneratorRuntime.mark((function r(){var o,n,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.isloading=!0,o="api/priceList/create",console.log("API => ProductId='".concat(e,"'"),o),r.prev=3,n=t.findAllProductPriceListToCreate.map((function(r){var n=N(N({},r),{},{productId:e});return t.$axios.post(o,n)})),r.next=7,Promise.all(n);case 7:return(l=r.sent).forEach((function(e){console.log("Load data: ".concat(JSON.stringify(e)))})),t.clearProductPricesToCreate(),r.abrupt("return",l);case 13:return r.prev=13,r.t0=r.catch(3),Object(R.j)(t.$swal,"Error","ເກີດຂໍ້ຜິດພາດ ກະລຸນາລອງໃຫມ່ ພາຍຫລັງ ໃນການເພີ່ມ price list"),console.error("Error during price list commit:",r.t0),r.abrupt("return",null);case 18:case"end":return r.stop()}}),r,null,[[3,13]])})))()},previewImg:function(e){this.previewSrc=e,this.preview=!0}})},A=(r(959),r(32)),component=Object(A.a)(U,(function(){var e=this,t=e._self._c;return t("div",[t(_.a,{attrs:{"max-width":"300px",persistent:""},model:{value:e.dialogMessage,callback:function(t){e.dialogMessage=t},expression:"dialogMessage"}},[t("dialog-classic-message",{attrs:{message:e.message},on:{closedialog:function(t){e.message=null}}})],1),e._v(" "),t(_.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.isloading,callback:function(t){e.isloading=t},expression:"isloading"}},[t("loading-indicator")],1),e._v(" "),t(_.a,{attrs:{"hide-overlay":"",width:"400px"},model:{value:e.preview,callback:function(t){e.preview=t},expression:"preview"}},[t("dia-image",{attrs:{"i-url":e.previewSrc},on:{closeDia:function(t){e.preview=!1}}})],1),e._v(" "),t(_.a,{attrs:{"max-width":"800px"},model:{value:e.priceListDialog,callback:function(t){e.priceListDialog=t},expression:"priceListDialog"}},[t("price-list-form",{key:e.priceListFormKey,attrs:{"record-id":e.pricingRecordId},on:{"close-dialog":function(t){e.priceListDialog=!1},refresh:e.fetchData}})],1),e._v(" "),t(d.a,[t(m.d,{staticClass:"py-2"},[t(v.a,{attrs:{small:"",color:"primary","text-color":"white"}},[t(D.a,{attrs:{left:"",small:""}},[e._v("mdi-label")]),e._v("\n        "+e._s(e.title)+"\n      ")],1)],1),e._v(" "),t(m.c,{staticClass:"pa-3"},[t(x.a,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(C.a,{attrs:{dense:""}},[t(h.a,{attrs:{cols:"4"}},[t(o.a,{attrs:{"item-text":"name","item-value":"id",items:e.companyList,label:"ຮ້ານ*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.companyId,callback:function(t){e.$set(e.formData,"companyId",t)},expression:"formData.companyId"}})],1),e._v(" "),t(h.a,{attrs:{cols:"4"}},[t(o.a,{attrs:{"item-text":"categ_name","item-value":"categ_id",items:e.category,label:"ປະເພດສິນຄ້າ*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.pro_category,callback:function(t){e.$set(e.formData,"pro_category",t)},expression:"formData.pro_category"}})],1),e._v(" "),t(h.a,{attrs:{cols:"4"}},[t(L.a,{attrs:{value:e.formData.pro_id||"1XXX",label:"ໄອດີສິນຄ້າ",disabled:"",dense:"",outlined:"","hide-details":"auto"}})],1),e._v(" "),t(h.a,{attrs:{cols:"6"}},[t(L.a,{attrs:{rules:e.rules.nameRule,label:"ຊື້ສິນຄ້າ*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.pro_name,callback:function(t){e.$set(e.formData,"pro_name",t)},expression:"formData.pro_name"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(L.a,{attrs:{rules:e.rules.priceRule,label:"ລາຄາ*",type:"number",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.pro_price,callback:function(t){e.$set(e.formData,"pro_price",t)},expression:"formData.pro_price"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(L.a,{attrs:{rules:e.rules.priceRule,label:"ຕົ້ນທຶນ*",type:"number",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.pro_cost_price,callback:function(t){e.$set(e.formData,"pro_cost_price",t)},expression:"formData.pro_cost_price"}})],1),e._v(" "),t(h.a,{attrs:{cols:"2"}},[t(o.a,{attrs:{"item-text":"code","item-value":"id",items:e.findAllCurrency,label:"Currency*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.saleCurrencyId,callback:function(t){e.$set(e.formData,"saleCurrencyId",t)},expression:"formData.saleCurrencyId"}})],1),e._v(" "),t(h.a,{attrs:{cols:"2"}},[t(L.a,{attrs:{type:"number",label:"ລາຄາສົ່ງ %",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.pro_retail_price,callback:function(t){e.$set(e.formData,"pro_retail_price",t)},expression:"formData.pro_retail_price"}})],1),e._v(" "),t(h.a,{attrs:{cols:"2"}},[t(L.a,{attrs:{type:"number",label:"ສຕັອກຂັ້ນຕ່ຳ*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.minStock,callback:function(t){e.$set(e.formData,"minStock",t)},expression:"formData.minStock"}})],1),e._v(" "),t(h.a,{attrs:{cols:"6"}},[t(y.a,{ref:"filesfield",attrs:{multiple:"",accept:"image/png, image/jpeg, image/bmp",label:"ຮູບພາບ",dense:"",outlined:"","hide-details":"auto","prepend-icon":"","prepend-inner-icon":"mdi-camera"},on:{change:e.onFilesChange}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(L.a,{attrs:{label:"Barcode",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.barCode,callback:function(t){e.$set(e.formData,"barCode",t)},expression:"formData.barCode"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(o.a,{attrs:{"item-text":"name","item-value":"id",items:e.unitList,label:"ຫົວຫນ່ວຍຮັບ*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.receiveUnitId,callback:function(t){e.$set(e.formData,"receiveUnitId",t)},expression:"formData.receiveUnitId"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(o.a,{attrs:{"item-text":"name","item-value":"id",items:e.unitList,label:"ຫົວຫນ່ວຍສາງ*",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.stockUnitId,callback:function(t){e.$set(e.formData,"stockUnitId",t)},expression:"formData.stockUnitId"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(L.a,{attrs:{label:"Vendor",dense:"",outlined:"","hide-details":"auto"},model:{value:e.formData.vendorName,callback:function(t){e.$set(e.formData,"vendorName",t)},expression:"formData.vendorName"}})],1),e._v(" "),t(h.a,{attrs:{cols:"6"}},[t(I.a,{attrs:{label:"ຄຳອະທິບາຍ",rows:"2",dense:"",outlined:"","hide-details":"auto","no-resize":""},model:{value:e.formData.pro_desc,callback:function(t){e.$set(e.formData,"pro_desc",t)},expression:"formData.pro_desc"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(P.a,{attrs:{label:"Active",dense:"","hide-details":"",color:"success"},model:{value:e.formData.isActive,callback:function(t){e.$set(e.formData,"isActive",e._n(t))},expression:"formData.isActive"}})],1),e._v(" "),t(h.a,{attrs:{cols:"3"}},[t(l.a,{staticStyle:{"margin-top":"8px"},attrs:{small:"",color:"primary",outlined:"",block:""},on:{click:e.triggerPriceListForm}},[e._v("\n              ຈັດການລາຄາ\n            ")])],1),e._v(" "),t(h.a,{attrs:{cols:"6"}},[t(d.a,{staticClass:"pa-2",attrs:{outlined:""}},[t("canvas",{ref:"barcodeCanvas",staticStyle:{"max-width":"100%",height:"auto"}}),e._v(" "),t("div",{staticClass:"text-center text-caption mt-1"},[e._v("\n                ລາຄາ: "+e._s(e.formatNumber(e.formData.pro_price))+"\n              ")]),e._v(" "),t("div",{staticClass:"text-center mt-1"},[t(c.a,{attrs:{dense:""}},[t(l.a,{attrs:{"x-small":"",disabled:e.formData.barCode.length>0,color:"primary"},on:{click:e.generateBarcode}},[e._v("\n                    Generate\n                  ")]),e._v(" "),t(l.a,{attrs:{"x-small":"",disabled:0==e.formData.barCode.length,color:"success"},on:{click:e.printBarcode}},[e._v("\n                    Print\n                  ")])],1),e._v(" "),t(f.a,{staticClass:"mt-1",attrs:{label:"3Col",dense:"","hide-details":""},model:{value:e.threeColPaper,callback:function(t){e.threeColPaper=e._n(t)},expression:"threeColPaper"}})],1)])],1),e._v(" "),t(h.a,{attrs:{cols:"6"}},[t("div",{staticStyle:{"max-height":"150px","overflow-y":"auto"}},e._l(e.imagesPreviewURL,(function(r,o){return t("div",{key:o,staticClass:"d-flex align-center mb-1"},[t(n.a,{attrs:{size:"30"},on:{click:function(t){return e.previewImg(r.IMG_URL)}}},[t(w.a,{attrs:{src:r.IMG_URL}})],1),e._v(" "),t("div",{staticClass:"ml-2 flex-grow-1"},[t("div",{staticClass:"text-caption"},[e._v(e._s(r.NAME))]),e._v(" "),r.isvalid?t("div",{staticClass:"text-caption error--text"},[e._v(e._s(r.isvalid))]):e._e()]),e._v(" "),t(l.a,{attrs:{icon:"","x-small":"",color:"error"},on:{click:function(t){return e.deleteFile(o)}}},[t(D.a,{attrs:{"x-small":""}},[e._v("mdi-delete")])],1)],1)})),0)])],1)],1)],1),e._v(" "),t(m.a,{staticClass:"pa-3 pt-0"},[t(k.a),e._v(" "),t(l.a,{attrs:{text:"",small:""},on:{click:function(t){return e.$emit("close-dialog")}}},[e._v("\n        Close\n      ")]),e._v(" "),t(l.a,{attrs:{color:"primary",small:""},on:{click:e.uploadFiles}},[e._v("\n        Save\n      ")])],1)],1)],1)}),[],!1,null,"2f8e35d1",null);t.default=component.exports;installComponents(component,{DialogClassicMessage:r(815).default,LoadingIndicator:r(248).default,DiaImage:r(869).default,PriceListForm:r(859).default})},899:function(e,t,r){"use strict";r.r(t);r(5),r(54),r(53),r(822),r(447),r(35),r(121);var o={data:function(){return{imagesPreviewURL:[],files:[]}},methods:{onFilesChange:function(e){var t=e;if(this.files=e,t){console.log("FILE LEN: "+t.length);for(var i=0;i<t.length;i++)this.imagesPreviewURL.push({IMG_URL:URL.createObjectURL(t[i]),NAME:t[i].name,isvalid:this.sizeValidate(t[i].size)})}else this.imagesPreviewURL=null},deleteFile:function(e){this.imagesPreviewURL.splice(e,1),this.files.splice(e,1)},sizeValidate:function(e){console.log("SIZE"+e);var t=2e7;if(e>t)return"Max size is ".concat(2e4,"Kb")}}},n=r(32),component=Object(n.a)(o,undefined,undefined,!1,null,null,null);t.default=component.exports},911:function(e,t,r){var content=r(960);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(16).default)("42f082f5",content,!0,{sourceMap:!1})},959:function(e,t,r){"use strict";r(911)},960:function(e,t,r){var o=r(15)((function(i){return i[1]}));o.push([e.i,'.grey[data-v-2f8e35d1],.text-h5[data-v-2f8e35d1]{font-family:"Noto Sans Lao"}',""]),o.locals={},e.exports=o}}]);