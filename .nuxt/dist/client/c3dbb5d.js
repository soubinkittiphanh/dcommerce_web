(window.webpackJsonp=window.webpackJsonp||[]).push([[151,49,129],{1280:function(t,e,n){"use strict";n.r(e);var r=n(782),o=n(316),c=n(313),l=n(18),d=n(317),m=n(780),f=n(775),h=n(754),v=n(167),y=n(779),x=n(777),_=n(113),k=(n(10),n(7),n(9),n(11),n(12),n(20)),w=n(3),D=(n(92),n(22),n(66),n(5),n(8),n(820)),O=n(337),I=n(40);function A(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function j(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?A(Object(source),!0).forEach((function(e){Object(w.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):A(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var S={props:{paymentHeadId:{type:Number,default:""},isEdit:{type:Boolean,default:!1}},directives:{commaThousand:D.a},data:function(){return{account:[],drAccount:"",crAccount:"",amount:"",isloading:!1,bookingDate:"",paymentDescription:"",postingReference:"",paymentList:[],form:{header:{bookingDate:"",paymentNumber:"DEFAULT",payee:"ຮ້ານຄ້າທົ່ວໄປ",paymentId:null,currencyId:null,rate:1,totalAmount:"1,000",notes:"",update_user:1,drAccountId:15,crAccountId:1,isActive:!0},line:{}}}},mounted:function(){this.loadAccount(),this.loadPayment();var t=(new Date).toISOString().substr(0,10);this.bookingDate=t,this.form.header.bookingDate=t,this.form.header.currencyId=this.currencyList[0].id,this.isEdit&&(console.log("Load payment header"),this.loadPaymentById())},computed:j(j({},Object(I.c)(["findAllProduct","findAllClient","findAllPayment","findAllUnit","findAllCurrency","findAllTerminal","findSelectedTerminal"])),{},{today:function(){var t=(new Date).toLocaleDateString();return console.log(t),t},currencyList:function(){return this.findAllCurrency}}),methods:{loadPayment:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isloading=!0,t.paymentList=[],e.next=4,t.$axios.get("/api/paymentMethod/find").then((function(e){t.paymentList=e.data,t.form.header.paymentId=t.paymentList[0].id})).catch((function(e){Object(O.b)(t.$swal,"Error",e)}));case 4:t.isloading=!1;case 5:case"end":return e.stop()}}),e)})))()},currencyChange:function(){var t=this,e=this.currencyList.find((function(e){return e.id==t.form.header.currencyId}));e&&(this.form.header.rate=e.rate)},loadAccount:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isloading=!0,e.next=3,t.$axios.get("/api/account/find");case 3:e.sent.data.forEach((function(element){t.account.push({id:element.id,desc:element.accountName+" - "+element.accountNumber})})),t.isloading=!1;case 6:case"end":return e.stop()}}),e)})))()},getFormatNum:function(t){return(new Intl.NumberFormat).format(t)},loadPaymentById:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isloading=!0,e.next=3,t.$axios.get("/api/finanicial/ap/header/find/".concat(t.paymentHeadId)).then((function(e){t.form.header=e.data,t.form.header.bookingDate=e.data.bookingDate.split("T")[0],t.form.header.totalAmount=t.getFormatNum(t.form.header.totalAmount)})).catch((function(e){Object(O.b)(t.$swal,"Error",e.response.data)}));case 3:case"end":return e.stop()}}),e)})))()},submitData:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isloading){e.next=2;break}return e.abrupt("return");case 2:if(t.isloading=!0,!t.isEdit){e.next=8;break}return e.next=6,t.$axios.put("/api/finanicial/ap/header/update/".concat(t.paymentHeadId),t.form.header).then((function(e){Object(O.c)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ"),t.$emit("reload"),t.$emit("close-dialog")})).catch((function(e){Object(O.b)(t.$swal,"Error",e.response.data)}));case 6:e.next=10;break;case 8:return e.next=10,t.$axios.post("/api/finanicial/ap/header/create",t.form.header).then((function(e){Object(O.c)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ"),t.$emit("reload"),t.$emit("close-dialog")})).catch((function(e){Object(O.b)(t.$swal,"Error",e.response.data.errors[0].msg)}));case 10:t.isloading=!1;case 11:case"end":return e.stop()}}),e)})))()}}},$=n(32),component=Object($.a)(S,(function(){var t=this,e=t._self._c;return e(y.a,{attrs:{justify:"center"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.props;return[e(o.a,t._b({attrs:{color:"primary"}},"v-btn",r,!1),[t._v("\n            Open Dialog\n        ")])]}}])},[t._v(" "),e(h.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(c.a,{staticClass:"pa-4"},[e(l.d,[e(d.a,{staticClass:"ma-0",attrs:{color:"primary",label:"","text-color":"white"}},[e(v.a,{attrs:{start:""}},[t._v("mdi-label")]),t._v("\n                ຄ່າໃຊ້ຈ່າຍ "+t._s(t.today)+"\n            ")],1)],1),t._v(" "),e(l.c,[e(f.a,[e(y.a,[e(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[e(_.a,{attrs:{label:"ເລກເອກະສານອ້າງອີງ*",required:""},model:{value:t.form.header.paymentNumber,callback:function(e){t.$set(t.form.header,"paymentNumber",e)},expression:"form.header.paymentNumber"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[e(_.a,{attrs:{type:"date",label:"ວັນທີ*",hint:"ເດຶອນ/ວັນ/ປີ 12/31/2023"},model:{value:t.form.header.bookingDate,callback:function(e){t.$set(t.form.header,"bookingDate",e)},expression:"form.header.bookingDate"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[e(_.a,{attrs:{label:"ຊຶ ບໍ່ລິສັດ ຫລື ຜູ້ຮັບ ການຊຳລະ*",hint:"ຊື່ບຸກຄົນ,ບໍລິສັດ ຫລື ຜູ້ຮັບການຊຳລະ","persistent-hint":"",required:""},model:{value:t.form.header.payee,callback:function(e){t.$set(t.form.header,"payee",e)},expression:"form.header.payee"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12"}},[e(_.a,{attrs:{label:"ເນື້ອໃນການຊຳລະ*",required:""},model:{value:t.form.header.notes,callback:function(e){t.$set(t.form.header,"notes",e)},expression:"form.header.notes"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[e(_.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ຈຳນວນເງິນ*",required:""},model:{value:t.form.header.totalAmount,callback:function(e){t.$set(t.form.header,"totalAmount",e)},expression:"form.header.totalAmount"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[e(r.a,{attrs:{items:t.currencyList,label:"ສະກຸນເງິນ*","item-text":"code","item-value":"id"},on:{input:t.currencyChange},model:{value:t.form.header.currencyId,callback:function(e){t.$set(t.form.header,"currencyId",e)},expression:"form.header.currencyId"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6",md:"4"}},[e(_.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ອັດຕາແລກປ່ຽນ*",required:""},model:{value:t.form.header.rate,callback:function(e){t.$set(t.form.header,"rate",e)},expression:"form.header.rate"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12"}},[e(r.a,{attrs:{"item-text":"payment_code","item-value":"id",items:t.paymentList,label:"ປະເພດການຊຳລະ *"},model:{value:t.form.header.paymentId,callback:function(e){t.$set(t.form.header,"paymentId",e)},expression:"form.header.paymentId"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6"}},[e(r.a,{attrs:{"item-text":"desc","item-value":"id",items:t.account,label:"ບັນຊີແຍກປະເພດ DR ACCOUNT*"},model:{value:t.form.header.drAccountId,callback:function(e){t.$set(t.form.header,"drAccountId",e)},expression:"form.header.drAccountId"}})],1),t._v(" "),e(m.a,{attrs:{cols:"12",sm:"6"}},[e(r.a,{attrs:{"item-text":"desc","item-value":"id",items:t.account,label:"ບັນຊີແຍກປະເພດ CR ACCOUNT*"},model:{value:t.form.header.crAccountId,callback:function(e){t.$set(t.form.header,"crAccountId",e)},expression:"form.header.crAccountId"}})],1)],1)],1),t._v(" "),e("small",[t._v("* ສະແດງເຖິງຟິວທີ່ຕ້ອງໃສ່ຂໍ້ມູນ")])],1),t._v(" "),e(l.a,[e(x.a),t._v(" "),e(o.a,{attrs:{color:"warning",rounded:"",variant:"text"},on:{click:function(e){return t.$emit("close-dialog")}}},[t._v("\n                Close\n            ")]),t._v(" "),e(o.a,{attrs:{color:"primary",rounded:"",variant:"text"},on:{click:t.submitData}},[t._v("\n                Save\n            ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},1657:function(t,e,n){"use strict";n.r(e);var r=n(316),o=n(313),c=n(18),l=n(780),d=n(789),m=n(1647),f=n(754),h=n(770),v=n(318),y=n(113),x=(n(35),n(131),n(62),n(34),n(69),n(54),n(7),n(67),n(93),n(53),n(20)),_=n(31),k=(n(92),n(30),n(333),n(5),n(8),n(1280)),w=n(36);function D(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var I={components:{ApPayment:k.default},mounted:function(){this.loadTxn()},data:function(){return{userId:"",search:"",isEdit:!1,dialog:!1,apFormKey:1,isloading:!1,menu1:!1,menu2:!1,txnList:[],selectedId:"",headers:[{text:"ວັນທີ",align:"center",value:"bookingDate",sortable:!0},{text:"ເລກອ້າງອີງ",align:"center",value:"paymentNumber"},{text:"ຍອດລວມ",align:"center",value:"totalAmount"},{text:"ສະກຸນ",align:"center",value:"currency.code"},{text:"ອັດຕາແລກປ່ຽນ",align:"center",value:"rate"},{text:"ຊຳລະດ້ວຍ",align:"center",value:"payment.payment_code"},{text:"ເບື້ອງຫນີ້",align:"center",value:"drAccount"},{text:"ເບື້ອງມີ",align:"center",value:"crAccount"},{text:"ເນື້ອໃນ",align:"center",value:"notes"},{text:"ເວລາສ້າງ",align:"center",value:"createdAt"},{text:"ແກ້ໄຂ",align:"end",value:"function",sortable:!1}],date:Object(w.d)(),date2:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),dateFormatted:this.formatDate(Object(w.d)()),dateFormatted2:this.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10))}},watch:{date:function(t){this.dateFormatted=this.formatDate(this.date),this.loadTxn()},date2:function(t){this.dateFormatted2=this.formatDate(this.date2),this.loadTxn()}},methods:{triggerDialog:function(){this.apFormKey+=1,this.selectedId=null,this.isEdit=!1,this.dialog=!0},formatDate:function(t){if(!t)return null;console.log("DATE FORMAT METHOD1: "+t);var e=this.formatDateToISO(t).split("-"),n=Object(_.a)(e,3),r=n[0],o=n[1],c=n[2];return"".concat(o,"/").concat(c,"/").concat(r)},parseDate:function(t){if(console.log("DATE PARSE METHOD1: "+t),!t)return null;var e=t.split("/"),n=Object(_.a)(e,3),r=n[0],o=n[1],c=n[2];return"".concat(c,"-").concat(r.padStart(2,"0"),"-").concat(o.padStart(2,"0"))},formatDateToISO:function(t){t instanceof Date||(t=new Date(t));var e=t.getFullYear(),n="".concat(t.getMonth()+1).padStart(2,"0"),r="".concat(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(r)},numberWithFormat:function(t){return Object(w.e)(t)},editItem:function(t){this.selectedId=t.id,this.isEdit=!0,this.apFormKey+=1,this.dialog=!0},loadTxn:function(){var t=this;return Object(x.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isloading=!0,n={startDate:t.date,endDate:t.date2},e.next=4,t.$axios.get("/api/finanicial/ap/header/findByDate",{params:{date:n}}).then((function(e){t.txnList=[];var n,r=D(e.data);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.bookingDate=o.bookingDate.split("T")[0],t.txnList.push(o)}}catch(t){r.e(t)}finally{r.f()}console.log("====> "+t.txnList[0])})).catch((function(t){}));case 4:t.isloading=!1;case 5:case"end":return e.stop()}}),e)})))()}},computed:{paymentCurrencyGrouping:function(){var t={};this.txnList.forEach((function(e){var n=e.totalAmount,r=e.currency;e.currencyId;t[r.code]||(t[r.code]=0),t[r.code]+=n}));var e=[];for(var n in t)console.log("Total for ".concat(n,": ").concat(t[n])),e.push({currency:n,amount:t[n]});return e}}},A=n(32),component=Object(A.a)(I,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center"},[e("div",[e(f.a,{attrs:{persistent:"",width:"1024"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e("ap-payment",{key:t.apFormKey,attrs:{"is-edit":t.isEdit,"payment-head-id":t.selectedId},on:{close:t.triggerDialog,"close-dialog":function(e){t.dialog=!1},reload:t.loadTxn}})],1)],1),t._v(" "),e(f.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(o.a,[e(c.d,[e(h.a,{attrs:{row:"",wrap:""}},[e(l.a,{attrs:{cols:"6"}},[e(v.a,{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(y.a,t._g(t._b({attrs:{label:"ຈາກວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(e){t.date=t.parseDate(t.dateFormatted)}},model:{value:t.dateFormatted,callback:function(e){t.dateFormatted=e},expression:"dateFormatted"}},"v-text-field",o,!1),r))]}}]),model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[t._v(" "),e(m.a,{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),e(v.a,{ref:"menu2",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(y.a,t._g(t._b({attrs:{label:"ຫາວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(e){t.date2=t.parseDate(t.dateFormatted2)}},model:{value:t.dateFormatted2,callback:function(e){t.dateFormatted2=e},expression:"dateFormatted2"}},"v-text-field",o,!1),r))]}}]),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[t._v(" "),e(m.a,{attrs:{"no-title":""},on:{input:function(e){t.menu2=!1}},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1),t._v(" "),e(r.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.triggerDialog}},[t._v("\n                        ສ້າງລາຍຈ່າຍ ")])],1),t._v(" "),e(l.a,{attrs:{cols:"6"}},[e(y.a,{attrs:{"append-icon":"mdi-magnify",label:"ຊອກຫາ","single-line":"","hide-detailsx":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),e(y.a,{attrs:{"append-icon":"mdi-magnify",label:"ລະຫັດຜູ້ຂາຍ","single-line":"","hide-detailsx":""},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}}),t._v(" "),e(r.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.loadTxn}},[t._v(" ດຶງລາຍງານ\n                    ")])],1)],1)],1),t._v(" "),e(c.c,[t.paymentCurrencyGrouping.length>0?e("table",{attrs:{border:"1"}},[e("thead",[e("tr",[e("th",[t._v("ສະກຸນເງິນ")]),t._v(" "),e("th",[t._v("ລວມຍອດ")])])]),t._v(" "),e("tbody",t._l(t.paymentCurrencyGrouping,(function(n){return e("tr",{key:n.currency},[e("td",[t._v(t._s(n.currency))]),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.numberWithFormat(n.amount)))])])})),0)]):t._e()]),t._v(" "),t.txnList?e(d.a,{attrs:{headers:t.headers,search:t.search,items:t.txnList},scopedSlots:t._u([{key:"item.function",fn:function(n){var o=n.item;return[e(r.a,{attrs:{color:"primary",text:""},on:{click:function(e){t.editItem(o),t.wallet=!0}}},[e("i",{staticClass:"fa-regular fa-pen-to-square"})])]}},{key:"item.totalAmount",fn:function(e){var n=e.item;return[t._v("\n\n                "+t._s(t.numberWithFormat(n.totalAmount))+"\n\n\n            ")]}}],null,!0)}):t._e()],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},820:function(t,e,n){"use strict";n(35),n(85);e.a={bind:function(t,e,n){t.addEventListener("input",(function(t){var e=t.target.value.replace(/[^0-9]/g,"");"NaN"===(e=parseInt(e,10).toLocaleString("en-US"))&&(e="0"),n.componentInstance.$emit("input",e)}))}}}}]);