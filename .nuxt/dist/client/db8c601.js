(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{1023:function(e,t,r){var content=r(1355);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(16).default)("cb671396",content,!0,{sourceMap:!1})},1354:function(e,t,r){"use strict";r(1023)},1355:function(e,t,r){var n=r(15)((function(i){return i[1]}));n.push([e.i,".cursor-pointer[data-v-a70deaa8]{cursor:pointer}.w-100[data-v-a70deaa8]{width:100%}.table-card[data-v-a70deaa8]:hover{transform:translateY(-2px);transition:transform .2s ease}.payment-method-card[data-v-a70deaa8]{border:2px solid transparent;transition:all .3s ease}.payment-method-card[data-v-a70deaa8]:hover{transform:translateY(-2px)}.payment-method-card.elevation-4[data-v-a70deaa8]{border:2px solid hsla(0,0%,100%,.3)}",""]),n.locals={},e.exports=n},1640:function(e,t,r){"use strict";r.r(t);var n=r(876),c=r(316),o=r(313),l=r(18),d=r(317),m=r(779),v=r(774),h=r(753),f=r(312),_=r(167),y=r(306),T=r(199),C=r(168),x=r(28),w=r(318),k=r(251),P=r(778),O=r(944),S=r(776),D=r(319),M=r(113),I=r(91),L=r(334),R=(r(339),r(35),r(10),r(7),r(11),r(8),r(12),r(3)),N=r(20);r(92),r(9),r(5),r(44),r(66),r(75),r(30);function A(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?A(Object(source),!0).forEach((function(t){Object(R.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):A(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var $={components:{PrintTicketDialog:r(982).default},name:"OperationsTableScreen",data:function(){return{showPrintConfirmDialog:!1,showCustomerPrint:!1,selectedTicket:null,restaurantConfig:{name:"Your Restaurant Name",address:"123 Main Street<br>City, State 12345<br>Phone: (555) 123-4567"},selectedTable:null,customerName:"Walk-in",partySize:1,showPOSDialog:!1,loading:!1,actionLoading:!1,tables:[],showPaymentDialog:!1,paymentList:[],selectedPaymentMethod:null,paymentLoading:!1,paymentAmount:0,snackbar:{show:!1,message:"",color:"success",icon:"mdi-check-circle",timeout:4e3}}},computed:{availableTables:function(){return this.tables.filter((function(table){return"available"===table.status})).length},occupiedTables:function(){return this.tables.filter((function(table){return"occupied"===table.status})).length},cleaningTables:function(){return this.tables.filter((function(table){return"cleaning"===table.status})).length},reservedTables:function(){return this.tables.filter((function(table){return"reserved"===table.status})).length}},mounted:function(){this.fetchTables()},methods:{handlePrintConfirmation:function(e){this.showPrintConfirmDialog=!1,e?this.printCustomerReceipt():this.showMessage("Payment of ".concat(this.formatPrice(this.paymentAmount)," processed successfully"),"success","mdi-check-circle"),this.paymentAmount=0},changeTableStatusSilent:function(e){var t=this;return Object(N.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n={status:e,timeOccupied:"occupied"===e?new Date:null,currentOrderId:"occupied"===e?t.selectedTable.currentOrderId:null},r.next=4,t.$axios.patch("api/tables/".concat(t.selectedTable.id,"/status"),n);case 4:"available"===e&&(t.selectedTable.customerName=null,t.selectedTable.timeOccupied=null,t.selectedTable.order=[],t.selectedTable.orderTotal=0,t.selectedTable.currentOrderId=null),t.selectedTable.status=e,t.fetchTables(),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),console.error("Failed to update table status silently:",r.t0);case 12:case"end":return r.stop()}}),r,null,[[0,9]])})))()},printCustomerReceipt:function(){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){var r,n,c,o,l,d,m,v,h,f,_,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Print customer receipt clicked"),e.selectedTable&&e.selectedTable.currentOrderId){t.next=4;break}return e.showMessage("No active order found for this table","warning","mdi-alert"),t.abrupt("return");case 4:return t.prev=4,e.actionLoading=!0,console.log("Fetching latest ticket data before printing..."),t.next=9,e.$axios.get("api/ticket/".concat(e.selectedTable.currentOrderId));case 9:if(r=t.sent,n=r.data.data||r.data,c=null,!n.clientId){t.next=24;break}return t.prev=13,t.next=16,e.$axios.get("api/client/find/".concat(n.clientId));case 16:o=t.sent,c=o.data.data||o.data,t.next=24;break;case 20:t.prev=20,t.t0=t.catch(13),console.warn("Could not fetch customer data:",t.t0),c=e.selectedTable.customerName?{name:e.selectedTable.customerName}:null;case 24:return t.next=26,e.$axios.get("api/ticketLine/ticket/".concat(n.id));case 26:return l=t.sent,d=l.data.data||l.data,m=[],t.prev=29,t.next=32,e.$axios.get("product_f/1");case 32:v=t.sent,h=v.data.data||v.data,m=h.map((function(e){return{id:e.id,pro_id:e.pro_id,pro_name:e.pro_name,categ_name:e.categ_name,stock_count:e.card_count||0,isActive:1===e.pro_status}})),t.next=40;break;case 37:t.prev=37,t.t1=t.catch(29),console.warn("Could not fetch products for mapping:",t.t1);case 40:f=d.map((function(line){var e,t=m.find((function(p){return p.id===line.productId}));return{id:line.productId,pro_id:line.productId,pro_name:(null===(e=line.product)||void 0===e?void 0:e.name)||(null==t?void 0:t.pro_name)||"Product ".concat(line.productId),categ_name:(null==t?void 0:t.categ_name)||"Unknown Category",stock_count:(null==t?void 0:t.stock_count)||0,isActive:(null==t?void 0:t.isActive)||!1,pro_price:line.unitPrice,quantity:line.quantity,ticketLineId:line.id,totalPrice:line.totalPrice||line.unitPrice*line.quantity,isFromTicketLine:!0,originalTicketLinePrice:line.unitPrice}})).filter((function(e){return e.pro_name})),(_=j(j({},n),{},{client:c,table:{id:e.selectedTable.id,number:e.selectedTable.number,name:"Table ".concat(e.selectedTable.number)},ticketLines:f})).subtotal||(y=f.reduce((function(e,t){return e+parseFloat(t.pro_price)*t.quantity}),0),_.subtotal=y,_.tax=.085*y,_.total=y+.085*y),console.log("Updated ticket for print:",_),console.log("Ticket lines count:",f.length),e.selectedTable.currentTotal=n.total,e.selectedTable.order=f,e.selectedTicket=_,e.showCustomerPrint=!0,e.showMessage("Receipt prepared for printing!","success","mdi-printer"),t.next=56;break;case 52:t.prev=52,t.t2=t.catch(4),console.error("Error fetching latest ticket data for printing:",t.t2),e.showMessage("Failed to load latest ticket data. Please try again.","warning","mdi-alert");case 56:return t.prev=56,e.actionLoading=!1,t.finish(56);case 59:case"end":return t.stop()}}),t,null,[[4,52,56,59],[13,20],[29,37]])})))()},closePrintDialog:function(){this.showCustomerPrint=!1,this.selectedTicket=null},onPrintSuccess:function(e){console.log("Ticket printed successfully:",e.id),this.showMessage("Receipt printed successfully!","success","mdi-printer")},fetchTables:function(){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$axios.get("api/tables");case 4:r=t.sent,console.log("Tables response:",r.data),n=r.data.data||r.data,e.tables=n.map((function(table){return{id:table.id,name:table.name,number:table.number,capacity:table.capacity,status:table.status,timeOccupied:table.timeOccupied?new Date(table.timeOccupied):null,currentOrderId:table.currentOrderId,createdAt:table.createdAt,updateTimestamp:table.updateTimestamp,customerName:null,order:[],orderTotal:0}})),e.showMessage("Loaded ".concat(e.tables.length," tables successfully!")),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.error("Error fetching tables:",t.t0),e.showMessage("Failed to load tables. Please try again.","error","mdi-alert");case 15:return t.prev=15,e.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,11,15,18]])})))()},selectTable:function(table){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.selectedTable=j({},table),e.partySize=1,t.next=4,e.loadTableTicketData(table.id);case 4:case"end":return t.stop()}}),t)})))()},loadTableTicketData:function(e){var t=this;return Object(N.a)(regeneratorRuntime.mark((function r(){var n,c,o,l,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.info("Loading data ".concat(e)),r.prev=1,r.next=4,t.$axios.get("api/ticket/table/".concat(e,"/pending"));case 4:if(n=r.sent,!((c=n.data||[]).length>0)){r.next=26;break}return o=c[0],t.selectedTable.currentTotal=o.total||0,t.selectedTable.currentOrderId=o.id,t.selectedTable.orderStatus=o.status,r.prev=11,r.next=14,t.$axios.get("api/ticketLine/ticket/".concat(o.id));case 14:l=r.sent,d=l.data.data||l.data||[],t.selectedTable.order=d,t.selectedTable.itemCount=d.reduce((function(e,line){return e+line.quantity}),0),r.next=24;break;case 20:r.prev=20,r.t0=r.catch(11),console.log("Could not fetch ticket lines:",r.t0),t.selectedTable.itemCount=0;case 24:r.next=30;break;case 26:t.selectedTable.currentTotal=0,t.selectedTable.currentOrderId=null,t.selectedTable.orderStatus=null,t.selectedTable.itemCount=0;case 30:r.next=39;break;case 32:r.prev=32,r.t1=r.catch(1),console.log("No pending tickets for table:",e),t.selectedTable.currentTotal=0,t.selectedTable.currentOrderId=null,t.selectedTable.orderStatus=null,t.selectedTable.itemCount=0;case 39:case"end":return r.stop()}}),r,null,[[1,32],[11,20]])})))()},seatCustomer:function(){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){var r,n,c,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.customerName.trim()){t.next=3;break}return e.showMessage("Please enter a customer name","warning","mdi-alert"),t.abrupt("return");case 3:return e.actionLoading=!0,t.prev=4,r={customerName:e.customerName.trim(),partySize:parseInt(e.partySize)||1},t.next=8,e.$axios.post("api/tables/".concat(e.selectedTable.id,"/seat-customer"),r);case 8:e.selectedTable.status="occupied",e.selectedTable.customerName=e.customerName.trim(),e.selectedTable.timeOccupied=new Date,e.showMessage("".concat(e.customerName," has been seated at Table ").concat(e.selectedTable.number),"success","mdi-check-circle"),e.customerName="",e.partySize=1,e.fetchTables(),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),console.error("Error seating customer:",t.t0),400===(null===(n=t.t0.response)||void 0===n?void 0:n.status)?(o=(null===(c=t.t0.response.data)||void 0===c?void 0:c.message)||"Invalid seating request",e.showMessage(o,"error","mdi-alert")):e.showMessage("Failed to seat customer. Please try again.","error","mdi-alert");case 21:return t.prev=21,e.actionLoading=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[4,17,21,24]])})))()},changeTableStatus:function(e){var t=this;return Object(N.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.actionLoading=!0,r.prev=1,n={status:e,timeOccupied:"occupied"===e?new Date:null,currentOrderId:"occupied"===e?t.selectedTable.currentOrderId:null},r.next=5,t.$axios.patch("api/tables/".concat(t.selectedTable.id,"/status"),n);case 5:"available"===e&&(t.selectedTable.customerName=null,t.selectedTable.timeOccupied=null,t.selectedTable.order=[],t.selectedTable.orderTotal=0,t.selectedTable.currentOrderId=null),t.selectedTable.status=e,t.showMessage("Table ".concat(t.selectedTable.number," marked as ").concat(t.getStatusText(e))),t.fetchTables(),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),t.showMessage("Failed to update table status. Please try again.","error","mdi-alert");case 14:return r.prev=14,t.actionLoading=!1,r.finish(14);case 17:case"end":return r.stop()}}),r,null,[[1,11,14,17]])})))()},markTableClean:function(){this.changeTableStatus("available")},seatReservedCustomer:function(){this.changeTableStatus("occupied")},cancelReservation:function(){this.changeTableStatus("available")},loadPaymentMethods:function(){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.paymentLoading=!0,e.paymentList=[],t.prev=2,t.next=5,e.$axios.get("/api/paymentMethod/find");case 5:r=t.sent,e.paymentList=r.data.filter((function(e){return e.isActive})),console.log("Payment methods loaded:",e.paymentList),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("Error loading payment methods:",t.t0),e.showMessage("Failed to load payment methods","error","mdi-alert");case 14:return t.prev=14,e.paymentLoading=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[2,10,14,17]])})))()},processPayment:function(){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((r=e.selectedTable.currentTotal||e.selectedTable.orderTotal||0)<=0)){t.next=4;break}return e.showMessage("No amount to process","warning","mdi-alert"),t.abrupt("return");case 4:return e.paymentAmount=r,t.next=7,e.loadPaymentMethods();case 7:e.showPaymentDialog=!0;case 8:case"end":return t.stop()}}),t)})))()},confirmPayment:function(){var e=this;return Object(N.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectedPaymentMethod){t.next=3;break}return e.showMessage("Please select a payment method","warning","mdi-alert"),t.abrupt("return");case 3:if(e.actionLoading=!0,t.prev=4,!e.selectedTable.currentOrderId){t.next=8;break}return t.next=8,e.$axios.patch("/api/ticket/".concat(e.selectedTable.currentOrderId,"/payment-status"),{paymentStatus:"paid",paymentId:e.selectedPaymentMethod.id});case 8:return e.closePaymentDialog(),e.showPrintConfirmDialog=!0,t.next=12,e.changeTableStatusSilent("cleaning");case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(4),console.error("Payment processing error:",t.t0),e.showMessage("Failed to process payment","error","mdi-alert");case 18:return t.prev=18,e.actionLoading=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[4,14,18,21]])})))()},closePaymentDialog:function(){this.showPaymentDialog=!1,this.selectedPaymentMethod=null,this.paymentAmount=0},openPOS:function(){this.showPOSDialog=!0},closePOS:function(){this.showPOSDialog=!1},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mdi-check-circle";this.snackbar={show:!0,message:e,color:t,icon:r,timeout:4e3}},getTableColor:function(e){return{available:"success",occupied:"warning",cleaning:"error",reserved:"info"}[e]||"grey"},getStatusText:function(e){return{available:"Available",occupied:"Occupied",cleaning:"Cleaning",reserved:"Reserved"}[e]||"Unknown"},getPaymentIcon:function(e){return{CASH:"mdi-cash",CARD:"mdi-credit-card",CREDIT:"mdi-credit-card-outline",DEBIT:"mdi-credit-card",MOBILE:"mdi-cellphone",DIGITAL:"mdi-wallet",BANK:"mdi-bank",CHECK:"mdi-checkbook"}[e]||"mdi-currency-usd"},getPaymentColor:function(e){return{CASH:"green",CARD:"blue",CREDIT:"purple",DEBIT:"indigo",MOBILE:"orange",DIGITAL:"teal",BANK:"brown",CHECK:"grey"}[e]||"primary"},formatTime:function(time){if(!time)return"";var e=Date.now()-time.getTime(),t=Math.floor(e/6e4),r=Math.floor(t/60);return r>0?"".concat(r,"h ").concat(t%60,"m"):"".concat(t,"m")},formatDate:function(e){return e?new Date(e).toLocaleDateString():""},formatPrice:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.round(e||0));return t?"".concat(r," ₭"):r},getTotalAmountColor:function(){var e=this.selectedTable.currentTotal||0;return 0===e?"grey--text":e>100?"success--text":"primary--text"},getOrderStatusColor:function(e){return{pending:"orange",preparing:"blue",ready:"green",served:"purple",paid:"success"}[e]||"grey"}}},z=$,E=(r(1354),r(32)),component=Object(E.a)(z,(function(){var e,t=this,r=t._self._c;return r(v.a,{staticClass:"pa-0 fill-height",attrs:{fluid:""}},[r(P.a,{staticClass:"fill-height",attrs:{"no-gutters":""}},[r(m.a,{staticClass:"d-flex flex-column",attrs:{cols:"8"}},[r(o.a,{staticClass:"ma-0 rounded-0",attrs:{elevation:"1"}},[r(l.d,{staticClass:"primary white--text"},[r(_.a,{attrs:{left:"",color:"white"}},[t._v("mdi-table-furniture")]),t._v("\n          Table Management\n          "),r(S.a),t._v(" "),r(d.a,{staticClass:"mr-2",attrs:{color:"success","text-color":"white"}},[r(_.a,{attrs:{left:"",small:""}},[t._v("mdi-check-circle")]),t._v("\n            Available: "+t._s(t.availableTables)+"\n          ")],1),t._v(" "),r(d.a,{staticClass:"mr-2",attrs:{color:"warning","text-color":"white"}},[r(_.a,{attrs:{left:"",small:""}},[t._v("mdi-clock")]),t._v("\n            Occupied: "+t._s(t.occupiedTables)+"\n          ")],1),t._v(" "),r(d.a,{staticClass:"mr-2",attrs:{color:"error","text-color":"white"}},[r(_.a,{attrs:{left:"",small:""}},[t._v("mdi-silverware-clean")]),t._v("\n            Cleaning: "+t._s(t.cleaningTables)+"\n          ")],1),t._v(" "),r(d.a,{attrs:{color:"info","text-color":"white"}},[r(_.a,{attrs:{left:"",small:""}},[t._v("mdi-bookmark")]),t._v("\n            Reserved: "+t._s(t.reservedTables)+"\n          ")],1)],1)],1),t._v(" "),t.loading?r(o.a,{staticClass:"flex-grow-1 ma-0 rounded-0 d-flex align-center justify-center"},[r("div",{staticClass:"text-center"},[r(k.a,{attrs:{size:"64",color:"primary",indeterminate:""}}),t._v(" "),r("p",{staticClass:"mt-4 text-h6"},[t._v("Loading tables...")])],1)]):r(o.a,{staticClass:"flex-grow-1 ma-0 rounded-0",staticStyle:{"overflow-y":"auto"}},[r(l.c,{staticClass:"pa-4"},[t.tables.length>0?r(P.a,t._l(t.tables,(function(table){return r(m.a,{key:table.id,staticClass:"pa-2",attrs:{cols:"3"}},[r(o.a,{class:["text-center pa-4 cursor-pointer table-card",t.selectedTable&&t.selectedTable.id===table.id?"elevation-8":"elevation-2"],attrs:{color:t.getTableColor(table.status),height:"150",hover:""},on:{click:function(e){return t.selectTable(table)}}},[r(l.d,{staticClass:"justify-center white--text text-h4 pa-2"},[t._v("\n                  "+t._s(table.number)+"\n                ")]),t._v(" "),r(l.c,{staticClass:"pa-2 white--text"},[r("div",{staticClass:"text-h6 font-weight-bold mb-1"},[t._v("\n                    "+t._s(t.getStatusText(table.status))+"\n                  ")]),t._v(" "),table.capacity?r("div",{staticClass:"caption"},[r(_.a,{attrs:{small:"",color:"white"}},[t._v("mdi-account-multiple")]),t._v("\n                    "+t._s(table.capacity)+" seats\n                  ")],1):t._e(),t._v(" "),table.orderTotal?r("div",{staticClass:"caption mt-1"},[r(_.a,{attrs:{small:"",color:"white"}},[t._v("mdi-currency-usd")]),t._v("\n                    $"+t._s(table.orderTotal.toFixed(2))+"\n                  ")],1):t._e(),t._v(" "),table.timeOccupied?r("div",{staticClass:"caption"},[r(_.a,{attrs:{small:"",color:"white"}},[t._v("mdi-clock-outline")]),t._v("\n                    "+t._s(t.formatTime(table.timeOccupied))+"\n                  ")],1):t._e()])],1)],1)})),1):r("div",{staticClass:"text-center pa-8"},[r(_.a,{attrs:{size:"64",color:"grey"}},[t._v("mdi-table-furniture")]),t._v(" "),r("p",{staticClass:"text-h6 mt-4 grey--text"},[t._v("No tables found")]),t._v(" "),r(c.a,{attrs:{color:"primary"},on:{click:t.fetchTables}},[r(_.a,{attrs:{left:""}},[t._v("mdi-refresh")]),t._v("\n              Refresh Tables\n            ")],1)],1)],1)],1)],1),t._v(" "),r(m.a,{staticClass:"d-flex flex-column",attrs:{cols:"4"}},[r(o.a,{staticClass:"flex-grow-1 ma-0 rounded-0 d-flex flex-column",attrs:{elevation:"2"}},[t.selectedTable?r(l.d,{staticClass:"secondary white--text"},[r(_.a,{attrs:{left:"",color:"white"}},[t._v("mdi-table-chair")]),t._v("\n          Table "+t._s(t.selectedTable.number)+"\n          "),r(S.a),t._v(" "),r(w.a,{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[r(c.a,t._g(t._b({attrs:{icon:"",color:"white"}},"v-btn",o,!1),n),[r(_.a,[t._v("mdi-dots-vertical")])],1)]}}],null,!1,1012294362)},[t._v(" "),r(y.a,[r(T.a,{on:{click:function(e){return t.changeTableStatus("available")}}},[r(C.a,[r(_.a,{attrs:{color:"success"}},[t._v("mdi-check-circle")])],1),t._v(" "),r(x.c,[t._v("Mark Available")])],1),t._v(" "),r(T.a,{on:{click:function(e){return t.changeTableStatus("cleaning")}}},[r(C.a,[r(_.a,{attrs:{color:"error"}},[t._v("mdi-silverware-clean")])],1),t._v(" "),r(x.c,[t._v("Mark for Cleaning")])],1),t._v(" "),r(T.a,{on:{click:function(e){return t.changeTableStatus("reserved")}}},[r(C.a,[r(_.a,{attrs:{color:"info"}},[t._v("mdi-bookmark")])],1),t._v(" "),r(x.c,[t._v("Mark Reserved")])],1)],1)],1)],1):r(l.d,{staticClass:"secondary white--text justify-center"},[r(_.a,{staticClass:"mr-2",attrs:{color:"white"}},[t._v("mdi-hand-pointing-right")]),t._v("\n          Select a Table\n        ")],1),t._v(" "),t.selectedTable?r(l.c,{staticClass:"flex-grow-1 pa-4"},[r(o.a,{staticClass:"mb-3",attrs:{outlined:""}},[r(l.b,[t._v("Table Information")]),t._v(" "),r(l.c,[r(P.a,{attrs:{dense:""}},[r(m.a,{attrs:{cols:"6"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Status")]),t._v(" "),r(d.a,{attrs:{color:t.getTableColor(t.selectedTable.status),"text-color":"white",small:""}},[t._v("\n                    "+t._s(t.getStatusText(t.selectedTable.status))+"\n                  ")])],1),t._v(" "),r(m.a,{attrs:{cols:"6"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Capacity")]),t._v(" "),r("div",{staticClass:"font-weight-medium"},[t._v("\n                    "+t._s(t.selectedTable.capacity)+" seats\n                  ")])]),t._v(" "),r(m.a,{attrs:{cols:"6"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Table Number")]),t._v(" "),r("div",{staticClass:"font-weight-medium"},[t._v("\n                    #"+t._s(t.selectedTable.number)+"\n                  ")])]),t._v(" "),r(m.a,{attrs:{cols:"6"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Current Total")]),t._v(" "),r("div",{staticClass:"font-weight-bold text-h6",class:t.getTotalAmountColor()},[t._v("\n                    "+t._s(t.formatPrice(t.selectedTable.currentTotal||0))+"\n                  ")])]),t._v(" "),r(m.a,{attrs:{cols:"6"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Created")]),t._v(" "),r("div",{staticClass:"font-weight-medium"},[t._v("\n                    "+t._s(t.formatDate(t.selectedTable.createdAt))+"\n                  ")])]),t._v(" "),t.selectedTable.currentOrderId?r(m.a,{attrs:{cols:"6"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Items in Order")]),t._v(" "),r("div",{staticClass:"font-weight-medium"},[t._v("\n                    "+t._s(t.selectedTable.itemCount||0)+" items\n                  ")])]):t._e(),t._v(" "),t.selectedTable.customerName?r(m.a,{attrs:{cols:"12"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Customer")]),t._v(" "),r("div",{staticClass:"font-weight-medium"},[t._v("\n                    "+t._s(t.selectedTable.customerName)+"\n                  ")])]):t._e(),t._v(" "),t.selectedTable.currentOrderId?r(m.a,{attrs:{cols:"12"}},[r("div",{staticClass:"text-caption grey--text"},[t._v("Current Order ID")]),t._v(" "),r("div",{staticClass:"font-weight-medium d-flex justify-space-between align-center"},[r("span",[t._v("#"+t._s(t.selectedTable.currentOrderId))]),t._v(" "),t.selectedTable.orderStatus?r(d.a,{attrs:{color:t.getOrderStatusColor(t.selectedTable.orderStatus),"text-color":"white","x-small":""}},[t._v("\n                      "+t._s(t.selectedTable.orderStatus)+"\n                    ")]):t._e()],1)]):t._e()],1)],1)],1),t._v(" "),t.selectedTable.order&&t.selectedTable.order.length>0?r(o.a,{staticClass:"mb-3",attrs:{outlined:""}},[r(l.b,[t._v("\n              Current Order\n              "),r(S.a),t._v(" "),r(d.a,{attrs:{color:"primary","text-color":"white",small:""}},[t._v("\n                "+t._s(t.selectedTable.order.length)+" items\n              ")])],1),t._v(" "),r(l.c,{staticStyle:{"max-height":"200px","overflow-y":"auto"}},[t._l(t.selectedTable.order,(function(e){return r("div",{key:e.id,staticClass:"d-flex justify-space-between mb-2"},[r("div",[r("div",{staticClass:"font-weight-medium"},[t._v(t._s(e.name))]),t._v(" "),r("div",{staticClass:"text-caption grey--text"},[t._v("\n                    Qty: "+t._s(e.quantity)+"\n                  ")])]),t._v(" "),r("div",{staticClass:"font-weight-bold primary--text"},[t._v("\n                  $"+t._s(t.formatPrice(e.unitPrice*e.quantity))+"\n                ")])])})),t._v(" "),r(f.a,{staticClass:"my-2"}),t._v(" "),r("div",{staticClass:"d-flex justify-space-between text-h6 font-weight-bold"},[r("span",[t._v("Total:")]),t._v(" "),r("span",{staticClass:"primary--text"},[t._v("$"+t._s(t.formatPrice(t.selectedTable.currentTotal||0)))])])],2)],1):t._e(),t._v(" "),"available"===t.selectedTable.status?r(o.a,{staticClass:"mb-3",attrs:{outlined:""}},[r(l.b,[t._v("Seat Customer")]),t._v(" "),r(l.c,[r(M.a,{attrs:{label:"Customer Name",outlined:"",dense:"","prepend-inner-icon":"mdi-account"},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}}),t._v(" "),r(M.a,{attrs:{label:"Party Size",type:"number",outlined:"",dense:"","prepend-inner-icon":"mdi-account-group",max:t.selectedTable.capacity},model:{value:t.partySize,callback:function(e){t.partySize=e},expression:"partySize"}})],1)],1):t._e()],1):t._e(),t._v(" "),t.selectedTable?r(l.a,{staticClass:"pa-4"},[r("div",{staticClass:"w-100"},["available"===t.selectedTable.status?r("div",[r(c.a,{staticClass:"mb-2",attrs:{color:"primary",block:"",large:"",disabled:!t.customerName,loading:t.actionLoading},on:{click:t.seatCustomer}},[r(_.a,{attrs:{left:""}},[t._v("mdi-account-plus")]),t._v("\n                Seat Customer\n              ")],1)],1):"occupied"===t.selectedTable.status?r("div",[r(c.a,{staticClass:"mb-2",attrs:{color:"primary",block:"",large:""},on:{click:t.openPOS}},[r(_.a,{attrs:{left:""}},[t._v("mdi-cash-register")]),t._v("\n                Add Items\n              ")],1),t._v(" "),r(c.a,{staticClass:"mb-2",attrs:{color:"success",block:"",large:"",disabled:!t.selectedTable.currentTotal||0===t.selectedTable.currentTotal,loading:t.actionLoading},on:{click:t.processPayment}},[r(_.a,{attrs:{left:""}},[t._v("mdi-credit-card")]),t._v("\n                Process Payment\n              ")],1),t._v(" "),r(c.a,{staticClass:"mb-2",attrs:{color:"info",block:"",disabled:!t.selectedTable.currentTotal||0===t.selectedTable.currentTotal,loading:t.actionLoading},on:{click:t.printCustomerReceipt}},[r(_.a,{attrs:{left:""}},[t._v("mdi-printer")]),t._v("\n                Print Receipt\n              ")],1)],1):"cleaning"===t.selectedTable.status?r("div",[r(c.a,{attrs:{color:"success",block:"",large:"",loading:t.actionLoading},on:{click:t.markTableClean}},[r(_.a,{attrs:{left:""}},[t._v("mdi-check-circle")]),t._v("\n                Mark Clean & Available\n              ")],1)],1):"reserved"===t.selectedTable.status?r("div",[r(c.a,{staticClass:"mb-2",attrs:{color:"primary",block:"",large:"",loading:t.actionLoading},on:{click:t.seatReservedCustomer}},[r(_.a,{attrs:{left:""}},[t._v("mdi-account-check")]),t._v("\n                Seat Reserved Customer\n              ")],1),t._v(" "),r(c.a,{attrs:{color:"warning",block:"",loading:t.actionLoading},on:{click:t.cancelReservation}},[r(_.a,{attrs:{left:""}},[t._v("mdi-cancel")]),t._v("\n                Cancel Reservation\n              ")],1)],1):t._e()])]):t._e()],1)],1)],1),t._v(" "),r(h.a,{attrs:{"max-width":"400",persistent:""},model:{value:t.showPrintConfirmDialog,callback:function(e){t.showPrintConfirmDialog=e},expression:"showPrintConfirmDialog"}},[r(o.a,[r(l.d,{staticClass:"headline d-flex align-center"},[r(_.a,{staticClass:"mr-2",attrs:{color:"success"}},[t._v("mdi-check-circle")]),t._v("\n        Payment Successful!\n      ")],1),t._v(" "),r(l.c,{staticClass:"text-center py-4"},[r(_.a,{staticClass:"mb-3",attrs:{size:"64",color:"success"}},[t._v("mdi-credit-card-check")]),t._v(" "),r("div",{staticClass:"text-h6 mb-2"},[t._v("\n          Payment has been processed successfully\n        ")]),t._v(" "),r("div",{staticClass:"text-subtitle-1 mb-4"},[t._v("\n          Amount: "),r("strong",[t._v(t._s(t.formatPrice(t.paymentAmount)))])]),t._v(" "),r("div",{staticClass:"text-body-1"},[t._v("\n          Would you like to print the receipt now?\n        ")])],1),t._v(" "),r(l.a,{staticClass:"justify-center pb-4"},[r(c.a,{staticClass:"mr-2",attrs:{color:"grey",text:""},on:{click:function(e){return t.handlePrintConfirmation(!1)}}},[r(_.a,{attrs:{left:""}},[t._v("mdi-close")]),t._v("\n          No, Skip\n        ")],1),t._v(" "),r(c.a,{staticClass:"ml-2",attrs:{color:"primary"},on:{click:function(e){return t.handlePrintConfirmation(!0)}}},[r(_.a,{attrs:{left:""}},[t._v("mdi-printer")]),t._v("\n          Yes, Print Receipt\n        ")],1)],1)],1)],1),t._v(" "),r(h.a,{attrs:{"max-width":"600",persistent:""},model:{value:t.showPaymentDialog,callback:function(e){t.showPaymentDialog=e},expression:"showPaymentDialog"}},[r(o.a,[r(l.d,{staticClass:"primary white--text"},[r(_.a,{attrs:{left:"",color:"white"}},[t._v("mdi-credit-card")]),t._v("\n        Process Payment - Table\n        "+t._s(t.selectedTable?t.selectedTable.number:"")+"\n        "),r(S.a),t._v(" "),r(c.a,{attrs:{icon:"",color:"white",disabled:t.actionLoading},on:{click:t.closePaymentDialog}},[r(_.a,[t._v("mdi-close")])],1)],1),t._v(" "),r(l.c,{staticClass:"pa-6"},[r(o.a,{staticClass:"mb-4",attrs:{outlined:""}},[r(l.c,{staticClass:"text-center pa-4"},[r("div",{staticClass:"text-h4 font-weight-bold primary--text"},[t._v("\n              "+t._s(t.formatPrice(t.paymentAmount))+"\n            ")]),t._v(" "),r("div",{staticClass:"text-subtitle-1 grey--text"},[t._v("Total Amount to Pay")])])],1),t._v(" "),t.paymentLoading?r("div",{staticClass:"text-center pa-4"},[r(k.a,{attrs:{size:"48",color:"primary",indeterminate:""}}),t._v(" "),r("p",{staticClass:"mt-2"},[t._v("Loading payment methods...")])],1):r("div",[r(D.a,{staticClass:"px-0"},[r(_.a,{attrs:{left:""}},[t._v("mdi-wallet")]),t._v("\n            Select Payment Method\n          ")],1),t._v(" "),t.paymentList.length>0?r(P.a,t._l(t.paymentList,(function(e){var n,c,l,d,v;return r(m.a,{key:e.id,staticClass:"pa-1",attrs:{cols:"6"}},[r(o.a,{class:["payment-method-card cursor-pointer text-center pa-3",(null===(n=t.selectedPaymentMethod)||void 0===n?void 0:n.id)===e.id?"white--text elevation-4":"elevation-1"],attrs:{color:(null===(c=t.selectedPaymentMethod)||void 0===c?void 0:c.id)===e.id?t.getPaymentColor(e.payment_code):"",hover:"",height:"100"},on:{click:function(r){t.selectedPaymentMethod=e}}},[r(_.a,{staticClass:"mb-2",attrs:{color:(null===(l=t.selectedPaymentMethod)||void 0===l?void 0:l.id)===e.id?"white":t.getPaymentColor(e.payment_code),size:"32"}},[t._v("\n                  "+t._s(t.getPaymentIcon(e.payment_code))+"\n                ")]),t._v(" "),r("div",{staticClass:"font-weight-medium",class:(null===(d=t.selectedPaymentMethod)||void 0===d?void 0:d.id)===e.id?"white--text":""},[t._v("\n                  "+t._s(e.payment_name)+"\n                ")]),t._v(" "),r("div",{staticClass:"caption",class:(null===(v=t.selectedPaymentMethod)||void 0===v?void 0:v.id)===e.id?"white--text":"grey--text"},[t._v("\n                  "+t._s(e.payment_code)+"\n                ")])],1)],1)})),1):r(n.a,{staticClass:"ma-0",attrs:{type:"warning",outlined:""}},[r("div",{staticClass:"d-flex align-center"},[r(_.a,{attrs:{left:""}},[t._v("mdi-alert")]),t._v("\n              No active payment methods available\n            ")],1),t._v(" "),r(c.a,{staticClass:"mt-2",attrs:{small:"",color:"warning"},on:{click:t.loadPaymentMethods}},[r(_.a,{attrs:{left:"",small:""}},[t._v("mdi-refresh")]),t._v("\n              Retry\n            ")],1)],1),t._v(" "),t.selectedPaymentMethod?r(o.a,{staticClass:"mt-4",attrs:{outlined:"",color:"grey lighten-5"}},[r(l.c,{staticClass:"pa-3"},[r("div",{staticClass:"d-flex align-center"},[r(_.a,{staticClass:"mr-3",attrs:{color:t.getPaymentColor(t.selectedPaymentMethod.payment_code)}},[t._v("\n                  "+t._s(t.getPaymentIcon(t.selectedPaymentMethod.payment_code))+"\n                ")]),t._v(" "),r("div",[r("div",{staticClass:"font-weight-medium"},[t._v("\n                    "+t._s(t.selectedPaymentMethod.payment_name)+"\n                  ")]),t._v(" "),r("div",{staticClass:"caption grey--text"},[t._v("\n                    "+t._s(t.selectedPaymentMethod.payment_desc||"No description")+"\n                  ")])])],1)])],1):t._e()],1)],1),t._v(" "),r(l.a,{staticClass:"pa-4"},[r(c.a,{attrs:{color:"grey",text:"",disabled:t.actionLoading},on:{click:t.closePaymentDialog}},[t._v("\n          Cancel\n        ")]),t._v(" "),r(S.a),t._v(" "),r(c.a,{attrs:{color:"success",large:"",disabled:!t.selectedPaymentMethod||t.actionLoading,loading:t.actionLoading},on:{click:t.confirmPayment}},[r(_.a,{attrs:{left:""}},[t._v("mdi-check")]),t._v("\n          Process Payment\n        ")],1)],1)],1)],1),t._v(" "),r("PrintTicketDialog",{attrs:{show:t.showCustomerPrint,ticket:t.selectedTicket,"restaurant-info":t.restaurantConfig},on:{close:t.closePrintDialog,printed:t.onPrintSuccess}}),t._v(" "),r(h.a,{attrs:{fullscreen:""},model:{value:t.showPOSDialog,callback:function(e){t.showPOSDialog=e},expression:"showPOSDialog"}},[r(o.a,[r(I.a,{attrs:{color:"primary",dark:""}},[r(L.a,[r(_.a,{attrs:{left:""}},[t._v("mdi-cash-register")]),t._v("\n          POS - Table "+t._s(t.selectedTable?t.selectedTable.number:"")+"\n        ")],1),t._v(" "),r(S.a),t._v(" "),r(c.a,{attrs:{icon:""},on:{click:t.closePOS}},[r(_.a,[t._v("mdi-close")])],1)],1),t._v(" "),r(l.c,{staticClass:"pa-0"},[t.selectedTable&&t.showPOSDialog?r("CafePOSScreen",{key:"pos-".concat(null===(e=t.selectedTable)||void 0===e?void 0:e.id),attrs:{tableId:t.selectedTable?t.selectedTable.id:null},on:{"reload-data":function(e){return t.loadTableTicketData(t.selectedTable.id)},"reload-table":t.fetchTables}}):t._e()],1)],1)],1),t._v(" "),r(O.a,{attrs:{color:t.snackbar.color,timeout:t.snackbar.timeout,location:"top right",variant:"elevated"},scopedSlots:t._u([{key:"actions",fn:function(){return[r(c.a,{attrs:{color:"white",variant:"text"},on:{click:function(e){t.snackbar.show=!1}}},[t._v("\n        Close\n      ")])]},proxy:!0}]),model:{value:t.snackbar.show,callback:function(e){t.$set(t.snackbar,"show",e)},expression:"snackbar.show"}},[r("div",{staticClass:"d-flex align-center"},[r(_.a,{staticClass:"mr-2"},[t._v(t._s(t.snackbar.icon))]),t._v("\n      "+t._s(t.snackbar.message)+"\n    ")],1)])],1)}),[],!1,null,"a70deaa8",null);t.default=component.exports;installComponents(component,{CafePOSScreen:r(1600).default})}}]);