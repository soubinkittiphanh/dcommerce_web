(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{1065:function(t,e,n){var content=n(1402);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(15).default)("6444ed7f",content,!0,{sourceMap:!1})},1401:function(t,e,n){"use strict";n(1065)},1402:function(t,e,n){var r=n(14)((function(i){return i[1]}));r.push([t.i,".applicant-summary-container[data-v-02868df3]{padding:20px}.page-header[data-v-02868df3]{margin-bottom:20px}.header-content[data-v-02868df3]{align-items:center;display:flex;justify-content:space-between}.page-title[data-v-02868df3]{font-size:28px;font-weight:600;margin:0}.header-actions[data-v-02868df3]{display:flex;gap:12px}.filter-section[data-v-02868df3]{margin-bottom:20px}.applicant-name[data-v-02868df3]{display:flex;flex-direction:column}.contact-info[data-v-02868df3]{color:#666;font-size:12px}.contact-details[data-v-02868df3]{align-items:center;display:flex}@media (max-width:768px){.header-content[data-v-02868df3]{align-items:flex-start;flex-direction:column;gap:16px}}",""]),r.locals={},t.exports=r},1760:function(t,e,n){"use strict";n.r(e);var r=n(321),l=n(318),o=n(19),c=n(322),d=n(797),f=n(806),v=n(771),m=n(168),h=n(796),x=n(66),_=n(112),y=(n(34),n(130),n(17)),w=n(36),j=(n(85),n(39),n(9),n(5),n(30),n(38),n(52),n(68),n(103),n(54),n(53),n(833),n(448),{name:"ApplicantSummary",components:{ApplicantForm:n(1718).default},middleware:"auths",data:function(){return{showEditDialog:!1,selectedApplicant:null,dialogKey:0,applicants:[],filteredApplicants:[],jobBatches:[],loading:!1,filters:{search:"",gender:"",status:"",jobBatchId:""},headers:[{text:"ID",value:"id",sortable:!0},{text:"ຊື່ຜູ້ສະໝັກ",value:"name",sortable:!0},{text:"ເພດ",value:"gender",sortable:!0},{text:"ອາຍຸ",value:"age",sortable:!0},{text:"ຕິດຕໍ່",value:"phone",sortable:!1},{text:"ທີ່ຢູ່",value:"address",sortable:!1},{text:"ວັນທີ່ເລີມຕົ້ນສັນຍາ",value:"contractStartDate",sortable:!1},{text:"ວັນທີ່ສິນສຸດສັນຍາ",value:"contractEndDate",sortable:!1},{text:"ຕົວແທນສັນຫາ",value:"agency",sortable:!1},{text:"ໜັງສືເດີນທາງ",value:"passportAvailability",sortable:!0},{text:"ສະຖານະ",value:"status",sortable:!0},{text:"ຟັງຊັ່ນ",value:"actions",sortable:!1,align:"center"}],genderOptions:[{text:"ທັງໝົດ",value:""},{text:"ຊາຍ",value:"male"},{text:"ຍິງ",value:"female"}],statusOptions:[{text:"ທັງໝົດ",value:""},{text:"ສໍາພາດ",value:"INTERVIEW"},{text:"ລົງທະບຽນ",value:"REGISTER"},{text:"ປະຕິເສດ",value:"rejected"}]}},computed:{jobBatchOptions:function(){var t=this.jobBatches.filter((function(b){return b.id})).map((function(b){return{text:"".concat(b.mou.jobCode," ").concat(b.runningNo).concat(b.workPlace?" - ".concat(b.workPlace):""),value:b.id}}));return[{text:"ທັງໝົດ",value:""}].concat(Object(w.a)(t))}},mounted:function(){this.fetchApplicants(),this.loadJobBatches()},methods:{loadJobBatches:function(){var t=this;return Object(y.a)(regeneratorRuntime.mark((function e(){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/api/batch-job");case 3:n=e.sent,data=n.data,t.jobBatches=null!=data&&data.success&&data.data.jobBatches||[],e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error loading job batches:",e.t0),t.jobBatches=[];case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()},fetchApplicants:function(){var t=this;return Object(y.a)(regeneratorRuntime.mark((function e(){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.$axios.get("/api/applicants",{params:{page:1,limit:1e3,isActive:!0}});case 4:n=e.sent,data=n.data,t.applicants=null!=data&&data.success&&data.data.applicants||[],t.applyFilters(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Error fetching applicants:",e.t0),t.applicants=[];case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})))()},openCreateDialog:function(){this.selectedApplicant=null,this.dialogKey++,this.showEditDialog=!0},editApplicant:function(t){this.selectedApplicant=t,this.dialogKey++,this.showEditDialog=!0},closeEditDialog:function(){this.showEditDialog=!1,this.selectedApplicant=null},onApplicantSave:function(t){var e=this;return Object(y.a)(regeneratorRuntime.mark((function n(){var r,l,o,c,d,f,v,m,h,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.loading=!0,c=null!==(r=e.selectedApplicant)&&void 0!==r&&r.id?"/api/applicants/".concat(e.selectedApplicant.id):"/api/applicants",d=null!==(l=e.selectedApplicant)&&void 0!==l&&l.id?"put":"post",n.next=6,e.$axios[d](c,t);case 6:if(f=n.sent,null===(o=f.data)||void 0===o||!o.success){n.next=12;break}return null===(v=e.$toast)||void 0===v||v.success("ການບັນທຶກສຳເລັດແລ້ວ"),e.closeEditDialog(),n.next=12,e.fetchApplicants();case 12:n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),console.error("Error saving applicant:",n.t0),null===(m=e.$toast)||void 0===m||m.error((null===(h=n.t0.response)||void 0===h||null===(x=h.data)||void 0===x?void 0:x.message)||"ການບັນທຶກບໍ່ສຳເລັດ");case 18:return n.prev=18,e.loading=!1,n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[0,14,18,21]])})))()},applyFilters:function(){var t=this,e=Object(w.a)(this.applicants);if(this.filters.search){var n=this.filters.search.toLowerCase();e=e.filter((function(a){return a.firstName.toLowerCase().includes(n)||a.lastName.toLowerCase().includes(n)||a.phone.includes(n)}))}this.filters.gender&&(e=e.filter((function(a){return a.gender===t.filters.gender}))),this.filters.status&&(e=e.filter((function(a){return a.status===t.filters.status}))),this.filters.jobBatchId&&(e=e.filter((function(a){var e;return(null===(e=a.jobBatchId)||void 0===e?void 0:e.toString())===t.filters.jobBatchId.toString()}))),this.filteredApplicants=e},exportData:function(){var t=this.convertToCSV(this.filteredApplicants);this.downloadCSV(t,"applicants.csv")},convertToCSV:function(data){var t=data.map((function(t){return[t.id,t.firstName,t.lastName,t.gender,t.phone,t.status].join(",")}));return[["ID","First Name","Last Name","Gender","Phone","Status"].join(",")].concat(Object(w.a)(t)).join("\n")},downloadCSV:function(t,e){var n=new Blob([t],{type:"text/csv"}),r=window.URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download=e,a.click(),window.URL.revokeObjectURL(r)},getFullName:function(t){return"".concat(t.firstName," ").concat(t.lastName)},formatGender:function(t){return"male"===t?"ຊາຍ":"ຍິງ"},formatStatus:function(t){return{INTERVIEW:"ສໍາພາດ",REGISTER:"ລົງທະບຽນ",rejected:"ປະຕິເສດ"}[t]||t},getStatusColor:function(t){return{INTERVIEW:"warning",REGISTER:"success",rejected:"error"}[t]||"grey"},truncateText:function(text,t){return text?text.length>t?text.substring(0,t)+"...":text:""}}}),k=(n(1401),n(31)),component=Object(k.a)(j,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"applicant-summary-container"},[e("div",{staticClass:"page-header"},[e("div",{staticClass:"header-content"},[e("h1",{staticClass:"page-title"},[t._v("ລະບົບຈັດການຜູ້ສະໝັກງານ")]),t._v(" "),e("div",{staticClass:"header-actions"},[e(r.a,{attrs:{color:"primary"},on:{click:t.openCreateDialog}},[e(m.a,{attrs:{left:""}},[t._v("mdi-plus")]),t._v("\n          ເພີ່ມຜູ້ສະໝັກໃໝ່\n        ")],1),t._v(" "),e(r.a,{attrs:{color:"secondary"},on:{click:t.exportData}},[e(m.a,{attrs:{left:""}},[t._v("mdi-download")]),t._v("\n          Export\n        ")],1)],1)])]),t._v(" "),e(l.a,{staticClass:"filter-section"},[e(o.c,[e(h.a,[e(d.a,{attrs:{cols:"12",md:"3"}},[e(_.a,{attrs:{label:"ຄົ້ນຫາ",placeholder:"ຊື່, ເບີໂທ, ໜັງສືເດີນທາງ...",outlined:"",dense:"","hide-details":"","prepend-inner-icon":"mdi-magnify"},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"3"}},[e(x.a,{attrs:{items:t.jobBatchOptions,label:"Job Batch",outlined:"",dense:"","hide-details":"",clearable:""},model:{value:t.filters.jobBatchId,callback:function(e){t.$set(t.filters,"jobBatchId",e)},expression:"filters.jobBatchId"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"2"}},[e(x.a,{attrs:{items:t.genderOptions,label:"ເພດ",outlined:"",dense:"","hide-details":"",clearable:""},model:{value:t.filters.gender,callback:function(e){t.$set(t.filters,"gender",e)},expression:"filters.gender"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"2"}},[e(x.a,{attrs:{items:t.statusOptions,label:"ສະຖານະ",outlined:"",dense:"","hide-details":"",clearable:""},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"2"}},[e(r.a,{attrs:{color:"primary",block:""},on:{click:t.applyFilters}},[e(m.a,{attrs:{left:""}},[t._v("mdi-magnify")]),t._v("\n            ຄົ້ນຫາ\n          ")],1)],1)],1)],1)],1),t._v(" "),e(l.a,{staticClass:"mt-4"},[e(f.a,{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.filteredApplicants,loading:t.loading,"items-per-page":25,"footer-props":{"items-per-page-options":[10,25,50,100]}},scopedSlots:t._u([{key:"item.id",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(n.id)+"\n      ")]}},{key:"item.name",fn:function(n){var r=n.item;return[e("div",{staticClass:"applicant-name"},[e("strong",[t._v(t._s(t.getFullName(r)))]),t._v(" "),e("div",{staticClass:"contact-info"},[e("span",{staticClass:"phone"},[t._v(t._s(r.phone))])])])]}},{key:"item.gender",fn:function(n){var r=n.item;return[e(c.a,{attrs:{small:"",color:"male"===r.gender?"blue":"pink","text-color":"white"}},[t._v("\n          "+t._s(t.formatGender(r.gender))+"\n        ")])]}},{key:"item.age",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(n.age||"-")+" ປີ\n      ")]}},{key:"item.phone",fn:function(n){var r=n.item;return[e("div",{staticClass:"contact-details"},[e(m.a,{attrs:{small:"",left:""}},[t._v("mdi-phone")]),t._v("\n          "+t._s(r.phone)+"\n        ")],1)]}},{key:"item.contractStartDate",fn:function(n){var r,l=n.item;return[e("div",{staticClass:"contact-details"},[e(m.a,{attrs:{small:"",left:""}},[t._v("mdi-calendar-start")]),t._v("\n          "+t._s((null===(r=l.jobBatch)||void 0===r?void 0:r.batchStartDate)||"-")+"\n        ")],1)]}},{key:"item.contractEndDate",fn:function(n){var r,l=n.item;return[e("div",{staticClass:"contact-details"},[e(m.a,{attrs:{small:"",left:""}},[t._v("mdi-calendar-end")]),t._v("\n          "+t._s((null===(r=l.jobBatch)||void 0===r?void 0:r.batchEndDate)||"-")+"\n        ")],1)]}},{key:"item.agency",fn:function(n){var r,l=n.item;return[e("div",{staticClass:"contact-details"},[e(m.a,{attrs:{small:"",left:""}},[t._v("mdi-office-building")]),t._v("\n          "+t._s((null===(r=l.agency)||void 0===r?void 0:r.agencyName)||"-")+"\n        ")],1)]}},{key:"item.address",fn:function(n){var r=n.item;return[r.address?e("div",[t._v("\n          "+t._s(t.truncateText(r.address,20))+"\n        ")]):t._e()]}},{key:"item.passportAvailability",fn:function(n){var r=n.item;return[e(c.a,{attrs:{small:"",color:r.passportAvailability?"success":"error","text-color":"white"}},[e(m.a,{attrs:{left:"",small:""}},[t._v("\n            "+t._s(r.passportAvailability?"mdi-check-circle":"mdi-close-circle")+"\n          ")]),t._v("\n          "+t._s(r.passportAvailability?"ມີ":"ບໍ່ມີ")+"\n        ")],1)]}},{key:"item.status",fn:function(n){var r=n.item;return[e(c.a,{attrs:{small:"",color:t.getStatusColor(r.status),"text-color":"white"}},[t._v("\n          "+t._s(t.formatStatus(r.status))+"\n        ")])]}},{key:"item.actions",fn:function(n){var l=n.item;return[e(r.a,{attrs:{icon:"",small:"",color:"info"},on:{click:function(e){return t.editApplicant(l)}}},[e(m.a,{attrs:{small:""}},[t._v("mdi-pencil")])],1)]}}])})],1),t._v(" "),e(v.a,{attrs:{fullscreen:"",persistent:""},model:{value:t.showEditDialog,callback:function(e){t.showEditDialog=e},expression:"showEditDialog"}},[e(l.a,[e("ApplicantForm",{key:t.dialogKey,attrs:{applicant:t.selectedApplicant,"job-batches":t.jobBatches},on:{close:t.closeEditDialog,save:t.onApplicantSave,"load-job-batches":t.loadJobBatches}})],1)],1)],1)}),[],!1,null,"02868df3",null);e.default=component.exports}}]);