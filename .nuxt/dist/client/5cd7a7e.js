(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{1750:function(t,e,n){"use strict";n.r(e);var r=n(316),o=n(313),c=n(18),l=n(784),d=n(1688),f=n(758),m=n(774),h=n(318),v=n(113),x=(n(35),n(131),n(20)),y=n(31),S=(n(92),n(5),n(8),n(30),n(332),n(34),n(62),n(69),n(54),n(7),n(67),n(93),n(53),n(360)),w=n(36);function D(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var k={mounted:function(){this.loadTxn()},watch:{date:function(t){this.dateFormatted=this.formatDate(this.date),this.loadTxn(),this.loadSaleStatistic()},date2:function(t){this.dateFormatted2=this.formatDate(this.date2),this.loadTxn(),this.loadSaleStatistic()}},data:function(){return{userId:"",search:"",isEdit:!1,dialog:!1,apFormKey:1,isloading:!1,txnList:[],selectedId:"",expenseList:[],incomeList:[],yearlySale:[],menu1:!1,menu2:!1,date:Object(w.d)(),date2:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),dateFormatted:this.formatDate(Object(w.d)()),dateFormatted2:this.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10))}},computed:{totalIncome:function(){return this.incomeList.reduce((function(t,e){return t+e.totalAmount*e.rate}),0)+this.totalSale},totalSale:function(){return this.yearlySale.reduce((function(t,e){return t+(e.total-e.discount)}),0)},totalCostOfSale:function(){var t=this.yearlySale.reduce((function(t,e){var n=0;return e.lines.forEach((function(line){line.cards.forEach((function(t){n+=t.cost}))})),t+n}),0);return console.info("total cost of sale: ".concat(t)),t},totalExpense:function(){return this.expenseList.reduce((function(t,e){return t+e.totalAmount*e.rate}),0)+this.totalCostOfSale},profit:function(){return this.totalIncome-this.totalExpense}},methods:{formatAmount:function(t){return Object(w.e)(t)},formatDate:function(t){if(!t)return null;console.log("DATE FORMAT METHOD1: "+t);var e=this.formatDateToISO(t).split("-"),n=Object(y.a)(e,3),r=n[0],o=n[1],c=n[2];return"".concat(o,"/").concat(c,"/").concat(r)},parseDate:function(t){if(console.log("DATE PARSE METHOD1: "+t),!t)return null;var e=t.split("/"),n=Object(y.a)(e,3),r=n[0],o=n[1],c=n[2];return"".concat(c,"-").concat(r.padStart(2,"0"),"-").concat(o.padStart(2,"0"))},formatDateToISO:function(t){t instanceof Date||(t=new Date(t));var e=t.getFullYear(),n="".concat(t.getMonth()+1).padStart(2,"0"),r="".concat(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(r)},numberWithFormat:function(t){return Object(w.e)(t)},loadTxn:function(){var t=this;return Object(x.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isloading=!0,e.prev=1,t.loadSaleStatistic(),n={startDate:t.date,endDate:t.date2},e.next=6,t.$axios.get("/api/finanicial/ar/header/findByDate",{params:{date:n}});case 6:return r=e.sent,e.next=9,t.$axios.get("/api/finanicial/ap/header/findByDate",{params:{date:n}});case 9:o=e.sent,t.expenseList=o.data,t.incomeList=r.data,c=S.b(t.$refs.plchart),l={tooltip:{trigger:"item"},legend:{top:"5%",left:"center",selectedMode:!1},series:[{name:"Access From",type:"pie",radius:["40%","70%"],center:["50%","70%"],startAngle:180,label:{show:!0,formatter:function(param){return param.name+" ("+2*param.percent+"%)"}},data:[{value:t.totalIncome,name:"ລາຍຮັບ \n ".concat(t.formatAmount(t.totalIncome))},{value:t.totalExpense,name:"ລາຍຈ່າຍ \n ".concat(t.formatAmount(t.totalExpense))},{value:Math.abs(t.profit),name:"ກຳໄລ/ຂາດທຶນ \n ".concat(t.formatAmount(t.profit))},{value:t.totalExpense+t.totalIncome+Math.abs(t.profit),itemStyle:{color:"none",decal:{symbol:"none"}},label:{show:!1}}]}]},c.setOption(l),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),Object(w.j)(t.$swal,"Error","Could no load data "+e.t0);case 20:t.isloading=!1;case 21:case"end":return e.stop()}}),e,null,[[1,17]])})))()},loadSaleStatistic:function(){var t=this;return Object(x.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={startDate:t.date,endDate:t.date2},t.isloading=!0,e.next=4,t.$axios.get("api/sale/sumsaleYearly",{params:{date:n}}).then((function(e){t.yearlySale=[];var n,r=D(e.data);try{for(r.s();!(n=r.n()).done;){var o=n.value;t.yearlySale.push(o)}}catch(t){r.e(t)}finally{r.f()}})).catch((function(t){console.log("error",t)}));case 4:t.isloading=!1;case 5:case"end":return e.stop()}}),e)})))()}}},A=n(32),component=Object(A.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center"},[e(f.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(o.a,[e(c.d,[e(m.a,{attrs:{row:"",wrap:""}},[e(l.a,{attrs:{cols:"6"}},[e(h.a,{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(v.a,t._g(t._b({attrs:{label:"ຈາກວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(e){t.date=t.parseDate(t.dateFormatted)}},model:{value:t.dateFormatted,callback:function(e){t.dateFormatted=e},expression:"dateFormatted"}},"v-text-field",o,!1),r))]}}]),model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[t._v(" "),e(d.a,{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),e(h.a,{ref:"menu2",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(v.a,t._g(t._b({attrs:{label:"ຫາວັນທີ:",hint:"MM/DD/YYYY format","persistent-hint":"","prepend-icon":"mdi-calendar"},on:{blur:function(e){t.date2=t.parseDate(t.dateFormatted2)}},model:{value:t.dateFormatted2,callback:function(e){t.dateFormatted2=e},expression:"dateFormatted2"}},"v-text-field",o,!1),r))]}}]),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[t._v(" "),e(d.a,{attrs:{"no-title":""},on:{input:function(e){t.menu2=!1}},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1)],1),t._v(" "),e(l.a,{attrs:{cols:"6"}},[e(v.a,{attrs:{disabled:"","append-icon":"mdi-magnify",label:"ຊອກຫາ","single-line":"","hide-detailsx":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),e(v.a,{attrs:{disabled:"","append-icon":"mdi-magnify",label:"ລະຫັດຜູ້ຂາຍ","single-line":"","hide-detailsx":""},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}}),t._v(" "),e(r.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.loadTxn}},[t._v("\n            ດຶງລາຍງານ\n          ")])],1)],1)],1),t._v(" "),e(c.c,[e(o.a,[e("div",{ref:"plchart",staticStyle:{width:"100%",height:"400px"}})])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})}}]);