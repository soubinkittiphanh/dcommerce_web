(window.webpackJsonp=window.webpackJsonp||[]).push([[176],{1049:function(t,e,o){var content=o(1397);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(16).default)("53c50fd5",content,!0,{sourceMap:!1})},1396:function(t,e,o){"use strict";o(1049)},1397:function(t,e,o){var r=o(15)((function(i){return i[1]}));r.push([t.i,".v-chip--small[data-v-58cf5454]{font-size:10px!important}",""]),r.locals={},t.exports=r},1736:function(t,e,o){"use strict";o.r(e);var r=o(316),n=o(313),c=o(18),l=o(317),d=o(785),f=o(780),h=o(794),v=o(1719),m=o(759),x=o(312),_=o(167),y=o(306),w=o(199),O=o(168),k=o(28),D=o(318),S=o(784),B=o(65),C=o(782),j=o(113),P=(o(34),o(131),o(3)),M=o(20),R=(o(92),o(10),o(7),o(9),o(5),o(12),o(8),o(13),o(1691)),J=o(944);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}var N={name:"JobBatchList",components:{JobBatchDialog:R.default},middleware:"auths",data:function(){return{loading:!1,updating:!1,loadingMous:!1,dateMenu:!1,showDialog:!1,showStatusDialog:!1,isEdit:!1,selectedBatch:null,newStatus:"",jobBatches:[],totalItems:0,mouFilterOptions:[],statistics:{total:{title:"Total Batches",value:0,icon:"mdi-briefcase-outline",color:"primary"},active:{title:"Active",value:0,icon:"mdi-play-circle",color:"success"},completed:{title:"Completed",value:0,icon:"mdi-check-circle",color:"success"},overdue:{title:"Overdue",value:0,icon:"mdi-clock-alert",color:"error"},draft:{title:"Draft",value:0,icon:"mdi-file-document-outline",color:"warning"},positions:{title:"Total Positions",value:0,icon:"mdi-account-group",color:"info"}},filters:{search:"",mouId:"",status:"",priority:"",dateRange:null},tableOptions:{page:1,itemsPerPage:10,sortBy:["createdAt"],sortDesc:[!0]},headers:[{text:"Running No.",value:"runningNo",sortable:!0,width:"100px"},{text:"Batch Name",value:"batchName",sortable:!0},{text:"MOU",value:"mou",sortable:!1,width:"200px"},{text:"Status",value:"status",sortable:!0,width:"100px"},{text:"Priority",value:"priority",sortable:!0,width:"120px"},{text:"Positions",value:"totalPositions",sortable:!0,width:"100px"},{text:"Start Date",value:"batchStartDate",sortable:!0,width:"120px"},{text:"Deployment",value:"deploymentDate",sortable:!0,width:"120px"},{text:"Overdue",value:"isOverdue",sortable:!1,width:"80px"},{text:"Actions",value:"actions",sortable:!1,width:"80px"}],statusOptions:[{text:"Draft",value:"draft"},{text:"Active",value:"active"},{text:"Completed",value:"completed"},{text:"Cancelled",value:"cancelled"},{text:"On Hold",value:"on_hold"}],priorityOptions:[{text:"Low",value:"low"},{text:"Medium",value:"medium"},{text:"High",value:"high"},{text:"Urgent",value:"urgent"}]}},watch:{tableOptions:{handler:function(){this.fetchJobBatches()},deep:!0},"filters.mouId":function(){this.fetchJobBatches()},"filters.status":function(){this.fetchJobBatches()},"filters.priority":function(){this.fetchJobBatches()},"filters.dateRange":function(){this.fetchJobBatches()}},mounted:function(){this.fetchJobBatches(),this.fetchStatistics(),this.fetchMouFilterOptions()},methods:{debounceSearch:Object(J.debounce)((function(){this.fetchJobBatches()}),500),fetchJobBatches:function(){var t=this;return Object(M.a)(regeneratorRuntime.mark((function e(){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,o={page:t.tableOptions.page,limit:t.tableOptions.itemsPerPage,sortBy:t.tableOptions.sortBy[0]||"createdAt",sortOrder:t.tableOptions.sortDesc[0]?"DESC":"ASC",include:"mou"},t.filters.search&&(o.search=t.filters.search),t.filters.mouId&&(o.mouId=t.filters.mouId),t.filters.status&&(o.status=t.filters.status),t.filters.priority&&(o.priority=t.filters.priority),e.next=9,t.$axios.get("/api/batch-job",{params:o});case 9:r=e.sent,t.jobBatches=r.data.data.jobBatches,t.totalItems=r.data.data.pagination.total,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),t.$toast.error("Failed to fetch job batches"),console.error("Error fetching job batches:",e.t0);case 18:return e.prev=18,t.loading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})))()},fetchStatistics:function(){var t=this;return Object(M.a)(regeneratorRuntime.mark((function e(){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/api/batch-job/dashboard-stats");case 3:o=e.sent,r=o.data.data,t.statistics.total.value=r.totalBatches,t.statistics.active.value=r.activeBatches,t.statistics.completed.value=r.completedBatches,t.statistics.overdue.value=r.overdueBatches,t.statistics.draft.value=r.draftBatches,t.statistics.positions.value=r.totalPositions,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching statistics:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()},fetchMouFilterOptions:function(){var t=this;return Object(M.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingMous=!0,e.prev=1,e.next=4,t.$axios.get("/api/mous",{params:{limit:100,fields:"id,mouName,mouNumber"}});case 4:o=e.sent,t.mouFilterOptions=o.data.data.mous||o.data.data||[],e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error fetching MOU filter options:",e.t0),t.mouFilterOptions=[];case 12:return e.prev=12,t.loadingMous=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})))()},openCreateDialog:function(){this.selectedBatch=null,this.isEdit=!1,this.showDialog=!0},editBatch:function(t){this.selectedBatch=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Object(P.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},t),this.isEdit=!0,this.showDialog=!0},viewDetails:function(t){this.$router.push("/job-batches/".concat(t.id))},updateStatus:function(t){this.selectedBatch=t,this.newStatus=t.status,this.showStatusDialog=!0},confirmStatusUpdate:function(){var t=this;return Object(M.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.updating=!0,e.prev=1,e.next=4,t.$axios.patch("/api/batch-job/".concat(t.selectedBatch.id,"/status"),{status:t.newStatus});case 4:t.$toast.success("Status updated successfully"),t.showStatusDialog=!1,t.fetchJobBatches(),t.fetchStatistics(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.$toast.error("Failed to update status"),console.error("Error updating status:",e.t0);case 14:return e.prev=14,t.updating=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})))()},deleteBatch:function(t){var e=this;return Object(M.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.$confirm('Are you sure you want to delete "'.concat(t.batchName,'"?'),{title:"Confirm Delete"});case 2:if(!o.sent){o.next=16;break}return o.prev=4,o.next=7,e.$axios.delete("/api/batch-job/".concat(t.id));case 7:e.$toast.success("Job batch deleted successfully"),e.fetchJobBatches(),e.fetchStatistics(),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(4),e.$toast.error("Failed to delete job batch"),console.error("Error deleting batch:",o.t0);case 16:case"end":return o.stop()}}),o,null,[[4,12]])})))()},onBatchSaved:function(){this.showDialog=!1,this.fetchJobBatches(),this.fetchStatistics(),this.fetchMouFilterOptions()},onDialogCancelled:function(){this.showDialog=!1},clearFilters:function(){this.filters={search:"",mouId:"",status:"",priority:"",dateRange:null},this.fetchJobBatches()},getStatusColor:function(t){return{draft:"orange",active:"green",completed:"blue",cancelled:"red",on_hold:"grey"}[t]||"grey"},getPriorityColor:function(t){return{low:"green",medium:"orange",high:"red",urgent:"deep-purple"}[t]||"grey"},getPriorityIcon:function(t){return{low:"mdi-arrow-down",medium:"mdi-minus",high:"mdi-arrow-up",urgent:"mdi-alert"}[t]||"mdi-minus"},formatDate:function(t){return new Date(t).toLocaleDateString()}}},I=N,E=(o(1396),o(32)),component=Object(E.a)(I,(function(){var t=this,e=t._self._c;return e(f.a,{attrs:{fluid:""}},[e(S.a,[e(d.a,{attrs:{cols:"12"}},[e(n.a,[e(c.d,{staticClass:"py-2"},[e(l.a,{attrs:{small:"",color:"primary","text-color":"white"}},[e(_.a,{attrs:{left:"",small:""}},[t._v("mdi-briefcase-outline")]),t._v("\n            Job Batch Management\n          ")],1),t._v(" "),e(C.a),t._v(" "),e(r.a,{attrs:{color:"primary",small:"",disabled:t.loading},on:{click:t.openCreateDialog}},[e(_.a,{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v("\n            New Batch\n          ")],1)],1),t._v(" "),e(c.c,{staticClass:"pa-3"},[e(S.a,{attrs:{dense:""}},[e(d.a,{attrs:{cols:"3"}},[e(j.a,{attrs:{label:"Search","prepend-inner-icon":"mdi-magnify",dense:"",outlined:"","hide-details":"auto",clearable:""},on:{input:t.debounceSearch},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(B.a,{attrs:{items:t.mouFilterOptions,loading:t.loadingMous,label:"MOU",dense:"",outlined:"","hide-details":"auto",clearable:"","item-text":"mouName","item-value":"id"},model:{value:t.filters.mouId,callback:function(e){t.$set(t.filters,"mouId",e)},expression:"filters.mouId"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(B.a,{attrs:{items:t.statusOptions,label:"Status",dense:"",outlined:"","hide-details":"auto",clearable:""},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(B.a,{attrs:{items:t.priorityOptions,label:"Priority",dense:"",outlined:"","hide-details":"auto",clearable:""},model:{value:t.filters.priority,callback:function(e){t.$set(t.filters,"priority",e)},expression:"filters.priority"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(D.a,{ref:"dateMenu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(o){var r=o.on,n=o.attrs;return[e(j.a,t._g(t._b({attrs:{label:"Date Range","prepend-inner-icon":"mdi-calendar",readonly:"",dense:"",outlined:"","hide-details":"auto",clearable:""},model:{value:t.filters.dateRange,callback:function(e){t.$set(t.filters,"dateRange",e)},expression:"filters.dateRange"}},"v-text-field",n,!1),r))]}}]),model:{value:t.dateMenu,callback:function(e){t.dateMenu=e},expression:"dateMenu"}},[t._v(" "),e(v.a,{attrs:{range:""},on:{input:function(e){t.dateMenu=!1}},model:{value:t.filters.dateRange,callback:function(e){t.$set(t.filters,"dateRange",e)},expression:"filters.dateRange"}})],1)],1),t._v(" "),e(d.a,{attrs:{cols:"1"}},[e(r.a,{attrs:{color:"secondary",outlined:"",small:"",block:""},on:{click:t.clearFilters}},[t._v("\n                Clear\n              ")])],1)],1)],1),t._v(" "),e(c.c,{staticClass:"pa-3 pt-0"},[e(S.a,t._l(t.statistics,(function(o){return e(d.a,{key:o.title,attrs:{cols:"2"}},[e(n.a,{staticClass:"text-center pa-2",attrs:{outlined:""}},[e(_.a,{attrs:{color:o.color,size:"24"}},[t._v(t._s(o.icon))]),t._v(" "),e("div",{staticClass:"text-h6 mt-1"},[t._v(t._s(o.value))]),t._v(" "),e("div",{staticClass:"text-caption"},[t._v(t._s(o.title))])],1)],1)})),1)],1)],1)],1)],1),t._v(" "),e(S.a,[e(d.a,{attrs:{cols:"12"}},[e(n.a,[e(h.a,{staticClass:"elevation-0",attrs:{headers:t.headers,items:t.jobBatches,loading:t.loading,options:t.tableOptions,"server-items-length":t.totalItems,"footer-props":{"items-per-page-options":[10,25,50,100]},dense:""},on:{"update:options":function(e){t.tableOptions=e}},scopedSlots:t._u([{key:"item.runningNo",fn:function(o){var r=o.item;return[e(l.a,{attrs:{"x-small":"",color:"grey","text-color":"white"}},[t._v("\n              "+t._s(r.runningNo)+"\n            ")])]}},{key:"item.mou",fn:function(o){var r=o.item;return[r.mou?e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{small:"",color:"primary"}},[t._v("mdi-file-document-outline")]),t._v(" "),e("div",[e("div",{staticClass:"text-body-2"},[t._v(t._s(r.mou.mouName))]),t._v(" "),e("div",{staticClass:"text-caption grey--text"},[t._v(t._s(r.mou.mouNumber))])])],1):e("span",{staticClass:"text-caption grey--text"},[t._v("No MOU")])]}},{key:"item.status",fn:function(o){var r=o.item;return[e(l.a,{attrs:{"x-small":"",color:t.getStatusColor(r.status),"text-color":"white"}},[t._v("\n              "+t._s(r.status.toUpperCase())+"\n            ")])]}},{key:"item.priority",fn:function(o){var r=o.item;return[e(l.a,{attrs:{"x-small":"",color:t.getPriorityColor(r.priority),"text-color":"white"}},[e(_.a,{attrs:{left:"","x-small":""}},[t._v(t._s(t.getPriorityIcon(r.priority)))]),t._v("\n              "+t._s(r.priority.toUpperCase())+"\n            ")],1)]}},{key:"item.totalPositions",fn:function(o){var r=o.item;return[e("div",{staticClass:"text-center"},[e("span",{staticClass:"text-body-2 font-weight-bold"},[t._v(t._s(r.totalPositions||0))])])]}},{key:"item.batchStartDate",fn:function(o){var r=o.item;return[r.batchStartDate?e("span",{staticClass:"text-caption"},[t._v("\n              "+t._s(t.formatDate(r.batchStartDate))+"\n            ")]):e("span",{staticClass:"text-caption grey--text"},[t._v("Not set")])]}},{key:"item.deploymentDate",fn:function(o){var r=o.item;return[r.deploymentDate?e("span",{staticClass:"text-caption"},[t._v("\n              "+t._s(t.formatDate(r.deploymentDate))+"\n            ")]):e("span",{staticClass:"text-caption grey--text"},[t._v("Not set")])]}},{key:"item.isOverdue",fn:function(o){return[o.item.isOverdue?e(_.a,{attrs:{color:"error",small:""}},[t._v("\n              mdi-clock-alert\n            ")]):t._e()]}},{key:"item.actions",fn:function(o){var n=o.item;return[e(D.a,{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(o){var n=o.on,c=o.attrs;return[e(r.a,t._g(t._b({attrs:{icon:"",small:""}},"v-btn",c,!1),n),[e(_.a,{attrs:{small:""}},[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),e(y.a,{attrs:{dense:""}},[e(w.a,{on:{click:function(e){return t.viewDetails(n)}}},[e(O.a,[e(_.a,{attrs:{small:""}},[t._v("mdi-eye")])],1),t._v(" "),e(k.c,[t._v("View")])],1),t._v(" "),e(w.a,{on:{click:function(e){return t.editBatch(n)}}},[e(O.a,[e(_.a,{attrs:{small:""}},[t._v("mdi-pencil")])],1),t._v(" "),e(k.c,[t._v("Edit")])],1),t._v(" "),e(w.a,{on:{click:function(e){return t.updateStatus(n)}}},[e(O.a,[e(_.a,{attrs:{small:""}},[t._v("mdi-update")])],1),t._v(" "),e(k.c,[t._v("Update Status")])],1),t._v(" "),e(x.a),t._v(" "),e(w.a,{staticClass:"error--text",on:{click:function(e){return t.deleteBatch(n)}}},[e(O.a,[e(_.a,{attrs:{small:"",color:"error"}},[t._v("mdi-delete")])],1),t._v(" "),e(k.c,[t._v("Delete")])],1)],1)],1)]}}])})],1)],1)],1),t._v(" "),e("job-batch-dialog",{attrs:{batch:t.selectedBatch,"is-edit":t.isEdit},on:{saved:t.onBatchSaved,cancelled:t.onDialogCancelled},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}}),t._v(" "),e(m.a,{attrs:{"max-width":"400px",persistent:""},model:{value:t.showStatusDialog,callback:function(e){t.showStatusDialog=e},expression:"showStatusDialog"}},[e(n.a,[e(c.d,{staticClass:"text-h6"},[t._v("Update Status")]),t._v(" "),e(c.c,[e(B.a,{attrs:{items:t.statusOptions,label:"New Status",outlined:"",dense:""},model:{value:t.newStatus,callback:function(e){t.newStatus=e},expression:"newStatus"}})],1),t._v(" "),e(c.a,[e(C.a),t._v(" "),e(r.a,{attrs:{text:""},on:{click:function(e){t.showStatusDialog=!1}}},[t._v("Cancel")]),t._v(" "),e(r.a,{attrs:{color:"primary",loading:t.updating},on:{click:t.confirmStatusUpdate}},[t._v("\n          Update\n        ")])],1)],1)],1)],1)}),[],!1,null,"58cf5454",null);e.default=component.exports}}]);