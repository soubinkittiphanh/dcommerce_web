(window.webpackJsonp=window.webpackJsonp||[]).push([[215],{1247:function(t,e,r){"use strict";r.r(e);var o=r(33),n=r(20),c=(r(30),r(44),r(5),r(8),r(333),r(92),r(347));e.default={data:function(){return{sharedMessage:"Hello from mixin!"}},methods:{exportMinistryReportToExcel:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.ministrySummaryReport.length){e.next=4;break}return t.$toast.warning("No ministry data to export"),e.abrupt("return");case 4:r=t.createExcelWorkbook(),o=t.createMinistryWorksheet(),c.utils.book_append_sheet(r,o,"Ministry Report"),n="Ministry_Report_".concat(t.formatDateForFilename(),".xlsx"),c.writeFile(r,n),t.$toast.success("Ministry report exported successfully"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Export error:",e.t0),t.$toast.error("Failed to export ministry report");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},exportBankAccountReportToExcel:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.bankAccountSummaryReport.length){e.next=4;break}return t.$toast.warning("No bank account data to export"),e.abrupt("return");case 4:r=t.createExcelWorkbook(),o=t.createBankAccountWorksheet(),c.utils.book_append_sheet(r,o,"Bank Account Report"),n="Bank_Account_Report_".concat(t.formatDateForFilename(),".xlsx"),c.writeFile(r,n),t.$toast.success("Bank account report exported successfully"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Export error:",e.t0),t.$toast.error("Failed to export bank account report");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},exportChartAccountReportToExcel:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.chartAccountSummaryReport.length){e.next=4;break}return t.$toast.warning("No chart account data to export"),e.abrupt("return");case 4:r=t.createExcelWorkbook(),o=t.createChartAccountWorksheet(),c.utils.book_append_sheet(r,o,"Chart Account Report"),n="Chart_Account_Report_".concat(t.formatDateForFilename(),".xlsx"),c.writeFile(r,n),t.$toast.success("Chart account report exported successfully"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Export error:",e.t0),t.$toast.error("Failed to export chart account report");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},exportAllReportsToExcel:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o,n,l,h,m,d,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=t.ministrySummaryReport&&t.ministrySummaryReport.length>0,o=t.bankAccountSummaryReport&&t.bankAccountSummaryReport.length>0,n=t.chartAccountSummaryReport&&t.chartAccountSummaryReport.length>0,r||o||n){e.next=7;break}return t.$toast.warning("No data available to export"),e.abrupt("return");case 7:l=t.createExcelWorkbook(),r&&(h=t.createMinistryWorksheet(),c.utils.book_append_sheet(l,h,"Ministry Report")),o&&(m=t.createBankAccountWorksheet(),c.utils.book_append_sheet(l,m,"Bank Account Report")),n&&(d=t.createChartAccountWorksheet(),c.utils.book_append_sheet(l,d,"Chart Account Report")),v="Financial_Reports_".concat(t.formatDateForFilename(),".xlsx"),c.writeFile(l,v),t.$toast.success("All reports exported successfully"),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Export error:",e.t0),t.$toast.error("Failed to export reports");case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))()},createExcelWorkbook:function(){return c.utils.book_new()},createMinistryWorksheet:function(){var t,e=this,r=["#","Ministry Code","Ministry Name","Settlement Count"].concat(Object(o.a)(this.currencyList),["Total (LAK)"]),data=this.ministrySummaryReport.map((function(t,r){var o=[r+1,t.ministryCode,t.ministryName,t.settlementCount];return e.currencyList.forEach((function(e){var r;o.push((null===(r=t.amounts)||void 0===r?void 0:r[e])||0)})),o.push(t.totalLakEquivalent||0),o})),n=["","","TOTAL",this.ministrySummaryReport.reduce((function(t,e){return t+e.settlementCount}),0)];this.currencyList.forEach((function(t){var r,o;n.push((null===(r=e.ministryTotals)||void 0===r||null===(o=r.currencyTotals)||void 0===o?void 0:o[t])||0)})),n.push((null===(t=this.ministryTotals)||void 0===t?void 0:t.totalLakEquivalent)||0);var l=[r].concat(Object(o.a)(data),[n]),h=c.utils.aoa_to_sheet(l);return this.addWorksheetMetadata(h,"Ministry Financial Report"),h},createBankAccountWorksheet:function(){var t,e=this,r=["#","Account Number","Account Name","Bank Name","Account Type","Settlement Count"].concat(Object(o.a)(this.currencyList),["Total (LAK)"]),data=this.bankAccountSummaryReport.map((function(t,r){var o=[r+1,t.accountNumber,t.accountName,t.bankName,t.accountType,t.settlementCount];return e.currencyList.forEach((function(e){var r;o.push((null===(r=t.amounts)||void 0===r?void 0:r[e])||0)})),o.push(t.totalLakEquivalent||0),o})),n=["","","","","TOTAL",this.bankAccountSummaryReport.reduce((function(t,b){return t+b.settlementCount}),0)];this.currencyList.forEach((function(t){var r,o;n.push((null===(r=e.bankAccountTotals)||void 0===r||null===(o=r.currencyTotals)||void 0===o?void 0:o[t])||0)})),n.push((null===(t=this.bankAccountTotals)||void 0===t?void 0:t.totalLakEquivalent)||0);var l=[r].concat(Object(o.a)(data),[n]),h=c.utils.aoa_to_sheet(l);return this.addWorksheetMetadata(h,"Bank Account Financial Report"),h},createChartAccountWorksheet:function(){var t,e=this,r=["#","Account Number","Account Name","Settlement Count"].concat(Object(o.a)(this.currencyList),["Total (LAK)"]),data=this.chartAccountSummaryReport.map((function(t,r){var o=[r+1,t.accountNumber,t.accountName,t.settlementCount];return e.currencyList.forEach((function(e){var r;o.push((null===(r=t.amounts)||void 0===r?void 0:r[e])||0)})),o.push(t.totalLakEquivalent||0),o})),n=["","","TOTAL",this.chartAccountSummaryReport.reduce((function(t,e){return t+e.settlementCount}),0)];this.currencyList.forEach((function(t){var r,o;n.push((null===(r=e.chartAccountTotals)||void 0===r||null===(o=r.currencyTotals)||void 0===o?void 0:o[t])||0)})),n.push((null===(t=this.chartAccountTotals)||void 0===t?void 0:t.totalLakEquivalent)||0);var l=[r].concat(Object(o.a)(data),[n]),h=c.utils.aoa_to_sheet(l);return this.addWorksheetMetadata(h,"Chart Account Financial Report"),h},addWorksheetMetadata:function(t,title){var e,r,o=[[title],["Report Period: ".concat((null===(e=this.dateRange)||void 0===e?void 0:e.start)||"N/A"," to ").concat((null===(r=this.dateRange)||void 0===r?void 0:r.end)||"N/A")],["Generated: ".concat((new Date).toLocaleString())],[""]];c.utils.sheet_add_aoa(t,o,{origin:"A1"});var n=c.utils.decode_range(t["!ref"]);n.e.r+=o.length,t["!ref"]=c.utils.encode_range(n)},formatDateForFilename:function(){var t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),c=String(t.getMinutes()).padStart(2,"0");return"".concat(e).concat(r).concat(o,"_").concat(n).concat(c)}}}}}]);