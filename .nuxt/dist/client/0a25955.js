(window.webpackJsonp=window.webpackJsonp||[]).push([[175],{1048:function(t,e,r){var content=r(1394);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(16).default)("f2a0525c",content,!0,{sourceMap:!1})},1393:function(t,e,r){"use strict";r(1048)},1394:function(t,e,r){var o=r(15)((function(i){return i[1]}));o.push([t.i,".v-chip--small[data-v-69b9dbb1]{font-size:10px!important}",""]),o.locals={},t.exports=o},1728:function(t,e,r){"use strict";r.r(e);var o=r(316),n=r(313),c=r(18),l=r(317),d=r(784),h=r(779),f=r(793),v=r(1711),m=r(758),x=r(312),_=r(167),y=r(306),w=r(199),D=r(168),S=r(28),k=r(318),O=r(783),B=r(65),C=r(781),j=r(113),P=(r(34),r(131),r(3)),R=r(20),J=(r(92),r(10),r(7),r(9),r(5),r(12),r(8),r(13),r(1684)),$=r(943);function E(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}var N={name:"JobBatchList",components:{JobBatchDialog:J.default},middleware:"auths",data:function(){return{loading:!1,updating:!1,dateMenu:!1,showDialog:!1,showStatusDialog:!1,isEdit:!1,selectedBatch:null,newStatus:"",jobBatches:[],totalItems:0,statistics:{total:{title:"Total Batches",value:0,icon:"mdi-briefcase-outline",color:"primary"},active:{title:"Active",value:0,icon:"mdi-play-circle",color:"success"},completed:{title:"Completed",value:0,icon:"mdi-check-circle",color:"success"},overdue:{title:"Overdue",value:0,icon:"mdi-clock-alert",color:"error"},draft:{title:"Draft",value:0,icon:"mdi-file-document-outline",color:"warning"},positions:{title:"Total Positions",value:0,icon:"mdi-account-group",color:"info"}},filters:{search:"",status:"",priority:"",dateRange:null},tableOptions:{page:1,itemsPerPage:10,sortBy:["createdAt"],sortDesc:[!0]},headers:[{text:"Running No.",value:"runningNo",sortable:!0,width:"120px"},{text:"Batch Name",value:"batchName",sortable:!0},{text:"Status",value:"status",sortable:!0,width:"100px"},{text:"Priority",value:"priority",sortable:!0,width:"120px"},{text:"Positions",value:"totalPositions",sortable:!0,width:"100px"},{text:"Start Date",value:"batchStartDate",sortable:!0,width:"120px"},{text:"Deployment",value:"deploymentDate",sortable:!0,width:"120px"},{text:"Overdue",value:"isOverdue",sortable:!1,width:"80px"},{text:"Actions",value:"actions",sortable:!1,width:"80px"}],statusOptions:[{text:"Draft",value:"draft"},{text:"Active",value:"active"},{text:"Completed",value:"completed"},{text:"Cancelled",value:"cancelled"},{text:"On Hold",value:"on_hold"}],priorityOptions:[{text:"Low",value:"low"},{text:"Medium",value:"medium"},{text:"High",value:"high"},{text:"Urgent",value:"urgent"}]}},watch:{tableOptions:{handler:function(){this.fetchJobBatches()},deep:!0},"filters.status":function(){this.fetchJobBatches()},"filters.priority":function(){this.fetchJobBatches()},"filters.dateRange":function(){this.fetchJobBatches()}},mounted:function(){this.fetchJobBatches(),this.fetchStatistics()},methods:{debounceSearch:Object($.debounce)((function(){this.fetchJobBatches()}),500),fetchJobBatches:function(){var t=this;return Object(R.a)(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,r={page:t.tableOptions.page,limit:t.tableOptions.itemsPerPage,sortBy:t.tableOptions.sortBy[0]||"createdAt",sortOrder:t.tableOptions.sortDesc[0]?"DESC":"ASC"},t.filters.search&&(r.search=t.filters.search),t.filters.status&&(r.status=t.filters.status),t.filters.priority&&(r.priority=t.filters.priority),e.next=8,t.$axios.get("/api/batch-job",{params:r});case 8:o=e.sent,t.jobBatches=o.data.data.jobBatches,t.totalItems=o.data.data.pagination.total,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),t.$toast.error("Failed to fetch job batches"),console.error("Error fetching job batches:",e.t0);case 17:return e.prev=17,t.loading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,13,17,20]])})))()},fetchStatistics:function(){var t=this;return Object(R.a)(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/api/batch-job/dashboard-stats");case 3:r=e.sent,o=r.data.data,t.statistics.total.value=o.totalBatches,t.statistics.active.value=o.activeBatches,t.statistics.completed.value=o.completedBatches,t.statistics.overdue.value=o.overdueBatches,t.statistics.draft.value=o.draftBatches,t.statistics.positions.value=o.totalPositions,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching statistics:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()},openCreateDialog:function(){this.selectedBatch=null,this.isEdit=!1,this.showDialog=!0},editBatch:function(t){this.selectedBatch=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?E(Object(source),!0).forEach((function(e){Object(P.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):E(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},t),this.isEdit=!0,this.showDialog=!0},viewDetails:function(t){this.$router.push("/job-batches/".concat(t.id))},updateStatus:function(t){this.selectedBatch=t,this.newStatus=t.status,this.showStatusDialog=!0},confirmStatusUpdate:function(){var t=this;return Object(R.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.updating=!0,e.prev=1,e.next=4,t.$axios.patch("/api/batch-job/".concat(t.selectedBatch.id,"/status"),{status:t.newStatus});case 4:t.$toast.success("Status updated successfully"),t.showStatusDialog=!1,t.fetchJobBatches(),t.fetchStatistics(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),t.$toast.error("Failed to update status"),console.error("Error updating status:",e.t0);case 14:return e.prev=14,t.updating=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})))()},deleteBatch:function(t){var e=this;return Object(R.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$confirm('Are you sure you want to delete "'.concat(t.batchName,'"?'),{title:"Confirm Delete"});case 2:if(!r.sent){r.next=16;break}return r.prev=4,r.next=7,e.$axios.delete("/api/batch-job/".concat(t.id));case 7:e.$toast.success("Job batch deleted successfully"),e.fetchJobBatches(),e.fetchStatistics(),r.next=16;break;case 12:r.prev=12,r.t0=r.catch(4),e.$toast.error("Failed to delete job batch"),console.error("Error deleting batch:",r.t0);case 16:case"end":return r.stop()}}),r,null,[[4,12]])})))()},onBatchSaved:function(){this.showDialog=!1,this.fetchJobBatches(),this.fetchStatistics()},onDialogCancelled:function(){this.showDialog=!1},clearFilters:function(){this.filters={search:"",status:"",priority:"",dateRange:null},this.fetchJobBatches()},getStatusColor:function(t){return{draft:"orange",active:"green",completed:"blue",cancelled:"red",on_hold:"grey"}[t]||"grey"},getPriorityColor:function(t){return{low:"green",medium:"orange",high:"red",urgent:"deep-purple"}[t]||"grey"},getPriorityIcon:function(t){return{low:"mdi-arrow-down",medium:"mdi-minus",high:"mdi-arrow-up",urgent:"mdi-alert"}[t]||"mdi-minus"},formatDate:function(t){return new Date(t).toLocaleDateString()}}},M=N,U=(r(1393),r(32)),component=Object(U.a)(M,(function(){var t=this,e=t._self._c;return e(h.a,{attrs:{fluid:""}},[e(O.a,[e(d.a,{attrs:{cols:"12"}},[e(n.a,[e(c.d,{staticClass:"py-2"},[e(l.a,{attrs:{small:"",color:"primary","text-color":"white"}},[e(_.a,{attrs:{left:"",small:""}},[t._v("mdi-briefcase-outline")]),t._v("\n            Job Batch Management\n          ")],1),t._v(" "),e(C.a),t._v(" "),e(o.a,{attrs:{color:"primary",small:"",disabled:t.loading},on:{click:t.openCreateDialog}},[e(_.a,{attrs:{left:"",small:""}},[t._v("mdi-plus")]),t._v("\n            New Batch\n          ")],1)],1),t._v(" "),e(c.c,{staticClass:"pa-3"},[e(O.a,{attrs:{dense:""}},[e(d.a,{attrs:{cols:"3"}},[e(j.a,{attrs:{label:"Search","prepend-inner-icon":"mdi-magnify",dense:"",outlined:"","hide-details":"auto",clearable:""},on:{input:t.debounceSearch},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(B.a,{attrs:{items:t.statusOptions,label:"Status",dense:"",outlined:"","hide-details":"auto",clearable:""},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}})],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(B.a,{attrs:{items:t.priorityOptions,label:"Priority",dense:"",outlined:"","hide-details":"auto",clearable:""},model:{value:t.filters.priority,callback:function(e){t.$set(t.filters,"priority",e)},expression:"filters.priority"}})],1),t._v(" "),e(d.a,{attrs:{cols:"3"}},[e(k.a,{ref:"dateMenu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(r){var o=r.on,n=r.attrs;return[e(j.a,t._g(t._b({attrs:{label:"Date Range","prepend-inner-icon":"mdi-calendar",readonly:"",dense:"",outlined:"","hide-details":"auto",clearable:""},model:{value:t.filters.dateRange,callback:function(e){t.$set(t.filters,"dateRange",e)},expression:"filters.dateRange"}},"v-text-field",n,!1),o))]}}]),model:{value:t.dateMenu,callback:function(e){t.dateMenu=e},expression:"dateMenu"}},[t._v(" "),e(v.a,{attrs:{range:""},on:{input:function(e){t.dateMenu=!1}},model:{value:t.filters.dateRange,callback:function(e){t.$set(t.filters,"dateRange",e)},expression:"filters.dateRange"}})],1)],1),t._v(" "),e(d.a,{attrs:{cols:"2"}},[e(o.a,{attrs:{color:"secondary",outlined:"",small:"",block:""},on:{click:t.clearFilters}},[t._v("\n                Clear Filters\n              ")])],1)],1)],1),t._v(" "),e(c.c,{staticClass:"pa-3 pt-0"},[e(O.a,t._l(t.statistics,(function(r){return e(d.a,{key:r.title,attrs:{cols:"2"}},[e(n.a,{staticClass:"text-center pa-2",attrs:{outlined:""}},[e(_.a,{attrs:{color:r.color,size:"24"}},[t._v(t._s(r.icon))]),t._v(" "),e("div",{staticClass:"text-h6 mt-1"},[t._v(t._s(r.value))]),t._v(" "),e("div",{staticClass:"text-caption"},[t._v(t._s(r.title))])],1)],1)})),1)],1)],1)],1)],1),t._v(" "),e(O.a,[e(d.a,{attrs:{cols:"12"}},[e(n.a,[e(f.a,{staticClass:"elevation-0",attrs:{headers:t.headers,items:t.jobBatches,loading:t.loading,options:t.tableOptions,"server-items-length":t.totalItems,"footer-props":{"items-per-page-options":[10,25,50,100]},dense:""},on:{"update:options":function(e){t.tableOptions=e}},scopedSlots:t._u([{key:"item.runningNo",fn:function(r){var o=r.item;return[e(l.a,{attrs:{"x-small":"",color:"grey","text-color":"white"}},[t._v("\n              "+t._s(o.runningNo)+"\n            ")])]}},{key:"item.status",fn:function(r){var o=r.item;return[e(l.a,{attrs:{"x-small":"",color:t.getStatusColor(o.status),"text-color":"white"}},[t._v("\n              "+t._s(o.status.toUpperCase())+"\n            ")])]}},{key:"item.priority",fn:function(r){var o=r.item;return[e(l.a,{attrs:{"x-small":"",color:t.getPriorityColor(o.priority),"text-color":"white"}},[e(_.a,{attrs:{left:"","x-small":""}},[t._v(t._s(t.getPriorityIcon(o.priority)))]),t._v("\n              "+t._s(o.priority.toUpperCase())+"\n            ")],1)]}},{key:"item.totalPositions",fn:function(r){var o=r.item;return[e("div",{staticClass:"text-center"},[e("span",{staticClass:"text-body-2 font-weight-bold"},[t._v(t._s(o.totalPositions||0))])])]}},{key:"item.batchStartDate",fn:function(r){var o=r.item;return[o.batchStartDate?e("span",{staticClass:"text-caption"},[t._v("\n              "+t._s(t.formatDate(o.batchStartDate))+"\n            ")]):e("span",{staticClass:"text-caption grey--text"},[t._v("Not set")])]}},{key:"item.deploymentDate",fn:function(r){var o=r.item;return[o.deploymentDate?e("span",{staticClass:"text-caption"},[t._v("\n              "+t._s(t.formatDate(o.deploymentDate))+"\n            ")]):e("span",{staticClass:"text-caption grey--text"},[t._v("Not set")])]}},{key:"item.isOverdue",fn:function(r){return[r.item.isOverdue?e(_.a,{attrs:{color:"error",small:""}},[t._v("\n              mdi-clock-alert\n            ")]):t._e()]}},{key:"item.actions",fn:function(r){var n=r.item;return[e(k.a,{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(r){var n=r.on,c=r.attrs;return[e(o.a,t._g(t._b({attrs:{icon:"",small:""}},"v-btn",c,!1),n),[e(_.a,{attrs:{small:""}},[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),e(y.a,{attrs:{dense:""}},[e(w.a,{on:{click:function(e){return t.viewDetails(n)}}},[e(D.a,[e(_.a,{attrs:{small:""}},[t._v("mdi-eye")])],1),t._v(" "),e(S.c,[t._v("View")])],1),t._v(" "),e(w.a,{on:{click:function(e){return t.editBatch(n)}}},[e(D.a,[e(_.a,{attrs:{small:""}},[t._v("mdi-pencil")])],1),t._v(" "),e(S.c,[t._v("Edit")])],1),t._v(" "),e(w.a,{on:{click:function(e){return t.updateStatus(n)}}},[e(D.a,[e(_.a,{attrs:{small:""}},[t._v("mdi-update")])],1),t._v(" "),e(S.c,[t._v("Update Status")])],1),t._v(" "),e(x.a),t._v(" "),e(w.a,{staticClass:"error--text",on:{click:function(e){return t.deleteBatch(n)}}},[e(D.a,[e(_.a,{attrs:{small:"",color:"error"}},[t._v("mdi-delete")])],1),t._v(" "),e(S.c,[t._v("Delete")])],1)],1)],1)]}}])})],1)],1)],1),t._v(" "),e("job-batch-dialog",{attrs:{batch:t.selectedBatch,"is-edit":t.isEdit},on:{saved:t.onBatchSaved,cancelled:t.onDialogCancelled},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}}),t._v(" "),e(m.a,{attrs:{"max-width":"400px",persistent:""},model:{value:t.showStatusDialog,callback:function(e){t.showStatusDialog=e},expression:"showStatusDialog"}},[e(n.a,[e(c.d,{staticClass:"text-h6"},[t._v("Update Status")]),t._v(" "),e(c.c,[e(B.a,{attrs:{items:t.statusOptions,label:"New Status",outlined:"",dense:""},model:{value:t.newStatus,callback:function(e){t.newStatus=e},expression:"newStatus"}})],1),t._v(" "),e(c.a,[e(C.a),t._v(" "),e(o.a,{attrs:{text:""},on:{click:function(e){t.showStatusDialog=!1}}},[t._v("Cancel")]),t._v(" "),e(o.a,{attrs:{color:"primary",loading:t.updating},on:{click:t.confirmStatusUpdate}},[t._v("\n          Update\n        ")])],1)],1)],1)],1)}),[],!1,null,"69b9dbb1",null);e.default=component.exports}}]);