(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{893:function(t,e,n){"use strict";n.r(e);var r=n(782),o=n(316),c=n(313),l=n(18),d=n(317),f=n(775),m=n(754),y=n(781),v=n(167),h=n(777),k=n(113),O=(n(10),n(7),n(9),n(11),n(8),n(12),n(20)),w=n(3),j=(n(92),n(22),n(35),n(66),n(5),n(44),n(36)),x=n(40);function C(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function I(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?C(Object(source),!0).forEach((function(e){Object(w.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):C(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var S={props:{id:{type:Number,default:0},productId:{type:Number,default:""},productName:{type:String,default:""},isEdit:{type:Boolean,default:!1},cost:{type:Number,default:0}},data:function(){return{stockQty:1,stockCost:this.cost,isSubmitting:!1,locationList:[],srcLocationId:1,currencyId:1,exchangeRate:1}},computed:I(I({},Object(x.c)(["findAllCurrency","findSelectedTerminal","findAllTerminal"])),{},{numberRule:function(){return[function(t){return!!t||"ກະລຸນາ ໃສ່ຈຳນວນ "},function(t){return/^[0-9]+$/.test(t)||"ໃສ່ໄດ້ສະເພາະ ຕົວເລກ"}]},user:function(){return this.$auth.user||""},currencyExchangeRate:function(){var t=this;return this.findAllCurrency.find((function(e){return e.id==t.currencyId})).rate}}),created:function(){var t=this;console.log("Location in terminal ".concat(this.findSelectedTerminal));var e=this.findAllTerminal.find((function(e){return e.id==t.findSelectedTerminal})).locationId;this.srcLocationId=e,this.loadLocation(),this.loadProduct()},methods:{loadLocation:function(t){var e=this;return Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isloading=!0,t.next=3,e.$axios.get("api/location/find").then((function(t){e.locationList=t.data.map((function(t){return t}))})).catch((function(t){Object(j.j)(e.$swal,"Error","Operation fail "+t.Error)}));case 3:e.isloading=!1;case 4:case"end":return t.stop()}}),t)})))()},loadProduct:function(){var t=this;return Object(O.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isSubmitting=!0,e.next=3,t.$axios.get("api/product/find/".concat(t.id)).then((function(e){e.data.costCurrency?(console.log("Cost info available"),t.currencyId=e.data.costCurrency.id):console.log("Cost info not available")})).catch((function(e){Object(j.j)(t.$swal,"Error","Operation fail "+e.Error)}));case 3:t.isSubmitting=!1;case 4:case"end":return e.stop()}}),e)})))()},stockSubmit:function(){var t=this;return Object(O.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.myform.validate()||t.isSubmitting){e.next=7;break}return t.isSubmitting=!0,n={inputter:t.user.id,product_id:t.productId,stockCardQty:t.stockQty,totalCost:t.stockCost,productId:t.id,srcLocationId:t.srcLocationId,currencyId:t.currencyId,exchangeRate:t.currencyExchangeRate},console.log("Pre fly ",n),e.next=6,t.$axios.post("/api/card/bulkCreate",n).then((function(e){console.log(e.data),Object(j.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ"),t.$emit("reload"),t.$emit("close-dialog")})).catch((function(e){console.log(e),Object(j.j)(t.$swal,"Error",e.response.data)}));case 6:t.isSubmitting=!1;case 7:case"end":return e.stop()}}),e)})))()}}},_=n(32),component=Object(_.a)(S,(function(){var t=this,e=t._self._c;return e("div",[e(m.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isSubmitting,callback:function(e){t.isSubmitting=e},expression:"isSubmitting"}},[e("loading-indicator")],1),t._v(" "),e(c.a,[e(l.d,[e(d.a,{staticClass:"ma-2",attrs:{color:"primary",label:"","text-color":"white"}},[e(v.a,{attrs:{start:""}},[t._v("mdi-label")]),t._v("\n                "+t._s(t.productName)+"\n            ")],1)],1),t._v(" "),e(l.c,[e(f.a,[e(y.a,{ref:"myform",on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e(r.a,{attrs:{"item-text":"name","item-value":"id",items:t.locationList,label:"Source location*"},model:{value:t.srcLocationId,callback:function(e){t.srcLocationId=e},expression:"srcLocationId"}}),t._v(" "),e(k.a,{attrs:{label:"ຈຳນວນ",rules:t.numberRule,"hide-details":"auto"},model:{value:t.stockQty,callback:function(e){t.stockQty=e},expression:"stockQty"}}),t._v(" "),e(r.a,{attrs:{"item-text":"code","item-value":"id",items:t.findAllCurrency,label:"Currency*"},model:{value:t.currencyId,callback:function(e){t.currencyId=e},expression:"currencyId"}}),t._v(" "),e(k.a,{attrs:{label:"ຕົ້ນທຶນທັງຫໝົດ",rules:t.numberRule,"hide-details":"auto"},model:{value:t.stockCost,callback:function(e){t.stockCost=e},expression:"stockCost"}})],1)],1)],1),t._v(" "),e(l.a,[e(h.a),t._v(" "),e(o.a,{staticClass:"warning",attrs:{rounded:""},on:{click:function(e){return t.$emit("close-dialog")}}},[t._v("\n                ປິດ\n            ")]),t._v(" "),e(o.a,{staticClass:"primary",attrs:{rounded:""},on:{click:t.stockSubmit}},[t._v("\n                ບັນທຶກ\n            ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})}}]);