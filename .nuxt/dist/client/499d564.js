(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{1065:function(t,e,n){var content=n(1411);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(15).default)("1c4e3db6",content,!0,{sourceMap:!1})},1410:function(t,e,n){"use strict";n(1065)},1411:function(t,e,n){var r=n(14)((function(i){return i[1]}));r.push([t.i,".v-card-title.primary[data-v-526360aa]{background:linear-gradient(45deg,#1976d2,#1565c0)}.text-caption[data-v-526360aa]{font-size:12px!important}",""]),r.locals={},t.exports=r},1763:function(t,e,n){"use strict";n.r(e);var r=n(321),o=n(318),c=n(19),l=n(322),d=n(797),m=n(792),f=n(806),h=n(1746),v=n(771),x=n(317),_=n(168),w=n(311),y=n(198),k=n(169),O=n(29),C=n(323),D=n(796),S=n(66),B=n(794),j=n(112),R=(n(34),n(130),n(3)),J=n(17),E=(n(85),n(30),n(10),n(7),n(9),n(5),n(12),n(8),n(13),n(1717)),M=n(961);function P(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var I={name:"JobBatchList",components:{JobBatchDialog:E.default},middleware:"auths",data:function(){return{loading:!1,updating:!1,loadingMous:!1,dateMenu:!1,showDialog:!1,showStatusDialog:!1,isEdit:!1,selectedBatch:null,newStatus:"",jobBatches:[],totalItems:0,mouFilterOptions:[],filters:{search:"",mouId:"",status:"",dateRange:null},tableOptions:{page:1,itemsPerPage:25,sortBy:["createdAt"],sortDesc:[!0]},headers:[{text:"ເລກທີ່",value:"runningNo",sortable:!0,width:"100px"},{text:"ລະຫັດ Job",value:"mou",sortable:!1,width:"200px"},{text:"ສະຖານທີ່ວຽກ",value:"workPlace",sortable:!1,width:"150px"},{text:"ໜ້າວຽກ",value:"jobTitle",sortable:!1,width:"150px"},{text:"ສະຖານະ",value:"status",sortable:!0,width:"120px"},{text:"ເປີດຮັບ",value:"totalPositions",sortable:!0,width:"100px",align:"center"},{text:"ສະໝັກແລ້ວ",value:"applicantCount",sortable:!1,width:"100px",align:"center"},{text:"ວັນເລີ່ມ",value:"batchStartDate",sortable:!0,width:"120px"},{text:"ວັນສິ້ນສຸດ",value:"batchEndDate",sortable:!0,width:"120px"},{text:"ຄຳສັ່ງ",value:"actions",sortable:!1,width:"80px",align:"center"}],statusOptions:[{text:"ດຳເນີນການ",value:"active"},{text:"ສຳເລັດ",value:"completed"},{text:"ຍົກເລີກ",value:"cancelled"},{text:"ລໍຖ້າ",value:"on_hold"}]}},computed:{dateRangeText:function(){return this.filters.dateRange&&0!==this.filters.dateRange.length?1===this.filters.dateRange.length?this.filters.dateRange[0]:"".concat(this.filters.dateRange[0]," - ").concat(this.filters.dateRange[1]):""}},watch:{tableOptions:{handler:function(){this.fetchJobBatches()},deep:!0},"filters.mouId":function(){this.fetchJobBatches()},"filters.status":function(){this.fetchJobBatches()},"filters.dateRange":function(){this.fetchJobBatches()}},mounted:function(){this.fetchJobBatches(),this.fetchMouFilterOptions()},methods:{debounceSearch:Object(M.debounce)((function(){this.fetchJobBatches()}),500),fetchJobBatches:function(){var t=this;return Object(J.a)(regeneratorRuntime.mark((function e(){var n,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,n={page:t.tableOptions.page,limit:t.tableOptions.itemsPerPage,sortBy:t.tableOptions.sortBy[0]||"createdAt",sortOrder:t.tableOptions.sortDesc[0]?"DESC":"ASC",include:"mou"},t.filters.search&&(n.search=t.filters.search),t.filters.mouId&&(n.mouId=t.filters.mouId),t.filters.status&&(n.status=t.filters.status),e.next=8,t.$axios.get("/api/batch-job",{params:n});case 8:r=e.sent,data=r.data,t.jobBatches=data.data.jobBatches,t.totalItems=data.data.pagination.total,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),t.$toast.error("ເກີດຂໍ້ຜິດພາດໃນການໂຫຼດຂໍ້ມູນ"),console.error("Error fetching job batches:",e.t0);case 18:return e.prev=18,t.loading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})))()},fetchMouFilterOptions:function(){var t=this;return Object(J.a)(regeneratorRuntime.mark((function e(){var n,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingMous=!0,e.prev=1,e.next=4,t.$axios.get("/api/mous",{params:{limit:100,fields:"id,mouName,mouNumber"}});case 4:n=e.sent,data=n.data,t.mouFilterOptions=data.data.mous||data.data||[],e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error fetching MOU options:",e.t0);case 12:return e.prev=12,t.loadingMous=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})))()},openCreateDialog:function(){this.selectedBatch=null,this.isEdit=!1,this.showDialog=!0},editBatch:function(t){this.selectedBatch=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?P(Object(source),!0).forEach((function(e){Object(R.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):P(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},t),this.isEdit=!0,this.showDialog=!0},updateStatus:function(t){this.selectedBatch=t,this.newStatus=t.status,this.showStatusDialog=!0},confirmStatusUpdate:function(){var t=this;return Object(J.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.updating=!0,e.prev=1,e.next=4,t.$axios.patch("/api/batch-job/".concat(t.selectedBatch.id,"/status"),{status:t.newStatus});case 4:t.$toast.success("ອັບເດດສະຖານະສຳເລັດແລ້ວ"),t.showStatusDialog=!1,t.fetchJobBatches(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),t.$toast.error("ອັບເດດສະຖານະບໍ່ສຳເລັດ"),console.error("Error updating status:",e.t0);case 13:return e.prev=13,t.updating=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,9,13,16]])})))()},deleteBatch:function(t){var e=this;return Object(J.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$confirm('ທ່ານຕ້ອງການລົບ "'.concat(t.batchName,'" ແມ່ນບໍ?'),{title:"ຢືນຢັນການລົບ"});case 2:if(!n.sent){n.next=15;break}return n.prev=4,n.next=7,e.$axios.delete("/api/batch-job/".concat(t.id));case 7:e.$toast.success("ລົບສຳເລັດແລ້ວ"),e.fetchJobBatches(),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(4),e.$toast.error("ການລົບບໍ່ສຳເລັດ"),console.error("Error deleting batch:",n.t0);case 15:case"end":return n.stop()}}),n,null,[[4,11]])})))()},onBatchSaved:function(){this.showDialog=!1,this.fetchJobBatches(),this.fetchMouFilterOptions()},clearFilters:function(){this.filters={search:"",mouId:"",status:"",dateRange:null},this.fetchJobBatches()},getStatusColor:function(t){return{active:"success",completed:"primary",cancelled:"error",on_hold:"warning"}[t]||"grey"},getStatusIcon:function(t){return{active:"mdi-play-circle",completed:"mdi-check-circle",cancelled:"mdi-close-circle",on_hold:"mdi-pause-circle"}[t]||"mdi-help-circle"},formatStatus:function(t){return{active:"ດຳເນີນການ",completed:"ສຳເລັດ",cancelled:"ຍົກເລີກ",on_hold:"ລໍຖ້າ"}[t]||t},formatDate:function(t){return t?new Date(t).toLocaleDateString("lo-LA",{year:"numeric",month:"short",day:"numeric"}):"-"},isOverdue:function(t){return!!t&&new Date(t)<new Date}}},$=I,N=(n(1410),n(31)),component=Object(N.a)($,(function(){var t=this,e=t._self._c;return e(m.a,{attrs:{fluid:""}},[e(D.a,[e(d.a,{attrs:{cols:"12"}},[e(o.a,[e(c.d,{staticClass:"primary white--text py-3"},[e(_.a,{staticClass:"mr-2",attrs:{color:"white"}},[t._v("mdi-briefcase-outline")]),t._v(" "),e("span",[t._v("ລະບົບຈັດການ Job Batch")]),t._v(" "),e(B.a),t._v(" "),e(r.a,{attrs:{color:"white",text:"",disabled:t.loading},on:{click:t.openCreateDialog}},[e(_.a,{attrs:{left:""}},[t._v("mdi-plus")]),t._v("\n            ເພີ່ມໃໝ່\n          ")],1)],1),t._v(" "),e(c.c,{staticClass:"pa-3"},[e(D.a,{attrs:{dense:""}},[e(d.a,{attrs:{cols:"12",md:"3"}},[e(j.a,{attrs:{label:"ຄົ້ນຫາ","prepend-inner-icon":"mdi-magnify",dense:"",outlined:"","hide-details":"",clearable:""},on:{input:t.debounceSearch},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"3"}},[e(S.a,{attrs:{items:t.mouFilterOptions,loading:t.loadingMous,label:"ສັນຍາ MOU","prepend-inner-icon":"mdi-file-document",dense:"",outlined:"","hide-details":"",clearable:"","item-text":"mouName","item-value":"id"},model:{value:t.filters.mouId,callback:function(e){t.$set(t.filters,"mouId",e)},expression:"filters.mouId"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"2"}},[e(S.a,{attrs:{items:t.statusOptions,label:"ສະຖານະ","prepend-inner-icon":"mdi-information",dense:"",outlined:"","hide-details":"",clearable:""},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}})],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"2"}},[e(C.a,{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,o=n.attrs;return[e(j.a,t._g(t._b({attrs:{label:"ຊ່ວງເວລາ","prepend-inner-icon":"mdi-calendar",readonly:"",dense:"",outlined:"","hide-details":"",clearable:""},on:{"click:clear":function(e){t.filters.dateRange=null}},model:{value:t.dateRangeText,callback:function(e){t.dateRangeText=e},expression:"dateRangeText"}},"v-text-field",o,!1),r))]}}]),model:{value:t.dateMenu,callback:function(e){t.dateMenu=e},expression:"dateMenu"}},[t._v(" "),e(h.a,{attrs:{range:""},on:{input:function(e){t.dateMenu=!1}},model:{value:t.filters.dateRange,callback:function(e){t.$set(t.filters,"dateRange",e)},expression:"filters.dateRange"}})],1)],1),t._v(" "),e(d.a,{attrs:{cols:"12",md:"2"}},[e(r.a,{attrs:{color:"secondary",outlined:"",block:""},on:{click:t.clearFilters}},[e(_.a,{attrs:{left:""}},[t._v("mdi-refresh")]),t._v("\n                Reset\n              ")],1)],1)],1)],1)],1)],1)],1),t._v(" "),e(D.a,{staticClass:"mt-3"},[e(d.a,{attrs:{cols:"12"}},[e(o.a,[e(c.d,{staticClass:"py-2"},[e(_.a,{staticClass:"mr-2"},[t._v("mdi-table")]),t._v(" "),e("span",[t._v("ລາຍການ Job Batch")]),t._v(" "),e(B.a),t._v(" "),e(l.a,{attrs:{color:"primary",outlined:""}},[t._v("\n            "+t._s(t.totalItems)+" ລາຍການ\n          ")])],1),t._v(" "),e(f.a,{staticClass:"elevation-0",attrs:{headers:t.headers,items:t.jobBatches,loading:t.loading,options:t.tableOptions,"server-items-length":t.totalItems,"footer-props":{"items-per-page-options":[10,25,50,100]},"loading-text":"ກຳລັງໂຫຼດຂໍ້ມູນ...","no-data-text":"ບໍ່ມີຂໍ້ມູນ"},on:{"update:options":function(e){t.tableOptions=e}},scopedSlots:t._u([{key:"item.runningNo",fn:function(n){var r=n.item;return[e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:"grey"}},[t._v("mdi-numeric")]),t._v(" "),e(l.a,{attrs:{"x-small":"",color:"grey lighten-1","text-color":"white"}},[t._v("\n                "+t._s(r.runningNo)+"\n              ")])],1)]}},{key:"item.mou",fn:function(n){var r=n.item;return[r.mou?e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{small:"",color:"primary"}},[t._v("mdi-file-document")]),t._v(" "),e("div",[e("div",{staticClass:"text-caption font-weight-bold"},[t._v(t._s(r.mou.mouName))]),t._v(" "),e("div",{staticClass:"text-caption grey--text"},[t._v(t._s(r.mou.mouNumber))])])],1):e("span",{staticClass:"text-caption grey--text"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":""}},[t._v("mdi-minus-circle")]),t._v("\n              ບໍ່ມີ MOU\n            ")],1)]}},{key:"item.workPlace",fn:function(n){var r,o=n.item;return[e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:"blue"}},[t._v("mdi-map-marker")]),t._v(" "),e("span",{staticClass:"text-caption"},[t._v(t._s((null===(r=o.mou)||void 0===r?void 0:r.workLocation)||"-"))])],1)]}},{key:"item.jobTitle",fn:function(n){var r,o=n.item;return[e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:"purple"}},[t._v("mdi-briefcase")]),t._v(" "),e("span",{staticClass:"text-caption"},[t._v(t._s((null===(r=o.mou)||void 0===r?void 0:r.jobTitle)||"-"))])],1)]}},{key:"item.status",fn:function(n){var r=n.item;return[e(l.a,{attrs:{"x-small":"",color:t.getStatusColor(r.status),"text-color":"white"}},[e(_.a,{attrs:{"x-small":"",left:""}},[t._v(t._s(t.getStatusIcon(r.status)))]),t._v("\n              "+t._s(t.formatStatus(r.status))+"\n            ")],1)]}},{key:"item.totalPositions",fn:function(n){var r=n.item;return[e("div",{staticClass:"d-flex align-center justify-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:"success"}},[t._v("mdi-account-multiple")]),t._v(" "),e("span",{staticClass:"text-caption font-weight-bold"},[t._v(t._s(r.totalPositions||0))])],1)]}},{key:"item.applicantCount",fn:function(n){var r,o=n.item;return[e("div",{staticClass:"d-flex align-center justify-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:"info"}},[t._v("mdi-account-check")]),t._v(" "),e("span",{staticClass:"text-caption font-weight-bold"},[t._v("\n                "+t._s((null===(r=o.applicantStatistics)||void 0===r?void 0:r.interview)||0)+"\n              ")])],1)]}},{key:"item.batchStartDate",fn:function(n){var r=n.item;return[e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:"green"}},[t._v("mdi-calendar-start")]),t._v(" "),r.batchStartDate?e("span",{staticClass:"text-caption"},[t._v("\n                "+t._s(t.formatDate(r.batchStartDate))+"\n              ")]):e("span",{staticClass:"text-caption grey--text"},[t._v("ບໍ່ມີ")])],1)]}},{key:"item.batchEndDate",fn:function(n){var r=n.item;return[e("div",{staticClass:"d-flex align-center"},[e(_.a,{staticClass:"mr-1",attrs:{"x-small":"",color:t.isOverdue(r.batchEndDate)?"error":"warning"}},[t._v("\n                mdi-calendar-end\n              ")]),t._v(" "),r.batchEndDate?e("span",{staticClass:"text-caption",class:{"error--text":t.isOverdue(r.batchEndDate)}},[t._v("\n                "+t._s(t.formatDate(r.batchEndDate))+"\n              ")]):e("span",{staticClass:"text-caption grey--text"},[t._v("ບໍ່ມີ")])],1)]}},{key:"item.actions",fn:function(n){var o=n.item;return[e(C.a,{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,c=n.attrs;return[e(r.a,t._g(t._b({attrs:{icon:"",small:""}},"v-btn",c,!1),o),[e(_.a,{attrs:{small:""}},[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),e(w.a,{attrs:{dense:""}},[e(y.a,{on:{click:function(e){return t.editBatch(o)}}},[e(k.a,[e(_.a,{attrs:{small:"",color:"info"}},[t._v("mdi-pencil")])],1),t._v(" "),e(O.c,[t._v("ແກ້ໄຂ")])],1),t._v(" "),e(y.a,{on:{click:function(e){return t.updateStatus(o)}}},[e(k.a,[e(_.a,{attrs:{small:"",color:"orange"}},[t._v("mdi-update")])],1),t._v(" "),e(O.c,[t._v("ອັບເດດສະຖານະ")])],1),t._v(" "),e(x.a)],1)],1)]}}])})],1)],1)],1),t._v(" "),e("job-batch-dialog",{attrs:{batch:t.selectedBatch,"is-edit":t.isEdit},on:{saved:t.onBatchSaved,cancelled:function(e){t.showDialog=!1}},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}}),t._v(" "),e(v.a,{attrs:{"max-width":"400px",persistent:""},model:{value:t.showStatusDialog,callback:function(e){t.showStatusDialog=e},expression:"showStatusDialog"}},[e(o.a,[e(c.d,{staticClass:"text-h6"},[t._v("ອັບເດດສະຖານະ")]),t._v(" "),e(c.c,[e(S.a,{attrs:{items:t.statusOptions,label:"ສະຖານະໃໝ່",outlined:"",dense:""},model:{value:t.newStatus,callback:function(e){t.newStatus=e},expression:"newStatus"}})],1),t._v(" "),e(c.a,[e(B.a),t._v(" "),e(r.a,{attrs:{text:""},on:{click:function(e){t.showStatusDialog=!1}}},[t._v("ຍົກເລີກ")]),t._v(" "),e(r.a,{attrs:{color:"primary",loading:t.updating},on:{click:t.confirmStatusUpdate}},[t._v("\n          ອັບເດດ\n        ")])],1)],1)],1)],1)}),[],!1,null,"526360aa",null);e.default=component.exports}}]);