(window.webpackJsonp=window.webpackJsonp||[]).push([[138,65,121,136,137,147],{1889:function(t,e,n){"use strict";n.r(e);var r=n(799),o=n(853),l=n(321),c=n(318),d=n(19),v=n(322),f=n(797),x=n(806),h=n(771),m=n(317),_=n(168),y=n(796),O=n(91),w=n(794),k=n(112),j=n(828),I=(n(34),n(130),n(63),n(35),n(69),n(54),n(7),n(67),n(93),n(53),n(10),n(9),n(12),n(8),n(13),n(3)),N=n(23),$=n(17),L=(n(85),n(24),n(100),n(64),n(5),n(30),n(113),n(831),n(855)),C=n(44),E=n(267),D=n(37),P=n(835);function S(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function R(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?S(Object(source),!0).forEach((function(e){Object(I.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):S(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function A(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){c=!0,o=t},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var F={components:{PricingOption:E.default,CancelTicketForm:P.default},props:{headerId:{type:Number,default:0},isQuotation:{type:Boolean,default:!1},isUpdate:{type:Boolean,default:!1},updateAllow:{type:Boolean,default:!0}},directives:{commaThousand:L.a},created:function(){var t=this;return Object($.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isUpdate){e.next=8;break}return console.log("View old record"),t.isloading=!0,e.next=5,t.loadTransaction();case 5:t.isloading=!1,e.next=16;break;case 8:n=(new Date).toISOString().substr(0,10),t.transaction.checkin_date=n,t.transaction.checkout_date=n,t.transaction.clientId=1,t.transaction.paymentId=1,t.transaction.currencyId=1,t.transaction.discount=0,t.newRow();case 16:case"end":return e.stop()}}),e)})))()},methods:{cancelOrder:function(){this.cancelConfirmDialog=!0},updatePricing:function(t){var e=this,n=t.amount;console.log("New pricing ".concat(n)),console.log("New pricing ".concat(JSON.stringify(this.transaction.lines[0])));var r=this.transaction.lines.findIndex((function(t){return t.productId==e.productPricingSelected}));if(!(r<0)){var o=this.transaction.lines[r].qty,l=this.transaction.lines[r].rate;if("Price"!=t.type){var c=this.transaction.lines[r].price,d=c*n/100+c;this.transaction.lines[r].total=o*l*d-0,this.transaction.lines[r].price=d}else this.transaction.lines[r].total=o*l*n-0,this.transaction.lines[r].price=n}},pricingLogig:function(t){console.log("PRINCING CLICK....".concat(JSON.stringify(t))),this.productPricingSelected=t.productId,this.pricingDialogKey+=1,this.pricingDialog=!0},findCurrency:function(t){return this.findAllCurrency.find((function(e){return e.id==t}))},quotationPreview:function(){var path=this.isQuotation?"PDFQuotation":"PDFInvoice";window.open("/admin/".concat(path,"/").concat(this.headerId),"_blank")},handleKeyDown:function(t){"Tab"===t.key&&(console.log("Tab key pressed"),this.newRow())},currencyChange:function(){var t=this,e=this.currencyList.find((function(e){return e.id==t.transaction.currencyId}));e&&(this.transaction.exchangeRate=e.rate,console.log("Rate exchange ".concat(e.rate," real value ").concat(this.transaction.exchangeRate)))},deleteItem:function(t){var e=this;return Object($.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.id){n.next=8;break}return console.log("Line has id"),e.isloading=!0,n.next=5,e.$axios.delete("api/".concat(e.apiLine,"Line/find/").concat(t.id)).then((function(n){e.transaction.lines.splice(e.transaction.lines.indexOf(t),1)})).catch((function(t){Object(D.j)(e.$swal,"Error","Operation fail "+t.Error)}));case 5:e.isloading=!1,n.next=10;break;case 8:e.transaction.lines.splice(e.transaction.lines.indexOf(t),1),console.log("Line has no id");case 10:case"end":return n.stop()}}),n)})))()},quantityChange:function(data){console.log("Qty change");var t=this.transaction.lines.indexOf(data),e=Object(D.h)(this.transaction.lines[t].qty,",",""),n=Object(D.h)(this.transaction.lines[t].rate,",",""),r=Object(D.h)(this.transaction.lines[t].price,",","");this.transaction.lines[t].total=n*e*r-0},unitRateChange:function(data){console.log("Unit rate change");var t=this.transaction.lines.indexOf(data),e=Object(D.h)(this.transaction.lines[t].qty,",",""),n=Object(D.h)(this.transaction.lines[t].rate,",",""),r=Object(D.h)(this.transaction.lines[t].price,",","");this.transaction.lines[t].total=n*e*r-0},discountChange:function(data){console.log("Discount change");var t=this.transaction.lines.indexOf(data),e=Object(D.h)(this.transaction.lines[t].qty,",",""),n=Object(D.h)(this.transaction.lines[t].rate,",",""),r=Object(D.h)(this.transaction.lines[t].price,",","");this.transaction.lines[t].total=n*e*r-0},unitChange:function(data){console.log("Unit change");var t=this.unitList.find((function(t){return t.id==data.unitId}));if(null!=t){var e=this.transaction.lines.indexOf(data);this.transaction.lines[e].rate=t.rate;var n=Object(D.h)(this.transaction.lines[e].qty,",",""),r=Object(D.h)(this.transaction.lines[e].price,",","");this.transaction.lines[e].total=t.rate*n*r-0}},productChange:function(data){console.log("Product change");var t=this.productList.find((function(t){return t.id==data.productId}));if(null!=t){var e=this.transaction.lines.indexOf(data),n=this.findCurrency(t.saleCurrencyId);console.log("$$$$$$ ".concat(n.id," $$$$$$"));var r=t.pro_price*n.rate;this.transaction.lines[e].price=r;var o=Object(D.h)(this.transaction.lines[e].qty,",",""),l=Object(D.h)(this.transaction.lines[e].price,",",""),c=Object(D.h)(this.transaction.lines[e].rate,",","");this.transaction.lines[e].total=c*o*l-0}else console.log("Product is not define")},newRow:function(){this.transaction.lines.push({qty:0,rate:1,price:0,discount:0,total:0,isActive:!0,productId:0,unitId:1})},openCustomerDialog:function(){this.customerDialog=!0},loadTransaction:function(){var t=this;return Object($.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("api/".concat(t.apiLine,"/find/").concat(t.headerId)).then((function(e){t.transaction=e.data,console.log("Data ",e.data)})).catch((function(e){Object(D.j)(t.$swal,"Error","Could no load data "+e.Error)}));case 2:case"end":return e.stop()}}),e)})))()},post:function(){this.errorLineNumber=null;var t,e=A(this.transaction.lines);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(this.errorLineNumber=this.transaction.lines.indexOf(n),!this.validateLine(n,this.errorLineNumber+1))return void(this.sheet=!0);n.total=n.qty*n.rate*n.price-n.discount}}catch(t){e.e(t)}finally{e.f()}console.log("******** No error found process posting ********"),this.errorLineNumber=null},validateLine:function(t,e){var n=t.qty,r=t.rate,o=t.price,l=(t.discount,t.total),c=t.productId,d=t.unitId;return 0,r=parseInt(r),n=parseInt(n),!Number.isFinite(n)||Number(n)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ຈຳນວນ ຕ້ອງໃຫຍ່ກ່ອນ 0  current value is ").concat(n,"********"),!1):!Number.isFinite(r)||Number(r)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ອັດຕາຫົວຫນ່ວຍ ຕ້ອງໃຫຍ່ກ່ອນ 0  current value is ").concat(r,"********"),!1):(console.log("Type of price ",Object(N.a)(o)," [price] ",o),!Number.isFinite(o)||Number(o)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ລາຄາ ຕ້ອງໃຫຍ່ກ່ອນ 0  current value is ").concat(o,"********"),!1):(console.log("Type of discount1 ",Object(N.a)(0)),Number.isFinite(0)?!Number.isFinite(l)||Number(l)<=0?(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ຍອດລວມ ຕ້ອງໃຫຍ່ກ່ອນ 0 current value is ").concat(l,"********"),!1):Number.isFinite(c)?!!Number.isFinite(d)||(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ຫົວຫນ່ວຍບໍ່ຖືກຕ້ອງ  current value is ").concat(d,"********"),!1):(this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ສິນຄ້າບໍ່ຖືກຕ້ອງ  current value is ").concat(c,"********"),!1):(console.log("Type of discount2 ",Object(N.a)(0)),this.validateErrorMessage="******** Error ລາຍການທີ #".concat(e," ສ່ວນລົດ ຕ້ອງເປັນຕົວເລກ  current value is ").concat(0,"********"),!1)))},validateHeader:function(){return this.headerError=!0,this.sheet=!0,console.log("=== currency id ",this.transaction.currencyId),this.transaction.currencyId?this.transaction.paymentId?0==this.transaction.lines.length?(this.validateErrorMessage="******** Error Header ບໍ່ມີລາຍການສິນຄ້າ ********",!1):(this.sheet=!1,this.headerError=!1,!0):(this.validateErrorMessage="******** Error Payment in Header #".concat(this.transaction.paymentId," ບໍ່ສາມາດເປັນຄ່າວ່າງ ********"),!1):(this.validateErrorMessage="******** Error Currency in Header #".concat(this.transaction.currencyId," ບໍ່ສາມາດເປັນຄ່າວ່າງ ********"),!1)},getFormatNum:function(t){return(new Intl.NumberFormat).format(t)},toggleDialog:function(){this.$emit("close-dialog")},postToInvoice:function(){var t=this;return Object($.a)(regeneratorRuntime.mark((function e(){var n,r,o,l,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isloading&&t.validateHeader()){e.next=2;break}return e.abrupt("return");case 2:t.isloading=!0,t.errorLineNumber=null,n=[],r=A(t.transaction.lines),e.prev=6,r.s();case 8:if((o=r.n()).done){e.next=21;break}if(l=o.value,t.errorLineNumber=t.transaction.lines.indexOf(l),t.validateLine(l,t.errorLineNumber+1)){e.next=15;break}return t.sheet=!0,t.isloading=!1,e.abrupt("return");case 15:l.discount=0,l.qty=parseInt(Object(D.h)(l.qty,",","")),l.rate=parseInt(Object(D.h)(l.rate,",","")),n.push(l);case 19:e.next=8;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),r.e(e.t0);case 26:return e.prev=26,r.f(),e.finish(26);case 29:for(c=0,d=n;c<d.length;c++)d[c].id=null;return console.log("******** No error found process posting ********"),t.errorLineNumber=null,t.transaction.userId=t.user.id,t.transaction.total=t.grandTotal,t.transaction.referenceNo=t.headerId,t.transaction.lines=n,t.transaction.discount=Object(D.h)(t.transaction.discount,",",""),t.transaction.locationId=t.currentTerminal.locationId,console.log("Amount total ".concat(t.transaction.total)),e.next=41,t.$axios.post("api/sale/create",t.transaction).then((function(e){t.$emit("reload"),Object(D.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")})).catch((function(e){console.error(e),Object(D.j)(t.$swal,"Error",e.response.data);var n=e.response.data.split("#")[1];null!=n&&(t.validateErrorMessage="********  ສິນຄ້າໃນສ້າງບໍ່ພຽງພໍ ********",t.errorLineNumber=t.transaction.lines.indexOf(t.transaction.lines.find((function(t){return t.productId==n}))),t.sheet=!0),console.log("Error ===>: "+e)}));case 41:t.isloading=!1;case 42:case"end":return e.stop()}}),e,null,[[6,23,26,29]])})))()},postTransaction:function(){var t=this;return Object($.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isloading&&t.validateHeader()){e.next=2;break}return e.abrupt("return");case 2:t.isloading=!0,t.errorLineNumber=null,n=A(t.transaction.lines),e.prev=5,n.s();case 7:if((r=n.n()).done){e.next=19;break}if(o=r.value,t.errorLineNumber=t.transaction.lines.indexOf(o),t.validateLine(o,t.errorLineNumber+1)){e.next=14;break}return t.sheet=!0,t.isloading=!1,e.abrupt("return");case 14:o.discount=0,o.qty=parseInt(Object(D.h)(o.qty,",","")),o.rate=parseInt(Object(D.h)(o.rate,",",""));case 17:e.next=7;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(5),n.e(e.t0);case 24:return e.prev=24,n.f(),e.finish(24);case 27:if(console.log("******** No error found process posting ********"),t.errorLineNumber=null,t.transaction.userId=t.user.id,t.transaction.total=t.grandTotal,t.transaction.discount=Object(D.h)(t.transaction.discount,",",""),console.log("Amount total ".concat(t.transaction.total)),!t.isUpdate){e.next=38;break}return e.next=36,t.$axios.put("api/".concat(t.apiLine,"/update/").concat(t.headerId),t.transaction).then((function(e){t.$emit("reload"),Object(D.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")})).catch((function(e){console.error(e),Object(D.j)(t.$swal,"Error",e.response.data);var n=e.response.data.split("#")[1];if(null!=n){var r=t.productList.find((function(t){return t.id==n}));t.validateErrorMessage="********  ສິນຄ້າ ".concat(r.pro_name," ໃນສ້າງບໍ່ພຽງພໍ ********"),t.errorLineNumber=t.transaction.lines.indexOf(t.transaction.lines.find((function(t){return t.productId==n}))),t.sheet=!0}console.log("Error ===>: "+e)}));case 36:e.next=40;break;case 38:return e.next=40,t.$axios.post("api/".concat(t.apiLine,"/create"),t.transaction).then((function(e){t.$emit("reload"),Object(D.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")})).catch((function(e){console.error(e),Object(D.j)(t.$swal,"Error",e.response.data);var n=e.response.data.split("#")[1];null!=n&&(t.validateErrorMessage="********  ສິນຄ້າໃນສ້າງບໍ່ພຽງພໍ ********",t.errorLineNumber=t.transaction.lines.indexOf(t.transaction.lines.find((function(t){return t.productId==n}))),t.sheet=!0),console.log("Error ===>: "+e)}));case 40:t.isloading=!1;case 41:case"end":return e.stop()}}),e,null,[[5,21,24,27]])})))()}},computed:R(R({},Object(C.c)(["findAllProduct","findAllClient","findAllPayment","findAllUnit","findAllCurrency","findAllTerminal","findSelectedTerminal"])),{},{clientList:function(){return this.findAllClient},currentTerminal:function(){var t=this;return console.log("ALL TEMINAL ".concat(this.findAllTerminal.length," SELECTED ").concat(this.findSelectedTerminal)),this.findAllTerminal.find((function(e){return e.id==t.findSelectedTerminal}))},user:function(){return this.$auth.user||""},apiLine:function(){return"reservation"},productList:function(){return this.findAllProduct},paymentList:function(){return this.findAllPayment},unitList:function(){return this.findAllUnit},currencyList:function(){return this.findAllCurrency},numberRule:function(){return[function(t){return null!=t&&""!==t||"Field is required"},function(t){return/^(\d+(\.\d{1,2})?)|(0(\.\d{1,2})?)$/.test(t)||"Rate must be a number with up to 2 decimal places"}]},grandTotal:function(){return this.transaction.lines.reduce((function(t,e){return t+e.total}),0)-Object(D.h)(this.transaction.discount,",","")}}),data:function(){return{cancelConfirmDialog:!1,productPricingSelected:null,pricingDialogKey:1,pricingDialog:!1,search:"",numberCommaRule:function(t){return/^[0-9,]*$/.test(t)||"Only numbers and commas are allowed"},headerError:!1,customerDialog:!1,validateErrorMessage:"",sheet:!1,errorLineNumber:null,isloading:!1,transaction:{customer_name:"",customer_telephone:"",customer_address:"",isActive:!0,exchangeRate:1,lines:[]},headers:[{text:"#",align:"start",value:""},{text:"ສິນຄ້າ",align:"start",value:"product.pro_name"},{text:"ຈຳນວນ",align:"end",value:"qty"},{text:"ຫົວຫນ່ວຍ",align:"end",value:"unitId",sortable:!0},{text:"unit rate",align:"end",value:"rate",sortable:!0},{text:"ລາຄາ",align:"end",value:"price",sortable:!0},{text:"ລວມ",align:"end",value:"total",sortable:!1},{text:"delete",align:"end",value:"id",sortable:!1}]}}},M=n(31),component=Object(M.a)(F,(function(){var t=this,e=t._self._c;return e("div",[e(h.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isloading,callback:function(e){t.isloading=e},expression:"isloading"}},[e("loading-indicator")],1),t._v(" "),e(h.a,{attrs:{"max-width":"1024"},model:{value:t.customerDialog,callback:function(e){t.customerDialog=e},expression:"customerDialog"}},[e("customer-list",{on:{"close-dialog":function(e){t.customerDialog=!1}}})],1),t._v(" "),e(h.a,{attrs:{"max-width":"1024"},model:{value:t.cancelConfirmDialog,callback:function(e){t.cancelConfirmDialog=e},expression:"cancelConfirmDialog"}},[e("cancel-ticket-form",{attrs:{id:t.headerId},on:{refresh:function(e){return t.$emit("reload")},"close-dialog":function(e){t.cancelConfirmDialog=!1}}})],1),t._v(" "),e(h.a,{attrs:{"max-width":"1024"},model:{value:t.pricingDialog,callback:function(e){t.pricingDialog=e},expression:"pricingDialog"}},[e("pricing-option",{key:t.pricingDialogKey,attrs:{isBackend:!0,"record-id":t.productPricingSelected},on:{"new-price-update":t.updatePricing,"close-dialog":function(e){t.pricingDialog=!1}}})],1),t._v(" "),e(o.a,{attrs:{inset:""},model:{value:t.sheet,callback:function(e){t.sheet=e},expression:"sheet"}},[e(O.a,{staticClass:"text-center",attrs:{height:"200px"}},[e(l.a,{staticClass:"mt-6",attrs:{text:"",color:"error"},on:{click:function(e){t.sheet=!t.sheet}}},[t._v("\n                   close\n               ")]),t._v(" "),e("div",{staticClass:"my-3"},[t._v("\n                   "+t._s(t.validateErrorMessage)+"\n               ")])],1)],1),t._v(" "),e(c.a,[e(d.b,[e(y.a,[e(f.a,{attrs:{cols:"6"}},[e(v.a,{staticClass:"pa-5",attrs:{color:"primary",label:"","text-color":"white"}},[e(_.a,{attrs:{start:""}},[t._v("mdi-label")]),t._v(" "),e("h3",[t._v("RESERVATION")])],1)],1),t._v(" "),e(f.a,{staticStyle:{"text-align":"right"},attrs:{cols:"6"}},[t.isQuotation?e(l.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.postToInvoice}},[e("span",{staticClass:"mdi mdi-cancel"}),t._v("Make to invoice\n                       ")]):t._e(),t._v(" "),e(l.a,{staticClass:"warning",attrs:{disabled:!t.isUpdate||!t.transaction.isActive,size:"large",variant:"outlined",rounded:""},on:{click:t.cancelOrder}},[e("span",{staticClass:"mdi mdi-printer-outline"}),t._v("ຍົກເລີກບິນ\n                       ")]),t._v(" "),e(l.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.quotationPreview}},[e("span",{staticClass:"mdi mdi-printer-outline"}),t._v("Print\n                       ")])],1)],1)],1),t._v(" "),e(m.a),t._v(" "),e(d.c,{staticClass:"pa-1"},[e(c.a,{staticClass:"pa-1",style:t.headerError?"outline:1px solid red":""},[t._v("\n                   "+t._s("ເລກທີຈອງ #")+"\n                   "+t._s(t.transaction.id)+"\n                   "),e(d.c,[e("div",[e(y.a,[e(f.a,{attrs:{cols:"4"}},[e(y.a,[e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{type:"date",label:"ວັນທີ*",hint:"ເດຶອນ/ວັນ/ປີ 12/31/2023"},model:{value:t.transaction.checkin_date,callback:function(e){t.$set(t.transaction,"checkin_date",e)},expression:"transaction.checkin_date"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{type:"date",label:"ວັນທີສົ່ງ*",hint:"ເດຶອນ/ວັນ/ປີ 12/31/2023"},model:{value:t.transaction.checkout_date,callback:function(e){t.$set(t.transaction,"checkout_date",e)},expression:"transaction.checkout_date"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(r.a,{attrs:{"item-text":"payment_code","item-value":"id",items:t.paymentList,label:"ການຊຳລະ*"},model:{value:t.transaction.paymentId,callback:function(e){t.$set(t.transaction,"paymentId",e)},expression:"transaction.paymentId"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(k.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ສ່ວນຫລຸດ*",required:""},model:{value:t.transaction.discount,callback:function(e){t.$set(t.transaction,"discount",e)},expression:"transaction.discount"}})],1)],1)],1),t._v(" "),e(f.a,{attrs:{cols:"4"}},[e(y.a,[e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{label:"ຊື່ລູກຄ້າ"},model:{value:t.transaction.customer_name,callback:function(e){t.$set(t.transaction,"customer_name",e)},expression:"transaction.customer_name"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{label:"ເບິໂທ"},model:{value:t.transaction.customer_telephone,callback:function(e){t.$set(t.transaction,"customer_telephone",e)},expression:"transaction.customer_telephone"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{label:"ທີ່ຢູ່"},model:{value:t.transaction.customer_address,callback:function(e){t.$set(t.transaction,"customer_address",e)},expression:"transaction.customer_address"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(r.a,{attrs:{"item-text":"code","item-value":"id",items:t.currencyList,label:"ສະກຸນເງິນ*"},on:{input:t.currencyChange},model:{value:t.transaction.currencyId,callback:function(e){t.$set(t.transaction,"currencyId",e)},expression:"transaction.currencyId"}})],1)],1)],1),t._v(" "),e(f.a,{staticStyle:{"text-align":"end"},attrs:{cols:"4"}},[e(y.a,[e(f.a,{attrs:{cols:"12"}},[e(j.a,{attrs:{label:"Notes"},model:{value:t.transaction.remark,callback:function(e){t.$set(t.transaction,"remark",e)},expression:"transaction.remark"}})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{disabled:""},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",{staticStyle:{color:"black","font-weight":"bold"}},[t._v(t._s("Total Amount:\n                                                       ".concat(t.getFormatNum(t.grandTotal))))])]},proxy:!0}])})],1),t._v(" "),e(f.a,{attrs:{cols:"12"}},[e(k.a,{attrs:{disabled:"",label:"ອັດຕາແລກປ່ຽນ*"},model:{value:t.transaction.exchangeRate,callback:function(e){t.$set(t.transaction,"exchangeRate",e)},expression:"transaction.exchangeRate"}})],1)],1)],1)],1)],1)])],1),t._v(" "),e(m.a),t._v(" "),t.transaction.lines?e(x.a,{attrs:{headers:t.headers,search:t.search,items:t.transaction.lines},scopedSlots:t._u([{key:"item",fn:function(n){var o=n.item;return[e("tr",{style:t.errorLineNumber==t.transaction.lines.indexOf(o)?"outline: 1px solid red":""},[e("td",{class:t.errorLineNumber==t.transaction.lines.indexOf(o)?"error":""},[t._v("\n                               "+t._s(t.transaction.lines.indexOf(o)+1)+"\n                           ")]),t._v(" "),e("td",[e(r.a,{attrs:{"item-text":"pro_name","item-value":"id",items:t.productList,label:"ສິນຄ້າ*"},on:{input:function(e){return t.productChange(o)}},model:{value:o.productId,callback:function(e){t.$set(o,"productId",e)},expression:"item.productId"}})],1),t._v(" "),e("td",[e(k.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ຈຳນວນ",rules:[t.numberCommaRule]},on:{input:function(e){return t.quantityChange(o)}},model:{value:o.qty,callback:function(e){t.$set(o,"qty",e)},expression:"item.qty"}})],1),t._v(" "),e("td",[e(r.a,{attrs:{"item-text":"name","item-value":"id",items:t.unitList,label:"ຫົວຫນ່ວຍ*"},on:{input:function(e){return t.unitChange(o)}},model:{value:o.unitId,callback:function(e){t.$set(o,"unitId",e)},expression:"item.unitId"}})],1),t._v(" "),e("td",[e(k.a,{directives:[{name:"comma-thousand",rawName:"v-comma-thousand"}],attrs:{label:"ຈນ ຕໍ່ ຫົວຫນ່ວຍ",rules:[t.numberCommaRule]},on:{input:function(e){return t.unitRateChange(o)}},model:{value:o.rate,callback:function(e){t.$set(o,"rate",e)},expression:"item.rate"}})],1),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[e(v.a,{staticClass:"ml-0",attrs:{color:"warning",variant:"outlined"},on:{click:function(e){return t.pricingLogig(o)}}},[t._v("\n                                   "+t._s(t.getFormatNum(o.price))+"\n                               ")])],1),t._v(" "),e("td",{staticStyle:{"text-align":"right"}},[t._v("\n                               "+t._s(t.getFormatNum(o.total))+"\n                           ")]),t._v(" "),e("td",[e(l.a,{attrs:{disabled:!t.transaction.isActive||!t.updateAllow,color:"error",text:""},on:{click:function(e){return t.deleteItem(o)},keydown:t.handleKeyDown}},[e("i",{staticClass:"fas fa-trash"})])],1)])]}}],null,!1,1442914688)}):t._e(),t._v(" "),0==t.transaction.lines.length?e("tr",[e("td",[e(l.a,{staticClass:"primary",attrs:{size:"large",variant:"outlined",rounded:""},on:{click:t.newRow}},[e("span",{staticClass:"mdi mdi-plus"})])],1)]):t._e()],1),t._v(" "),e(d.a,[e(w.a),t._v(" "),e(l.a,{attrs:{color:"warning",rounded:"",variant:"text"},on:{click:t.toggleDialog}},[t._v("\n                   Close\n               ")]),t._v(" "),e(l.a,{attrs:{disabled:!t.transaction.isActive||!t.updateAllow,color:"primary",rounded:"",variant:"text"},on:{click:t.postTransaction}},[t._v("\n                   Save\n               ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default,CustomerList:n(269).default,CancelTicketForm:n(835).default,PricingOption:n(267).default})},814:function(t,e,n){var content=n(815);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(15).default)("c54b7bb4",content,!0,{sourceMap:!1})},815:function(t,e,n){var r=n(14)((function(i){return i[1]}));r.push([t.i,".theme--light.v-textarea.v-text-field--solo-inverted.v-input--is-focused textarea{color:#fff}.theme--light.v-textarea.v-text-field--solo-inverted.v-input--is-focused textarea::-moz-placeholder{color:hsla(0,0%,100%,.5)}.theme--light.v-textarea.v-text-field--solo-inverted.v-input--is-focused textarea::placeholder{color:hsla(0,0%,100%,.5)}.theme--dark.v-textarea.v-text-field--solo-inverted.v-input--is-focused textarea{color:rgba(0,0,0,.87)}.theme--dark.v-textarea.v-text-field--solo-inverted.v-input--is-focused textarea::-moz-placeholder{color:rgba(0,0,0,.38)}.theme--dark.v-textarea.v-text-field--solo-inverted.v-input--is-focused textarea::placeholder{color:rgba(0,0,0,.38)}.v-textarea textarea{align-self:stretch;flex:1 1 auto;line-height:1.75rem;max-width:100%;min-height:32px;outline:none;padding:0;width:100%}.v-textarea .v-text-field__prefix,.v-textarea .v-text-field__suffix{align-self:start;padding-top:2px}.v-textarea.v-text-field--box .v-text-field__prefix,.v-textarea.v-text-field--box textarea,.v-textarea.v-text-field--enclosed .v-text-field__prefix,.v-textarea.v-text-field--enclosed textarea{margin-top:24px}.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) textarea,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) textarea,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) textarea,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) textarea{margin-top:10px}.v-textarea.v-text-field--box.v-text-field--outlined:not(.v-input--dense) .v-label,.v-textarea.v-text-field--box.v-text-field--single-line:not(.v-input--dense) .v-label,.v-textarea.v-text-field--enclosed.v-text-field--outlined:not(.v-input--dense) .v-label,.v-textarea.v-text-field--enclosed.v-text-field--single-line:not(.v-input--dense) .v-label{top:18px}.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense textarea,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense textarea,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense textarea,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-text-field__prefix,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-text-field__suffix,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense textarea{margin-top:6px}.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--box.v-text-field--outlined.v-input--dense .v-input__prepend-outer,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--box.v-text-field--single-line.v-input--dense .v-input__prepend-outer,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--enclosed.v-text-field--outlined.v-input--dense .v-input__prepend-outer,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__append-inner,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__append-outer,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__prepend-inner,.v-textarea.v-text-field--enclosed.v-text-field--single-line.v-input--dense .v-input__prepend-outer{align-self:flex-start;margin-top:8px}.v-textarea.v-text-field--solo{align-items:flex-start}.v-textarea.v-text-field--solo .v-input__control textarea{caret-color:auto}.v-textarea.v-text-field--solo .v-input__append-inner,.v-textarea.v-text-field--solo .v-input__append-outer,.v-textarea.v-text-field--solo .v-input__prepend-inner,.v-textarea.v-text-field--solo .v-input__prepend-outer{align-self:flex-start;margin-top:12px}.v-application--is-ltr .v-textarea.v-text-field--solo .v-input__append-inner{padding-left:12px}.v-application--is-rtl .v-textarea.v-text-field--solo .v-input__append-inner{padding-right:12px}.v-textarea--auto-grow textarea{overflow:hidden}.v-textarea--no-resize textarea{resize:none}.v-textarea.v-text-field--enclosed .v-text-field__slot{align-self:stretch}.v-application--is-ltr .v-textarea.v-text-field--enclosed .v-text-field__slot{margin-right:-12px}.v-application--is-rtl .v-textarea.v-text-field--enclosed .v-text-field__slot{margin-left:-12px}.v-application--is-ltr .v-textarea.v-text-field--enclosed .v-text-field__slot textarea{padding-right:12px}.v-application--is-rtl .v-textarea.v-text-field--enclosed .v-text-field__slot textarea{padding-left:12px}",""]),r.locals={},t.exports=r},820:function(t,e,n){"use strict";var r=n(33).isFinite;t.exports=Number.isFinite||function(t){return"number"==typeof t&&r(t)}},821:function(t,e,n){var content=n(822);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(15).default)("73bba828",content,!0,{sourceMap:!1})},822:function(t,e,n){var r=n(14)((function(i){return i[1]}));r.push([t.i,".bottom-sheet-transition-enter,.bottom-sheet-transition-leave-to{transform:translateY(100%)}.v-bottom-sheet.v-dialog{align-self:flex-end;border-radius:0;flex:0 1 auto;margin:0;overflow:visible}.v-bottom-sheet.v-dialog.v-bottom-sheet--inset{max-width:70%}@media only screen and (max-width:599.98px){.v-bottom-sheet.v-dialog.v-bottom-sheet--inset{max-width:none}}",""]),r.locals={},t.exports=r},828:function(t,e,n){"use strict";n(10),n(7),n(9),n(5),n(12),n(8),n(13);var r=n(3),o=(n(24),n(62),n(814),n(112)),l=n(6);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var d=Object(l.a)(o.a);e.a=d.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},o.a.options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{autoGrow:function(t){var e=this;this.$nextTick((function(){var n;t?e.calculateInputHeight():null===(n=e.$refs.input)||void 0===n||n.style.removeProperty("height")}))},lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var input=this.$refs.input;if(input){input.style.height="0";var t=input.scrollHeight,e=parseInt(this.rows,10)*parseFloat(this.rowHeight);input.style.height=Math.max(e,t)+"px"}},genInput:function(){var input=o.a.options.methods.genInput.call(this);return input.tag="textarea",delete input.data.attrs.type,input.data.attrs.rows=this.rows,input},onInput:function(t){o.a.options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}})},831:function(t,e,n){"use strict";n(11)({target:"Number",stat:!0},{isFinite:n(820)})},835:function(t,e,n){"use strict";n.r(e);var r=n(321),o=n(318),l=n(19),c=n(771),d=n(798),v=n(794),f=n(112),x=n(17),h=(n(85),n(24),n(5),n(68),n(37)),m={props:{id:{type:Number,require:!1},customerId:{type:Number,require:!1,default:null}},data:function(){return{isLoading:!1,form:{isActive:!1,remark:"",cancel_fee:0},nameRules:[function(t){return!!t||"ກະລຸນາ ໃສ່ເຫດຜົນ"},function(t){return t.toString().length<=100||"Reason must be less than 100 characters"}]}},computed:{user:function(){return this.$auth.user||""}},methods:{submitForm:function(){var t=this;return Object(x.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.myform.validate()||t.isLoading){e.next=17;break}return t.isLoading=!0,e.prev=2,t.form.customerId=t.customerId,console.log("".concat(JSON.stringify(t.form))),e.next=7,t.$axios.put("api/sale/reverse/".concat(t.id),t.form);case 7:(e.sent.status=200)&&(t.refreshData(),Object(h.k)(t.$swal,"Succeed","ດຳເນີນການສຳເລັດ")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),Object(h.j)(t.$swal,"Error","Something went wrong "+e.t0);case 14:t.isLoading=!1,e.next=18;break;case 17:return e.abrupt("return");case 18:t.isLoading=!1;case 19:case"end":return e.stop()}}),e,null,[[2,11]])})))()},refreshData:function(){this.$emit("reload-data")}}},_=n(31),component=Object(_.a)(m,(function(){var t=this,e=t._self._c;return e("div",[e(c.a,{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[e("loading-indicator")],1),t._v(" "),e(o.a,{staticClass:"pa-4"},[t._v("\n        ຍົກເລີກບິນ\n        "),e(d.a,{ref:"myform",on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e(f.a,{attrs:{disabled:"",label:"ເລກທີອໍເດີ "},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}}),t._v(" "),e(f.a,{attrs:{label:"ເຫດຜົນການຍົກເລີກ",rules:t.nameRules},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}}),t._v(" "),e(f.a,{attrs:{label:"ຄ່າທຳນຽມ"},model:{value:t.form.cancel_fee,callback:function(e){t.$set(t.form,"cancel_fee",e)},expression:"form.cancel_fee"}})],1),t._v(" "),e(l.a,[e(v.a),t._v(" "),e(r.a,{staticClass:"warning",attrs:{text:"",rounded:""},on:{click:function(e){return t.$emit("close-dialog")}}},[t._v("\n                ປິດ\n            ")]),t._v(" "),e(r.a,{staticClass:"primary",attrs:{text:"",rounded:""},on:{click:t.submitForm}},[t._v("\n                ຢືນຢັນ\n            ")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LoadingIndicator:n(248).default})},853:function(t,e,n){"use strict";n(10),n(7),n(9),n(5),n(12),n(8),n(13);var r=n(3),o=(n(24),n(821),n(771));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}e.a=o.a.extend({name:"v-bottom-sheet",props:{inset:Boolean,maxWidth:[String,Number],transition:{type:String,default:"bottom-sheet-transition"}},computed:{classes:function(){return c(c({},o.a.options.computed.classes.call(this)),{},{"v-bottom-sheet":!0,"v-bottom-sheet--inset":this.inset})}}})},855:function(t,e,n){"use strict";n(34),n(75);e.a={bind:function(t,e,n){t.addEventListener("input",(function(t){var e=t.target.value.replace(/[^0-9]/g,"");"NaN"===(e=parseInt(e,10).toLocaleString("en-US"))&&(e="0"),n.componentInstance.$emit("input",e)}))}}}}]);