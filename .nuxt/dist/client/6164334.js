(window.webpackJsonp=window.webpackJsonp||[]).push([[216,286],{1248:function(t,e,n){var content=n(1553);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(16).default)("7b7c18b2",content,!0,{sourceMap:!1})},1552:function(t,e,n){"use strict";n(1248)},1553:function(t,e,n){var r=n(15)((function(i){return i[1]}));r.push([t.i,".money-advance-report[data-v-2ad3a22c]{padding:0}.report-header[data-v-2ad3a22c]{align-items:center;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:8px;color:#fff;display:flex;justify-content:space-between;margin-bottom:24px;padding:20px}.title-section h1[data-v-2ad3a22c]{font-size:28px;font-weight:600;margin:0}.title-section p[data-v-2ad3a22c]{font-size:14px;margin:5px 0 0;opacity:.9}.action-buttons[data-v-2ad3a22c]{display:flex;gap:12px}.action-buttons .v-btn[data-v-2ad3a22c]{color:#fff!important}.filter-card[data-v-2ad3a22c]{background:#fff}.filter-title[data-v-2ad3a22c]{background:#f8f9fa;color:#495057;font-weight:600}.filter-actions[data-v-2ad3a22c]{align-items:center;display:flex;gap:12px;margin-top:20px}.summary-cards[data-v-2ad3a22c]{margin-bottom:24px}.summary-card[data-v-2ad3a22c]{height:160px;overflow:hidden;position:relative}.summary-content[data-v-2ad3a22c]{align-items:center;display:flex;height:100%}.summary-icon[data-v-2ad3a22c]{font-size:48px;margin-right:16px;opacity:.8}.summary-details h3[data-v-2ad3a22c]{color:#fff;font-size:16px;font-weight:600;margin:0}.summary-details p[data-v-2ad3a22c]{color:#fff;font-size:12px;margin:4px 0}.summary-details h2[data-v-2ad3a22c]{font-size:24px;font-weight:700;margin:8px 0 0}.summary-lcy[data-v-2ad3a22c]{font-size:11px;margin-top:4px!important;opacity:.8}.advance-card[data-v-2ad3a22c],.brought-forward-card[data-v-2ad3a22c],.outstanding-card[data-v-2ad3a22c],.settlement-card[data-v-2ad3a22c]{background:linear-gradient(135deg,#01532b,#01532b);color:#fff}.additional-summary[data-v-2ad3a22c]{margin-bottom:24px}.stats-card[data-v-2ad3a22c]{height:100px}.stats-number[data-v-2ad3a22c]{font-size:24px;font-weight:700;margin:0}.stats-label[data-v-2ad3a22c]{font-size:11px;line-height:1.2;margin:4px 0 0}.currency-breakdown-card[data-v-2ad3a22c]{margin-bottom:24px}.currency-summary h4[data-v-2ad3a22c]{border-bottom:1px solid #e0e0e0;color:#495057;margin:0 0 12px;padding-bottom:8px}.currency-details p[data-v-2ad3a22c]{font-size:13px;margin:4px 0}.chart-card[data-v-2ad3a22c]{margin-bottom:24px}.chart-container[data-v-2ad3a22c]{height:300px;position:relative}.table-card[data-v-2ad3a22c]{margin-bottom:24px}.table-title[data-v-2ad3a22c]{background:#f8f9fa;color:#495057;font-weight:600}.search-field[data-v-2ad3a22c]{max-width:300px}.report-table[data-v-2ad3a22c]{background:#fff}.date-cell[data-v-2ad3a22c]{font-family:monospace;font-size:13px}.amount-cell[data-v-2ad3a22c]{font-weight:600;text-align:right}.amount-cell[data-v-2ad3a22c],.exchange-rate-cell[data-v-2ad3a22c]{display:block;font-family:monospace}.exchange-rate-cell[data-v-2ad3a22c]{font-size:12px;text-align:center}.advance-amount[data-v-2ad3a22c]{color:#667eea}.settlement-amount[data-v-2ad3a22c]{color:#28a745}.outstanding-amount[data-v-2ad3a22c]{color:#dc3545}.lcy-amount[data-v-2ad3a22c]{color:#6f42c1}.settlement-progress[data-v-2ad3a22c]{width:100%}.progress-text[data-v-2ad3a22c]{color:#fff;font-size:11px;font-weight:600;text-shadow:1px 1px 1px rgba(0,0,0,.5)}.ministry-cell[data-v-2ad3a22c]{display:flex;flex-direction:column}.ministry-name[data-v-2ad3a22c]{font-size:13px;font-weight:600}.ministry-code[data-v-2ad3a22c]{color:#666;font-family:monospace;font-size:11px}.detail-item[data-v-2ad3a22c]{font-size:14px;margin-bottom:12px}.detail-item strong[data-v-2ad3a22c]{color:#495057}.settlement-table[data-v-2ad3a22c]{margin-top:16px}@media print{.action-buttons[data-v-2ad3a22c],.filter-card[data-v-2ad3a22c],.v-btn[data-v-2ad3a22c]{display:none!important}.additional-summary[data-v-2ad3a22c],.chart-card[data-v-2ad3a22c],.currency-breakdown-card[data-v-2ad3a22c],.summary-cards[data-v-2ad3a22c]{page-break-inside:avoid}}@media (max-width:768px){.report-header[data-v-2ad3a22c]{gap:16px}.report-header[data-v-2ad3a22c],.summary-content[data-v-2ad3a22c]{flex-direction:column;text-align:center}.summary-icon[data-v-2ad3a22c]{color:#fff;margin-bottom:8px;margin-right:0}.chart-container[data-v-2ad3a22c]{height:250px}.filter-actions[data-v-2ad3a22c]{flex-direction:column;width:100%}.filter-actions .v-btn[data-v-2ad3a22c]{width:100%}.stats-card[data-v-2ad3a22c]{height:80px}.stats-number[data-v-2ad3a22c]{font-size:18px}.stats-label[data-v-2ad3a22c]{font-size:10px}}",""]),r.locals={},t.exports=r},1740:function(t,e,n){"use strict";n.r(e);var r=n(316),o=n(313),c=n(18),l=n(317),d=n(780),m=n(789),v=n(1625),f=n(754),y=n(312),_=n(167),h=n(318),x=n(252),C=n(314),k=n(779),w=n(65),A=n(433),D=n(777),R=n(113),S=(n(5),n(34),n(131),n(31)),L=n(33),N=n(20),T=(n(254),n(54),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(53),n(823),n(824),n(825),n(826),n(827),n(828),n(829),n(830),n(831),n(832),n(833),n(834),n(835),n(836),n(837),n(838),n(839),n(8),n(250),n(69),n(44),n(10),n(102),n(30),n(818),n(446),n(209),n(92),n(891)),E={name:"MoneyAdvanceReport",data:function(){return{bankAccountSummaryReport:[],bankAccountTotals:{currencyTotals:{},totalLakEquivalent:0},bankAccountCurrencyList:[],loadingBankAccountReport:!1,ministrySummaryReport:[],ministryTotals:{currencyTotals:{},totalLakEquivalent:0},currencyList:[],loadingMinistryReport:!1,loading:!1,exporting:!1,loadingSettlements:!1,search:"",fromDateMenu:!1,toDateMenu:!1,detailsDialog:!1,settlementsDialog:!1,selectedItem:null,settlements:[],filters:{fromDate:null,toDate:null,ministryId:null,currencyId:null,status:null,makerId:null},ministries:[],currencies:[],users:[],statusOptions:[{text:"ລໍຖ້າອະນຸມັດ (Pending)",value:"pending"},{text:"ອະນຸມັດແລ້ວ (Approved)",value:"approved"},{text:"ຊຳລະແລ້ວ (Settled)",value:"settled"}],reportData:[],summaryData:{totalAdvances:0,totalSettlements:0,outstandingBalance:0,broughtForward:0,totalAdvancesLcy:0,totalSettlementsLcy:0,outstandingBalanceLcy:0,broughtForwardLcy:0,totalRecords:0,fullySettledCount:0,partiallySettledCount:0,unsettledCount:0,overdueCount:0,averageSettlementPercentage:0,currencyBreakdown:[]},ministryChart:null,trendChart:null,tableHeaders:[{text:"ວັນທີ",value:"bookingDate",width:"100px"},{text:"ຈຳນວນເງິນ",value:"amount",width:"120px"},{text:"ສະກຸນເງິນ",value:"currencyCode",width:"80px"},{text:"ອັດຕາແລກປ່ຽນ",value:"exchangeRate",width:"100px"},{text:"ເທົ່າກັບກີບ",value:"lcyEquivalent",width:"120px"},{text:"ການຊຳລະ",value:"settlementAmount",width:"120px"},{text:"ຍອດຄ້າງ",value:"outstandingAmount",width:"120px"},{text:"% ຊຳລະ",value:"settlementPercentage",width:"100px"},{text:"ກະຊວງ",value:"ministry",width:"150px"},{text:"ຈຸດປະສົງ",value:"purpose",width:"200px"},{text:"ສະຖານະ",value:"status",width:"100px"},{text:"ເກີນກຳນົດ",value:"daysOverdue",width:"80px"},{text:"ຜູ້ລົງ",value:"maker.cus_name",width:"120px"},{text:"ຈັດການ",value:"actions",sortable:!1,width:"100px"}],settlementHeaders:[{text:"ວັນທີ",value:"bookingDate"},{text:"ຈຳນວນ",value:"amount"},{text:"ວິທີການ",value:"method"},{text:"ໝາຍເຫດ",value:"notes"},{text:"ຜູ້ດຳເນີນການ",value:"user.cus_name"}]}},created:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadInitialData();case 2:return t.setDefaultDates(),e.next=5,t.applyFilters();case 5:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;this.$nextTick((function(){t.initializeCharts()}))},beforeDestroy:function(){this.ministryChart&&this.ministryChart.destroy(),this.trendChart&&this.trendChart.destroy()},methods:{processBankAccountReportData:function(t){if(!t||!t.data||!Array.isArray(t.data))return{bankAccountSummaryReport:[],bankAccountTotals:{currencyTotals:{},totalLakEquivalent:0},bankAccountCurrencyList:[]};var data=t.data,e=new Map,n=new Set,r={};data.forEach((function(t){var o=t.bankAccount,c=t.currency,l=t.settlementAmount||0,d=t.settlementLcyEquivalent||0,m=t.settlementCount||0,v=(null==o?void 0:o.id)||"NO_BANK_ACCOUNT",f=(null==o?void 0:o.accountNumber)||"N/A",y=(null==o?void 0:o.accountName)||"No Bank Account",_=(null==o?void 0:o.bankName)||"No Bank Specified",h=(null==o?void 0:o.accountType)||"N/A",x=(null==c?void 0:c.code)||"UNKNOWN";n.add(x),e.has(v)||e.set(v,{bankAccountId:v,accountNumber:f,accountName:y,bankName:_,accountType:h,settlementCount:0,amounts:{},totalLakEquivalent:0});var C=e.get(v);C.settlementCount+=m,C.totalLakEquivalent+=d,C.amounts[x]||(C.amounts[x]=0),C.amounts[x]+=l,r[x]||(r[x]=0),r[x]+=l}));var o=Array.from(e.values()).sort((function(a,b){if("NO_BANK_ACCOUNT"===a.bankAccountId)return 1;if("NO_BANK_ACCOUNT"===b.bankAccountId)return-1;var t=a.bankName.localeCompare(b.bankName);return 0!==t?t:a.accountNumber.localeCompare(b.accountNumber)})),c=o.reduce((function(t,e){return t+e.totalLakEquivalent}),0);return{bankAccountSummaryReport:o,bankAccountTotals:{currencyTotals:r,totalLakEquivalent:c},bankAccountCurrencyList:Array.from(n).sort()}},refreshBankAccountReport:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loadingBankAccountReport=!0;try{n=t.processBankAccountReportData({data:t.reportData}),t.bankAccountSummaryReport=n.bankAccountSummaryReport,t.bankAccountTotals=n.bankAccountTotals,t.bankAccountCurrencyList=n.bankAccountCurrencyList,t.$toast.success("Bank account report refreshed successfully")}catch(e){console.error("Error refreshing bank account report:",e),t.$toast.error("Failed to refresh bank account report")}finally{t.loadingBankAccountReport=!1}case 2:case"end":return e.stop()}}),e)})))()},exportBankAccountReportToExcel:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.bankAccountSummaryReport.length){e.next=3;break}return t.$toast.warning("No bank account data to export"),e.abrupt("return");case 3:return t.exporting=!0,e.prev=4,r=t.bankAccountSummaryReport.map((function(e,n){var r={"#":n+1,"Account Number":e.accountNumber,"Account Name":e.accountName,"Bank Name":e.bankName,"Account Type":e.accountType,Count:e.settlementCount};return t.bankAccountCurrencyList.forEach((function(n){var o;r[n]=t.formatAmount((null===(o=e.amounts)||void 0===o?void 0:o[n])||0)})),r["Total (LAK)"]=t.formatAmount(e.totalLakEquivalent||0),r})),o={"#":"","Account Number":"","Account Name":"","Bank Name":"ລວມ (Total)","Account Type":"",Count:t.bankAccountSummaryReport.reduce((function(t,b){return t+b.settlementCount}),0)},t.bankAccountCurrencyList.forEach((function(e){var n,r;o[e]=t.formatAmount((null===(n=t.bankAccountTotals)||void 0===n||null===(r=n.currencyTotals)||void 0===r?void 0:r[e])||0)})),o["Total (LAK)"]=t.formatAmount((null===(n=t.bankAccountTotals)||void 0===n?void 0:n.totalLakEquivalent)||0),r.push(o),e.next=12,t.exportToExcelBankAccount(r,"Bank_Account_Report");case 12:t.$toast.success("Bank account report exported successfully"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.error("Error exporting bank account report:",e.t0),t.$toast.error("Failed to export bank account report");case 19:return e.prev=19,t.exporting=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,15,19,22]])})))()},exportToExcelBankAccount:function(data,t){return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o,link,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==data.length){e.next=2;break}return e.abrupt("return");case 2:n=Object.keys(data[0]),r=[n.join(",")].concat(Object(L.a)(data.map((function(t){return n.map((function(header){return'"'.concat(t[header]||"",'"')})).join(",")})))).join("\n"),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),link=document.createElement("a"),c=URL.createObjectURL(o),link.setAttribute("href",c),link.setAttribute("download","".concat(t,"-").concat((new Date).toISOString().substr(0,10),".csv")),link.style.visibility="hidden",document.body.appendChild(link),link.click(),document.body.removeChild(link),URL.revokeObjectURL(c);case 14:case"end":return e.stop()}}),e)})))()},processMinistryReportData:function(t){if(!t||!t.data||!Array.isArray(t.data))return{ministrySummaryReport:[],ministryTotals:{currencyTotals:{},totalLakEquivalent:0},currencyList:[]};var data=t.data,e=new Map,n=new Set,r={};data.forEach((function(t){var o=t.ministry,c=t.currency,l=t.settlementAmount||0,d=t.settlementLcyEquivalent||0,m=t.settlementCount||0,v=(null==o?void 0:o.id)||"NO_MINISTRY",f=(null==o?void 0:o.ministryCode)||"N/A",y=(null==o?void 0:o.ministryName)||"No Ministry Assigned",_=(null==c?void 0:c.code)||"UNKNOWN";n.add(_),e.has(v)||e.set(v,{ministryId:v,ministryCode:f,ministryName:y,settlementCount:0,amounts:{},totalLakEquivalent:0});var h=e.get(v);h.settlementCount+=m,h.totalLakEquivalent+=d,h.amounts[_]||(h.amounts[_]=0),h.amounts[_]+=l,r[_]||(r[_]=0),r[_]+=l}));var o=Array.from(e.values()).sort((function(a,b){return"NO_MINISTRY"===a.ministryId?1:"NO_MINISTRY"===b.ministryId?-1:a.ministryCode.localeCompare(b.ministryCode)})),c=o.reduce((function(t,e){return t+e.totalLakEquivalent}),0);return{ministrySummaryReport:o,ministryTotals:{currencyTotals:r,totalLakEquivalent:c},currencyList:Array.from(n).sort()}},refreshMinistryReport:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loadingMinistryReport=!0;try{n=t.processMinistryReportData({data:t.reportData}),t.ministrySummaryReport=n.ministrySummaryReport,t.ministryTotals=n.ministryTotals,t.currencyList=n.currencyList,t.$toast.success("Ministry report refreshed successfully")}catch(e){console.error("Error refreshing ministry report:",e),t.$toast.error("Failed to refresh ministry report")}finally{t.loadingMinistryReport=!1}case 2:case"end":return e.stop()}}),e)})))()},exportMinistryReportToExcel:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ministrySummaryReport.length){e.next=3;break}return t.$toast.warning("No data to export"),e.abrupt("return");case 3:return t.exporting=!0,e.prev=4,r=t.ministrySummaryReport.map((function(e,n){var r={"#":n+1,"Ministry Code":e.ministryCode,"Ministry Name":e.ministryName,Count:e.settlementCount};return t.currencyList.forEach((function(n){var o;r[n]=t.formatAmount((null===(o=e.amounts)||void 0===o?void 0:o[n])||0)})),r["Total (LAK)"]=t.formatAmount(e.totalLakEquivalent||0),r})),o={"#":"","Ministry Code":"","Ministry Name":"ລວມ (Total)",Count:t.ministrySummaryReport.reduce((function(t,e){return t+e.settlementCount}),0)},t.currencyList.forEach((function(e){var n,r;o[e]=t.formatAmount((null===(n=t.ministryTotals)||void 0===n||null===(r=n.currencyTotals)||void 0===r?void 0:r[e])||0)})),o["Total (LAK)"]=t.formatAmount((null===(n=t.ministryTotals)||void 0===n?void 0:n.totalLakEquivalent)||0),r.push(o),e.next=12,t.exportToExcelMinistry(r,"Ministry_Report");case 12:t.$toast.success("Ministry report exported successfully"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),console.error("Error exporting ministry report:",e.t0),t.$toast.error("Failed to export ministry report");case 19:return e.prev=19,t.exporting=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,15,19,22]])})))()},exportToExcelMinistry:function(data,t){return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o,link,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==data.length){e.next=2;break}return e.abrupt("return");case 2:n=Object.keys(data[0]),r=[n.join(",")].concat(Object(L.a)(data.map((function(t){return n.map((function(header){return'"'.concat(t[header]||"",'"')})).join(",")})))).join("\n"),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),link=document.createElement("a"),c=URL.createObjectURL(o),link.setAttribute("href",c),link.setAttribute("download","".concat(t,"-").concat((new Date).toISOString().substr(0,10),".csv")),link.style.visibility="hidden",document.body.appendChild(link),link.click(),document.body.removeChild(link),URL.revokeObjectURL(c);case 14:case"end":return e.stop()}}),e)})))()},loadInitialData:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.$axios.get("/api/ministries"),t.$axios.get("/api/currency/find"),t.$axios.get("/api/user/find")]);case 3:n=e.sent,r=Object(S.a)(n,3),o=r[0],c=r[1],l=r[2],t.ministries=o.data.data||o.data,t.currencies=c.data.data||c.data,t.users=l.data.data||l.data,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error loading initial data:",e.t0),t.$toast.error("Error loading initial data");case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))()},setDefaultDates:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);this.filters.fromDate=e.toISOString().substr(0,10),this.filters.toDate=t.toISOString().substr(0,10)},applyFilters:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,n=new URLSearchParams,Object.keys(t.filters).forEach((function(e){t.filters[e]&&n.append(e,t.filters[e])})),e.next=6,t.$axios.get("/api/money-advances/report?".concat(n));case 6:(r=e.sent).data.success?(t.reportData=r.data.data||[],t.summaryData=r.data.summary||{}):(t.reportData=r.data.data||r.data||[],t.summaryData=r.data.summary||t.calculateSummary()),o=t.processMinistryReportData({data:t.reportData}),t.ministrySummaryReport=o.ministrySummaryReport,t.ministryTotals=o.ministryTotals,t.currencyList=o.currencyList,c=t.processBankAccountReportData({data:t.reportData}),t.bankAccountSummaryReport=c.bankAccountSummaryReport,t.bankAccountTotals=c.bankAccountTotals,t.bankAccountCurrencyList=c.bankAccountCurrencyList,t.$nextTick((function(){t.updateCharts()})),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.error("Error loading report data:",e.t0),t.$toast.error("Error loading report data");case 23:return e.prev=23,t.loading=!1,e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[1,19,23,26]])})))()},resetFilters:function(){this.filters={fromDate:null,toDate:null,ministryId:null,currencyId:null,status:null,makerId:null},this.setDefaultDates(),this.applyFilters()},calculateSummary:function(){var summary={totalAdvances:0,totalSettlements:0,outstandingBalance:0,totalRecords:this.reportData.length,fullySettledCount:0,partiallySettledCount:0,unsettledCount:0,overdueCount:0};return this.reportData.forEach((function(t){summary.totalAdvances+=parseFloat(t.amount||0),summary.totalSettlements+=parseFloat(t.settlementAmount||0),summary.outstandingBalance+=parseFloat(t.outstandingAmount||0),t.isFullySettled?summary.fullySettledCount++:t.settlementAmount>0?summary.partiallySettledCount++:summary.unsettledCount++,t.daysOverdue>0&&summary.overdueCount++})),summary},initializeCharts:function(){this.$refs.ministryChart&&this.$refs.trendChart&&(this.createMinistryChart(),this.createTrendChart())},createMinistryChart:function(){var t=this.$refs.ministryChart.getContext("2d");this.ministryChart&&this.ministryChart.destroy(),this.ministryChart=new T.default(t,{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#FF6384","#C9CBCF"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})},createTrendChart:function(){var t=this.$refs.trendChart.getContext("2d");this.trendChart&&this.trendChart.destroy(),this.trendChart=new T.default(t,{type:"line",data:{labels:[],datasets:[{label:"ລາຍຈ່າຍລ່ວງໜ້າ",data:[],borderColor:"#36A2EB",backgroundColor:"rgba(54, 162, 235, 0.1)",tension:.1},{label:"ການຊຳລະ",data:[],borderColor:"#4BC0C0",backgroundColor:"rgba(75, 192, 192, 0.1)",tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})},updateCharts:function(){if(this.ministryChart&&this.trendChart){var t=this.groupByMinistry();this.ministryChart.data.labels=t.labels,this.ministryChart.data.datasets[0].data=t.data,this.ministryChart.update();var e=this.groupByMonth();this.trendChart.data.labels=e.labels,this.trendChart.data.datasets[0].data=e.advances,this.trendChart.data.datasets[1].data=e.settlements,this.trendChart.update()}},groupByMinistry:function(){var t={};return this.reportData.forEach((function(e){var n,r=(null===(n=e.ministry)||void 0===n?void 0:n.ministryName)||"ບໍ່ລະບຸກະຊວງ";t[r]||(t[r]=0),t[r]+=parseFloat(e.lcyEquivalent||e.amount||0)})),{labels:Object.keys(t),data:Object.values(t)}},groupByMonth:function(){var t={};this.reportData.forEach((function(e){var n=new Date(e.bookingDate).toISOString().substr(0,7);t[n]||(t[n]={advances:0,settlements:0}),t[n].advances+=parseFloat(e.lcyEquivalent||e.amount||0),t[n].settlements+=parseFloat(e.settlementLcyEquivalent||e.settlementAmount||0)}));var e=Object.keys(t).sort();return{labels:e,advances:e.map((function(e){return t[e].advances})),settlements:e.map((function(e){return t[e].settlements}))}},viewDetails:function(t){var e=this;return Object(N.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.selectedItem=t,e.detailsDialog=!0;case 2:case"end":return n.stop()}}),n)})))()},viewSettlements:function(t){var e=this;return Object(N.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.loadingSettlements=!0,e.settlementsDialog=!0,n.prev=2,n.next=5,e.$axios.get("/api/money-advances/".concat(t.id,"/settlements"));case 5:r=n.sent,e.settlements=r.data.data||r.data||[],n.next=14;break;case 9:n.prev=9,n.t0=n.catch(2),console.error("Error loading settlements:",n.t0),e.$toast.error("Error loading settlements"),e.settlements=[];case 14:return n.prev=14,e.loadingSettlements=!1,n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[2,9,14,17]])})))()},exportToExcel:function(){var t=this;return Object(N.a)(regeneratorRuntime.mark((function e(){var n,r,o,link;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.exporting=!0,e.prev=1,n=new URLSearchParams,Object.keys(t.filters).forEach((function(e){t.filters[e]&&n.append(e,t.filters[e])})),e.next=6,t.$axios.get("/api/money-advances/report/export?".concat(n),{responseType:"blob"});case 6:r=e.sent,o=new Blob([r.data]),(link=document.createElement("a")).href=window.URL.createObjectURL(o),link.download="money-advance-report-".concat((new Date).toISOString().substr(0,10),".xlsx"),link.click(),window.URL.revokeObjectURL(link.href),t.$toast.success("Report exported successfully"),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.error("Error exporting report:",e.t0),t.$toast.error("Error exporting report");case 20:return e.prev=20,t.exporting=!1,e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[1,16,20,23]])})))()},printReport:function(){window.print()},formatAmount:function(t){return t&&0!==t?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}).format(t):"0"},formatCurrency:function(t){return t||0===t?new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t):"0.00"},formatExchangeRate:function(t){return t||0===t?new Intl.NumberFormat("en-US",{minimumFractionDigits:4,maximumFractionDigits:4}).format(t):"1.0000"},formatDate:function(t){return t?new Date(t).toLocaleDateString("lo-LA"):""},getProgressColor:function(t){var e=parseFloat(t||0);return e>=100?"green":e>=50?"orange":"red"},getStatusColor:function(t){return{pending:"orange",approved:"blue",settled:"green"}[t]||"grey"},getStatusText:function(t){return{pending:"ລໍຖ້າ",approved:"ອະນຸມັດ",settled:"ຊຳລະແລ້ວ"}[t]||t},getMethodColor:function(t){return{cash:"green",bank_transfer:"blue",deduction:"orange"}[t]||"grey"},getMethodText:function(t){return{cash:"ເງິນສົດ",bank_transfer:"ໂອນເງິນ",deduction:"ຫັກລົບ"}[t]||t}}},I=(n(1552),n(32)),component=Object(I.a)(E,(function(){var t,e,n=this,S=n._self._c;return S("div",{staticClass:"money-advance-report"},[S("div",{staticClass:"report-header"},[n._m(0),n._v(" "),S("div",{staticClass:"action-buttons"},[S(r.a,{attrs:{color:"success",loading:n.exporting},on:{click:n.exportToExcel}},[S("i",{staticClass:"fas fa-file-excel"}),n._v("\n        Export Excel\n      ")]),n._v(" "),S(r.a,{attrs:{color:"primary"},on:{click:n.printReport}},[S("i",{staticClass:"fas fa-print"}),n._v("\n        Print\n      ")])],1)]),n._v(" "),S(o.a,{staticClass:"filter-card mb-4",attrs:{elevation:"2"}},[S(c.d,{staticClass:"filter-title"},[S("i",{staticClass:"fas fa-filter"}),n._v("\n      ຕົວກອງ (Filters)\n    ")]),n._v(" "),S(c.c,[S(k.a,[S(d.a,{attrs:{cols:"12",md:"3"}},[S(h.a,{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:n._u([{key:"activator",fn:function(t){var e=t.on,r=t.attrs;return[S(R.a,n._g(n._b({attrs:{label:"ຈາກວັນທີ (From Date)","prepend-icon":"mdi-calendar",readonly:""},model:{value:n.filters.fromDate,callback:function(t){n.$set(n.filters,"fromDate",t)},expression:"filters.fromDate"}},"v-text-field",r,!1),e))]}}]),model:{value:n.fromDateMenu,callback:function(t){n.fromDateMenu=t},expression:"fromDateMenu"}},[n._v(" "),S(v.a,{on:{input:function(t){n.fromDateMenu=!1}},model:{value:n.filters.fromDate,callback:function(t){n.$set(n.filters,"fromDate",t)},expression:"filters.fromDate"}})],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(h.a,{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:n._u([{key:"activator",fn:function(t){var e=t.on,r=t.attrs;return[S(R.a,n._g(n._b({attrs:{label:"ຫາວັນທີ (To Date)","prepend-icon":"mdi-calendar",readonly:""},model:{value:n.filters.toDate,callback:function(t){n.$set(n.filters,"toDate",t)},expression:"filters.toDate"}},"v-text-field",r,!1),e))]}}]),model:{value:n.toDateMenu,callback:function(t){n.toDateMenu=t},expression:"toDateMenu"}},[n._v(" "),S(v.a,{on:{input:function(t){n.toDateMenu=!1}},model:{value:n.filters.toDate,callback:function(t){n.$set(n.filters,"toDate",t)},expression:"filters.toDate"}})],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(w.a,{attrs:{items:n.ministries,"item-text":"ministryName","item-value":"id",label:"ກະຊວງ (Ministry)","prepend-icon":"mdi-office-building",clearable:""},model:{value:n.filters.ministryId,callback:function(t){n.$set(n.filters,"ministryId",t)},expression:"filters.ministryId"}})],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(w.a,{attrs:{items:n.currencies,"item-text":"name","item-value":"id",label:"ສະກຸນເງິນ (Currency)","prepend-icon":"mdi-currency-usd",clearable:""},model:{value:n.filters.currencyId,callback:function(t){n.$set(n.filters,"currencyId",t)},expression:"filters.currencyId"}})],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(w.a,{attrs:{items:n.statusOptions,"item-text":"text","item-value":"value",label:"ສະຖານະ (Status)","prepend-icon":"mdi-flag",clearable:""},model:{value:n.filters.status,callback:function(t){n.$set(n.filters,"status",t)},expression:"filters.status"}})],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(w.a,{attrs:{items:n.users,"item-text":"cus_name","item-value":"id",label:"ຜູ້ລົງບັນທຶກ (Maker)","prepend-icon":"mdi-account",clearable:""},model:{value:n.filters.makerId,callback:function(t){n.$set(n.filters,"makerId",t)},expression:"filters.makerId"}})],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"6"}},[S("div",{staticClass:"filter-actions"},[S(r.a,{attrs:{color:"primary",loading:n.loading},on:{click:n.applyFilters}},[S("i",{staticClass:"fas fa-search"}),n._v("\n              ຄົ້ນຫາ\n            ")]),n._v(" "),S(r.a,{attrs:{color:"secondary"},on:{click:n.resetFilters}},[S("i",{staticClass:"fas fa-undo"}),n._v("\n              ຣີເຊັດ\n            ")])],1)])],1)],1)],1),n._v(" "),S(k.a,{staticClass:"mb-4",attrs:{dense:""}},[S(d.a,{attrs:{cols:"12",md:"3"}},[S(o.a,{staticClass:"pa-4",attrs:{color:"blue lighten-5",elevation:"2"}},[S(k.a,{attrs:{align:"center"}},[S(d.a,{attrs:{cols:"3"}},[S(_.a,{attrs:{large:"",color:"blue darken-2"}},[n._v("mdi-cash")])],1),n._v(" "),S(d.a,{attrs:{cols:"9"}},[S("div",{staticClass:"text-subtitle-1 font-weight-bold"},[n._v("ລວມລາຍຈ່າຍ")]),n._v(" "),S("div",{staticClass:"caption mb-1"},[n._v("Total Advances")]),n._v(" "),S("div",{staticClass:"text-h6 font-weight-bold"},[n._v("\n              "+n._s(n.formatCurrency(n.summaryData.totalAdvances))+"\n            ")]),n._v(" "),n.summaryData.totalAdvancesLcy?S("div",{staticClass:"caption"},[n._v("\n              LCY: "+n._s(n.formatCurrency(n.summaryData.totalAdvancesLcy))+"\n            ")]):n._e()])],1)],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(o.a,{staticClass:"pa-4",attrs:{color:"green lighten-5",elevation:"2"}},[S(k.a,{attrs:{align:"center"}},[S(d.a,{attrs:{cols:"3"}},[S(_.a,{attrs:{large:"",color:"green darken-2"}},[n._v("mdi-cash-refund")])],1),n._v(" "),S(d.a,{attrs:{cols:"9"}},[S("div",{staticClass:"text-subtitle-1 font-weight-bold"},[n._v("ລວມການຊຳລະ")]),n._v(" "),S("div",{staticClass:"caption mb-1"},[n._v("Total Settlements")]),n._v(" "),S("div",{staticClass:"text-h6 font-weight-bold"},[n._v("\n              "+n._s(n.formatCurrency(n.summaryData.totalSettlements))+"\n            ")]),n._v(" "),n.summaryData.totalSettlementsLcy?S("div",{staticClass:"caption"},[n._v("\n              LCY: "+n._s(n.formatCurrency(n.summaryData.totalSettlementsLcy))+"\n            ")]):n._e()])],1)],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(o.a,{staticClass:"pa-4",attrs:{color:"red lighten-5",elevation:"2"}},[S(k.a,{attrs:{align:"center"}},[S(d.a,{attrs:{cols:"3"}},[S(_.a,{attrs:{large:"",color:"red darken-2"}},[n._v("mdi-alert-circle")])],1),n._v(" "),S(d.a,{attrs:{cols:"9"}},[S("div",{staticClass:"text-subtitle-1 font-weight-bold"},[n._v("ຍອດຄ້າງຊຳລະ")]),n._v(" "),S("div",{staticClass:"caption mb-1"},[n._v("Outstanding Balance")]),n._v(" "),S("div",{staticClass:"text-h6 font-weight-bold"},[n._v("\n              "+n._s(n.formatCurrency(n.summaryData.outstandingBalance))+"\n            ")]),n._v(" "),n.summaryData.outstandingBalanceLcy?S("div",{staticClass:"caption"},[n._v("\n              LCY: "+n._s(n.formatCurrency(n.summaryData.outstandingBalanceLcy))+"\n            ")]):n._e()])],1)],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"3"}},[S(o.a,{staticClass:"pa-4",attrs:{color:"orange lighten-5",elevation:"2"}},[S(k.a,{attrs:{align:"center"}},[S(d.a,{attrs:{cols:"3"}},[S(_.a,{attrs:{large:"",color:"orange darken-2"}},[n._v("mdi-arrow-right-bold")])],1),n._v(" "),S(d.a,{attrs:{cols:"9"}},[S("div",{staticClass:"text-subtitle-1 font-weight-bold"},[n._v("ຍອດຍົກມາ")]),n._v(" "),S("div",{staticClass:"caption mb-1"},[n._v("Brought Forward")]),n._v(" "),S("div",{staticClass:"text-h6 font-weight-bold"},[n._v("\n              "+n._s(n.formatCurrency(n.summaryData.broughtForward))+"\n            ")]),n._v(" "),n.summaryData.broughtForwardLcy?S("div",{staticClass:"caption"},[n._v("\n              LCY: "+n._s(n.formatCurrency(n.summaryData.broughtForwardLcy))+"\n            ")]):n._e()])],1)],1)],1)],1),n._v(" "),n.summaryData.totalRecords?S(k.a,{staticClass:"additional-summary mb-4"},[S(d.a,{attrs:{cols:"12",md:"2"}},[S(o.a,{staticClass:"stats-card",attrs:{elevation:"2"}},[S(c.c,{staticClass:"text-center"},[S("h3",{staticClass:"stats-number"},[n._v(n._s(n.summaryData.totalRecords||0))]),n._v(" "),S("p",{staticClass:"stats-label"},[n._v("ທັງໝົດ"),S("br"),n._v("Total Records")])])],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"2"}},[S(o.a,{staticClass:"stats-card",attrs:{elevation:"2"}},[S(c.c,{staticClass:"text-center"},[S("h3",{staticClass:"stats-number text-success"},[n._v("\n            "+n._s(n.summaryData.fullySettledCount||0)+"\n          ")]),n._v(" "),S("p",{staticClass:"stats-label"},[n._v("ຊຳລະເຕັມ"),S("br"),n._v("Fully Settled")])])],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"2"}},[S(o.a,{staticClass:"stats-card",attrs:{elevation:"2"}},[S(c.c,{staticClass:"text-center"},[S("h3",{staticClass:"stats-number text-warning"},[n._v("\n            "+n._s(n.summaryData.partiallySettledCount||0)+"\n          ")]),n._v(" "),S("p",{staticClass:"stats-label"},[n._v("ຊຳລະບາງສ່ວນ"),S("br"),n._v("Partial")])])],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"2"}},[S(o.a,{staticClass:"stats-card",attrs:{elevation:"2"}},[S(c.c,{staticClass:"text-center"},[S("h3",{staticClass:"stats-number text-error"},[n._v("\n            "+n._s(n.summaryData.unsettledCount||0)+"\n          ")]),n._v(" "),S("p",{staticClass:"stats-label"},[n._v("ຍັງບໍ່ຊຳລະ"),S("br"),n._v("Unsettled")])])],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"2"}},[S(o.a,{staticClass:"stats-card",attrs:{elevation:"2"}},[S(c.c,{staticClass:"text-center"},[S("h3",{staticClass:"stats-number text-error"},[n._v("\n            "+n._s(n.summaryData.overdueCount||0)+"\n          ")]),n._v(" "),S("p",{staticClass:"stats-label"},[n._v("ເກີນກຳນົດ"),S("br"),n._v("Overdue")])])],1)],1),n._v(" "),S(d.a,{attrs:{cols:"12",md:"2"}},[S(o.a,{staticClass:"stats-card",attrs:{elevation:"2"}},[S(c.c,{staticClass:"text-center"},[S("h3",{staticClass:"stats-number"},[n._v("\n            "+n._s(n.summaryData.averageSettlementPercentage||0)+"%\n          ")]),n._v(" "),S("p",{staticClass:"stats-label"},[n._v("ເຄື່ອງຊຳລະ"),S("br"),n._v("Avg Settlement")])])],1)],1)],1):n._e(),n._v(" "),n.summaryData.currencyBreakdown&&n.summaryData.currencyBreakdown.length>0?S(o.a,{staticClass:"currency-breakdown-card mb-4",attrs:{elevation:"2"}},[S(c.d,[S("i",{staticClass:"fas fa-coins"}),n._v("\n      ສະຫຼູບຕາມສະກຸນເງິນ (Currency Breakdown)\n    ")]),n._v(" "),S(c.c,[S(k.a,n._l(n.summaryData.currencyBreakdown,(function(t){return S(d.a,{key:t.currencyCode,attrs:{cols:"12",md:"4"}},[S(o.a,{attrs:{outlined:""}},[S(c.c,[S("div",{staticClass:"currency-summary"},[S("h4",[n._v("\n                  "+n._s(t.currencyCode)+" - "+n._s(t.currencyName)+"\n                ")]),n._v(" "),S("div",{staticClass:"currency-details"},[S("p",[S("strong",[n._v("ລວມລາຍຈ່າຍ:")]),n._v("\n                    "+n._s(n.formatCurrency(t.totalAdvances))+"\n                  ")]),n._v(" "),S("p",[S("strong",[n._v("ລວມຊຳລະ:")]),n._v("\n                    "+n._s(n.formatCurrency(t.totalSettlements))+"\n                  ")]),n._v(" "),S("p",[S("strong",[n._v("ຍອດຄ້າງ:")]),n._v("\n                    "+n._s(n.formatCurrency(t.outstandingBalance))+"\n                  ")]),n._v(" "),S("p",[S("strong",[n._v("ເທົ່າກັບກີບ:")]),n._v("\n                    "+n._s(n.formatCurrency(t.lcyEquivalent))+"\n                  ")]),n._v(" "),S("p",[S("strong",[n._v("ຈຳນວນ:")]),n._v(" "+n._s(t.count)+" ລາຍການ")])])])])],1)],1)})),1)],1)],1):n._e(),n._v(" "),S(k.a,{staticClass:"mb-4"},[S(d.a,{attrs:{cols:"12"}},[S(o.a,{staticClass:"rounded-xl",attrs:{elevation:"2"}},[S(c.d,{staticClass:"primary--text py-2 px-4 d-flex align-center"},[S(_.a,{staticClass:"mr-2",attrs:{color:"primary"}},[n._v("mdi-office-building")]),n._v(" "),S("span",{staticClass:"text-subtitle-1 font-weight-medium"},[n._v("\n            ລາຍງານ ຕາມກົມ\n          ")]),n._v(" "),S(D.a),n._v(" "),S(D.a),n._v(" "),S(r.a,{staticClass:"mr-2",attrs:{color:"success",small:"",outlined:"",disabled:!n.ministrySummaryReport.length,loading:n.exporting},on:{click:n.exportMinistryReportToExcel}},[S(_.a,{attrs:{small:"",left:""}},[n._v("mdi-file-excel")]),n._v("\n            Export Excel\n          ")],1),n._v(" "),S(r.a,{attrs:{icon:"",small:"",loading:n.loadingMinistryReport},on:{click:n.refreshMinistryReport}},[S(_.a,{attrs:{small:""}},[n._v("mdi-refresh")])],1)],1),n._v(" "),S(y.a),n._v(" "),S(c.c,{staticClass:"pa-0"},[n.loadingMinistryReport?S("div",{staticClass:"text-center py-6"},[S(x.a,{attrs:{indeterminate:"",color:"primary"}}),n._v(" "),S("div",{staticClass:"mt-2 text-caption"},[n._v("Loading ministry report...")])],1):n.ministrySummaryReport.length?S(A.a,{attrs:{dense:""},scopedSlots:n._u([{key:"default",fn:function(){var t;return[S("thead",[S("tr",{staticClass:"primary lighten-3"},[S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("#")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("\n                    Ministry Code\n                  ")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("\n                    Ministry Name\n                  ")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold text-right"},[n._v("\n                    Count\n                  ")]),n._v(" "),n._l(n.currencyList,(function(t){return S("th",{key:"head-"+t,staticClass:"white--text text-caption font-weight-bold text-right"},[n._v("\n                    "+n._s(t)+"\n                  ")])})),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold text-right"},[n._v("\n                    Total (LAK)\n                  ")])],2)]),n._v(" "),S("tbody",[n._l(n.ministrySummaryReport,(function(t,e){return S("tr",{key:t.ministryId,class:{"grey lighten-5":e%2==0,"orange lighten-4":"NO_MINISTRY"===t.ministryId}},[S("td",{staticClass:"text-caption text-center"},[n._v(n._s(e+1))]),n._v(" "),S("td",{staticClass:"text-body-2",class:{"grey--text":"NO_MINISTRY"===t.ministryId}},[n._v("\n                    "+n._s(t.ministryCode)+"\n                  ")]),n._v(" "),S("td",{staticClass:"text-body-2",class:{"grey--text font-italic":"NO_MINISTRY"===t.ministryId}},[n._v("\n                    "+n._s(t.ministryName)+"\n                  ")]),n._v(" "),S("td",{staticClass:"text-body-2 text-right"},[n._v("\n                    "+n._s(t.settlementCount)+"\n                  ")]),n._v(" "),n._l(n.currencyList,(function(e){var r;return S("td",{key:"amt-"+e,staticClass:"text-body-2 text-right"},[n._v("\n                    "+n._s(n.formatAmount((null===(r=t.amounts)||void 0===r?void 0:r[e])||0))+"\n                  ")])})),n._v(" "),S("td",{staticClass:"text-right font-weight-bold success--text"},[n._v("\n                    "+n._s(n.formatAmount(t.totalLakEquivalent||0))+"\n                  ")])],2)})),n._v(" "),S("tr",{staticClass:"primary lighten-4"},[S("td",{staticClass:"font-weight-bold text-caption",attrs:{colspan:"3"}},[n._v("\n                    ລວມ\n                  ")]),n._v(" "),S("td",{staticClass:"text-right font-weight-bold text-body-2"},[n._v("\n                    "+n._s(n.ministrySummaryReport.reduce((function(t,e){return t+e.settlementCount}),0))+"\n                  ")]),n._v(" "),n._l(n.currencyList,(function(t){var e,r;return S("td",{key:"sum-"+t,staticClass:"text-right font-weight-bold text-body-2"},[n._v("\n                    "+n._s(n.formatAmount((null===(e=n.ministryTotals)||void 0===e||null===(r=e.currencyTotals)||void 0===r?void 0:r[t])||0))+"\n                  ")])})),n._v(" "),S("td",{staticClass:"text-right font-weight-bold text-body-2 primary--text"},[n._v("\n                    "+n._s(n.formatAmount((null===(t=n.ministryTotals)||void 0===t?void 0:t.totalLakEquivalent)||0))+"\n                  ")])],2)],2)]},proxy:!0}])}):S("div",{staticClass:"text-center py-6"},[S(_.a,{attrs:{size:"48",color:"grey lighten-2"}},[n._v("mdi-information-outline")]),n._v(" "),S("div",{staticClass:"mt-2 text-subtitle-2 grey--text"},[n._v("\n              No ministry data available\n            ")])],1)],1)],1)],1)],1),n._v(" "),S(k.a,{staticClass:"mb-4"},[S(d.a,{attrs:{cols:"12"}},[S(o.a,{staticClass:"rounded-xl",attrs:{elevation:"2"}},[S(c.d,{staticClass:"secondary--text py-2 px-4 d-flex align-center"},[S(_.a,{staticClass:"mr-2",attrs:{color:"secondary"}},[n._v("mdi-bank")]),n._v(" "),S("span",{staticClass:"text-subtitle-1 font-weight-medium"},[n._v("\n            ລາຍງານ ບັນຊີທະນາຄານ\n          ")]),n._v(" "),S(D.a),n._v(" "),S(D.a),n._v(" "),S(r.a,{staticClass:"mr-2",attrs:{color:"success",small:"",outlined:"",disabled:!n.bankAccountSummaryReport.length,loading:n.exporting},on:{click:n.exportBankAccountReportToExcel}},[S(_.a,{attrs:{small:"",left:""}},[n._v("mdi-file-excel")]),n._v("\n            Export Excel\n          ")],1),n._v(" "),S(r.a,{attrs:{icon:"",small:"",loading:n.loadingBankAccountReport},on:{click:n.refreshBankAccountReport}},[S(_.a,{attrs:{small:""}},[n._v("mdi-refresh")])],1)],1),n._v(" "),S(y.a),n._v(" "),S(c.c,{staticClass:"pa-0"},[n.loadingBankAccountReport?S("div",{staticClass:"text-center py-6"},[S(x.a,{attrs:{indeterminate:"",color:"secondary"}}),n._v(" "),S("div",{staticClass:"mt-2 text-caption"},[n._v("\n              Loading bank account report...\n            ")])],1):n.bankAccountSummaryReport.length?S(A.a,{attrs:{dense:""},scopedSlots:n._u([{key:"default",fn:function(){var t;return[S("thead",[S("tr",{staticClass:"secondary lighten-3"},[S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("#")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("\n                    Account Number\n                  ")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("\n                    Account Name\n                  ")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("\n                    Bank Name\n                  ")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold"},[n._v("\n                    Type\n                  ")]),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold text-right"},[n._v("\n                    Count\n                  ")]),n._v(" "),n._l(n.bankAccountCurrencyList,(function(t){return S("th",{key:"bank-head-"+t,staticClass:"white--text text-caption font-weight-bold text-right"},[n._v("\n                    "+n._s(t)+"\n                  ")])})),n._v(" "),S("th",{staticClass:"white--text text-caption font-weight-bold text-right"},[n._v("\n                    Total (LAK)\n                  ")])],2)]),n._v(" "),S("tbody",[n._l(n.bankAccountSummaryReport,(function(t,e){return S("tr",{key:t.bankAccountId,class:{"grey lighten-5":e%2==0,"orange lighten-4":"NO_BANK_ACCOUNT"===t.bankAccountId}},[S("td",{staticClass:"text-caption text-center"},[n._v(n._s(e+1))]),n._v(" "),S("td",{staticClass:"text-body-2",class:{"grey--text":"NO_BANK_ACCOUNT"===t.bankAccountId}},[n._v("\n                    "+n._s(t.accountNumber)+"\n                  ")]),n._v(" "),S("td",{staticClass:"text-body-2",class:{"grey--text font-italic":"NO_BANK_ACCOUNT"===t.bankAccountId}},[n._v("\n                    "+n._s(t.accountName)+"\n                  ")]),n._v(" "),S("td",{staticClass:"text-body-2"},[n._v("\n                    "+n._s(t.bankName)+"\n                  ")]),n._v(" "),S("td",{staticClass:"text-body-2"},[S(l.a,{attrs:{small:"",outlined:""}},[n._v("\n                      "+n._s(t.accountType)+"\n                    ")])],1),n._v(" "),S("td",{staticClass:"text-body-2 text-right"},[n._v("\n                    "+n._s(t.settlementCount)+"\n                  ")]),n._v(" "),n._l(n.bankAccountCurrencyList,(function(e){var r;return S("td",{key:"bank-amt-"+e,staticClass:"text-body-2 text-right"},[n._v("\n                    "+n._s(n.formatAmount((null===(r=t.amounts)||void 0===r?void 0:r[e])||0))+"\n                  ")])})),n._v(" "),S("td",{staticClass:"text-right font-weight-bold success--text"},[n._v("\n                    "+n._s(n.formatAmount(t.totalLakEquivalent||0))+"\n                  ")])],2)})),n._v(" "),S("tr",{staticClass:"secondary lighten-4"},[S("td",{staticClass:"font-weight-bold text-caption",attrs:{colspan:"5"}},[n._v("\n                    ລວມ\n                  ")]),n._v(" "),S("td",{staticClass:"text-right font-weight-bold text-body-2"},[n._v("\n                    "+n._s(n.bankAccountSummaryReport.reduce((function(t,b){return t+b.settlementCount}),0))+"\n                  ")]),n._v(" "),n._l(n.bankAccountCurrencyList,(function(t){var e,r;return S("td",{key:"bank-sum-"+t,staticClass:"text-right font-weight-bold text-body-2"},[n._v("\n                    "+n._s(n.formatAmount((null===(e=n.bankAccountTotals)||void 0===e||null===(r=e.currencyTotals)||void 0===r?void 0:r[t])||0))+"\n                  ")])})),n._v(" "),S("td",{staticClass:"text-right font-weight-bold text-body-2 secondary--text"},[n._v("\n                    "+n._s(n.formatAmount((null===(t=n.bankAccountTotals)||void 0===t?void 0:t.totalLakEquivalent)||0))+"\n                  ")])],2)],2)]},proxy:!0}])}):S("div",{staticClass:"text-center py-6"},[S(_.a,{attrs:{size:"48",color:"grey lighten-2"}},[n._v("mdi-information-outline")]),n._v(" "),S("div",{staticClass:"mt-2 text-subtitle-2 grey--text"},[n._v("\n              No bank account data available\n            ")])],1)],1)],1)],1)],1),n._v(" "),S(o.a,{staticClass:"table-card",attrs:{elevation:"2"}},[S(c.d,{staticClass:"table-title"},[S("i",{staticClass:"fas fa-table"}),n._v("\n      ລາຍລະອຽດລາຍງານ (Detailed Report)\n      "),S(D.a),n._v(" "),S(R.a,{staticClass:"search-field",attrs:{"append-icon":"mdi-magnify",label:"ຄົ້ນຫາ...","single-line":"","hide-details":""},model:{value:n.search,callback:function(t){n.search=t},expression:"search"}})],1),n._v(" "),S(m.a,{staticClass:"report-table",attrs:{headers:n.tableHeaders,items:n.reportData,search:n.search,loading:n.loading,"items-per-page":25,"footer-props":{itemsPerPageOptions:[10,25,50,100],itemsPerPageText:"ແຖວຕໍ່ໜ້າ:"}},scopedSlots:n._u([{key:"item.bookingDate",fn:function(t){var e=t.item;return[S("span",{staticClass:"date-cell"},[n._v(n._s(n.formatDate(e.bookingDate)))])]}},{key:"item.amount",fn:function(t){var e=t.item;return[S("span",{staticClass:"amount-cell advance-amount"},[n._v("\n          "+n._s(n.formatCurrency(e.amount))+"\n        ")])]}},{key:"item.currencyCode",fn:function(t){var e=t.item;return[S(l.a,{attrs:{small:"",outlined:""}},[n._v("\n          "+n._s(e.currencyCode||"N/A")+"\n        ")])]}},{key:"item.exchangeRate",fn:function(t){var e=t.item;return[S("span",{staticClass:"exchange-rate-cell"},[n._v("\n          "+n._s(n.formatExchangeRate(e.exchangeRate))+"\n        ")])]}},{key:"item.lcyEquivalent",fn:function(t){var e=t.item;return[S("span",{staticClass:"amount-cell lcy-amount"},[n._v("\n          "+n._s(n.formatCurrency(e.lcyEquivalent))+"\n        ")])]}},{key:"item.settlementAmount",fn:function(t){var e=t.item;return[S("span",{staticClass:"amount-cell settlement-amount"},[n._v("\n          "+n._s(n.formatCurrency(e.settlementAmount||0))+"\n        ")])]}},{key:"item.outstandingAmount",fn:function(t){var e=t.item;return[S("span",{staticClass:"amount-cell outstanding-amount"},[n._v("\n          "+n._s(n.formatCurrency(e.outstandingAmount))+"\n        ")])]}},{key:"item.settlementPercentage",fn:function(t){var e=t.item;return[S("div",{staticClass:"settlement-progress"},[S(C.a,{attrs:{value:parseFloat(e.settlementPercentage),color:n.getProgressColor(e.settlementPercentage),height:"20",rounded:""}},[S("span",{staticClass:"progress-text"},[n._v(n._s(e.settlementPercentage)+"%")])])],1)]}},{key:"item.status",fn:function(t){var e=t.item;return[S(l.a,{attrs:{color:n.getStatusColor(e.status),"text-color":"white",small:""}},[n._v("\n          "+n._s(n.getStatusText(e.status))+"\n        ")])]}},{key:"item.daysOverdue",fn:function(t){var e=t.item;return[e.daysOverdue>0?S(l.a,{attrs:{color:"red","text-color":"white",small:""}},[n._v("\n          "+n._s(e.daysOverdue)+" ມື້\n        ")]):S("span",{staticClass:"text-success"},[n._v("-")])]}},{key:"item.ministry",fn:function(t){var e,r,o=t.item;return[S("div",{staticClass:"ministry-cell"},[S("span",{staticClass:"ministry-name"},[n._v(n._s((null===(e=o.ministry)||void 0===e?void 0:e.ministryName)||"N/A"))]),n._v(" "),S("span",{staticClass:"ministry-code"},[n._v(n._s((null===(r=o.ministry)||void 0===r?void 0:r.ministryCode)||""))])])]}},{key:"item.actions",fn:function(t){var e=t.item;return[S(r.a,{staticClass:"mr-2",attrs:{small:"",color:"primary"},on:{click:function(t){return n.viewDetails(e)}}},[S("i",{staticClass:"fas fa-eye"})]),n._v(" "),e.settlementCount>0?S(r.a,{attrs:{small:"",color:"success"},on:{click:function(t){return n.viewSettlements(e)}}},[S("i",{staticClass:"fas fa-list"}),n._v("\n          "+n._s(e.settlementCount)+"\n        ")]):n._e()]}}])})],1),n._v(" "),S(f.a,{attrs:{"max-width":"900px"},model:{value:n.detailsDialog,callback:function(t){n.detailsDialog=t},expression:"detailsDialog"}},[S(o.a,[S(c.d,[S("i",{staticClass:"fas fa-info-circle"}),n._v("\n        ລາຍລະອຽດລາຍຈ່າຍ (Advance Details)\n        "),S(D.a),n._v(" "),S(r.a,{attrs:{icon:""},on:{click:function(t){n.detailsDialog=!1}}},[S(_.a,[n._v("mdi-close")])],1)],1),n._v(" "),n.selectedItem?S(c.c,[S(k.a,[S(d.a,{attrs:{cols:"6"}},[S("div",{staticClass:"detail-item"},[S("strong",[n._v("ວັນທີບັນທຶກ:")]),n._v("\n              "+n._s(n.formatDate(n.selectedItem.bookingDate))+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ຈຳນວນເງິນ:")]),n._v("\n              "+n._s(n.formatCurrency(n.selectedItem.amount))+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ສະກຸນເງິນ:")]),n._v("\n              "+n._s(n.selectedItem.currencyCode||"N/A")+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ອັດຕາແລກປ່ຽນ:")]),n._v("\n              "+n._s(n.formatExchangeRate(n.selectedItem.exchangeRate))+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ເທົ່າກັບກີບ:")]),n._v("\n              "+n._s(n.formatCurrency(n.selectedItem.lcyEquivalent))+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ຈຸດປະສົງ:")]),n._v(" "+n._s(n.selectedItem.purpose||"N/A")+"\n            ")])]),n._v(" "),S(d.a,{attrs:{cols:"6"}},[S("div",{staticClass:"detail-item"},[S("strong",[n._v("ກະຊວງ:")]),n._v("\n              "+n._s((null===(t=n.selectedItem.ministry)||void 0===t?void 0:t.ministryName)||"N/A")+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ສະຖານະ:")]),n._v(" "),S(l.a,{attrs:{color:n.getStatusColor(n.selectedItem.status),"text-color":"white",small:""}},[n._v("\n                "+n._s(n.getStatusText(n.selectedItem.status))+"\n              ")])],1),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ຈຳນວນຊຳລະ:")]),n._v("\n              "+n._s(n.formatCurrency(n.selectedItem.settlementAmount))+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ຍອດຄ້າງ:")]),n._v("\n              "+n._s(n.formatCurrency(n.selectedItem.outstandingAmount))+"\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ເປີເຊັນຊຳລະ:")]),n._v("\n              "+n._s(n.selectedItem.settlementPercentage)+"%\n            ")]),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ຜູ້ລົງບັນທຶກ:")]),n._v("\n              "+n._s((null===(e=n.selectedItem.maker)||void 0===e?void 0:e.cus_name)||"N/A")+"\n            ")])])],1),n._v(" "),S(y.a,{staticClass:"my-4"}),n._v(" "),S("div",{staticClass:"detail-item"},[S("strong",[n._v("ໝາຍເຫດ:")]),n._v(" "+n._s(n.selectedItem.note||"ບໍ່ມີໝາຍເຫດ")+"\n        ")]),n._v(" "),n.selectedItem.daysOverdue>0?S("div",{staticClass:"detail-item"},[S("strong",[n._v("ເກີນກຳນົດ:")]),n._v(" "),S(l.a,{attrs:{color:"red","text-color":"white",small:""}},[n._v("\n            "+n._s(n.selectedItem.daysOverdue)+" ມື້\n          ")])],1):n._e()],1):n._e()],1)],1),n._v(" "),S(f.a,{attrs:{"max-width":"900px"},model:{value:n.settlementsDialog,callback:function(t){n.settlementsDialog=t},expression:"settlementsDialog"}},[S(o.a,[S(c.d,[S("i",{staticClass:"fas fa-receipt"}),n._v("\n        ປະຫວັດການຊຳລະ (Settlement History)\n        "),S(D.a),n._v(" "),S(r.a,{attrs:{icon:""},on:{click:function(t){n.settlementsDialog=!1}}},[S(_.a,[n._v("mdi-close")])],1)],1),n._v(" "),S(c.c,[S(m.a,{staticClass:"settlement-table",attrs:{headers:n.settlementHeaders,items:n.settlements,loading:n.loadingSettlements,"hide-default-footer":""},scopedSlots:n._u([{key:"item.bookingDate",fn:function(t){var e=t.item;return[S("span",{staticClass:"date-cell"},[n._v(n._s(n.formatDate(e.bookingDate)))])]}},{key:"item.amount",fn:function(t){var e=t.item;return[S("span",{staticClass:"amount-cell settlement-amount"},[n._v("\n              "+n._s(n.formatCurrency(e.amount))+"\n            ")])]}},{key:"item.method",fn:function(t){var e=t.item;return[S(l.a,{attrs:{small:"",color:n.getMethodColor(e.method)}},[n._v("\n              "+n._s(n.getMethodText(e.method))+"\n            ")])]}}])})],1)],1)],1)],1)}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"title-section"},[e("h1",{staticClass:"page-title"},[e("i",{staticClass:"fas fa-chart-line"}),t._v("\n        ລາຍງານ ລາຍຈ່າຍລ່ວງໜ້າ\n      ")]),t._v(" "),e("p",{staticClass:"page-subtitle"},[t._v("Money Advance Report")])])}],!1,null,"2ad3a22c",null);e.default=component.exports},891:function(t,e,n){"use strict";n.r(e);var r=n(33),o=n(858);n.d(e,"Animation",(function(){return o.a})),n.d(e,"Animations",(function(){return o.b})),n.d(e,"ArcElement",(function(){return o.c})),n.d(e,"BarController",(function(){return o.d})),n.d(e,"BarElement",(function(){return o.e})),n.d(e,"BasePlatform",(function(){return o.f})),n.d(e,"BasicPlatform",(function(){return o.g})),n.d(e,"BubbleController",(function(){return o.h})),n.d(e,"CategoryScale",(function(){return o.i})),n.d(e,"Chart",(function(){return o.j})),n.d(e,"Colors",(function(){return o.k})),n.d(e,"DatasetController",(function(){return o.l})),n.d(e,"Decimation",(function(){return o.m})),n.d(e,"DomPlatform",(function(){return o.n})),n.d(e,"DoughnutController",(function(){return o.o})),n.d(e,"Element",(function(){return o.p})),n.d(e,"Filler",(function(){return o.q})),n.d(e,"Interaction",(function(){return o.r})),n.d(e,"Legend",(function(){return o.s})),n.d(e,"LineController",(function(){return o.t})),n.d(e,"LineElement",(function(){return o.u})),n.d(e,"LinearScale",(function(){return o.v})),n.d(e,"LogarithmicScale",(function(){return o.w})),n.d(e,"PieController",(function(){return o.x})),n.d(e,"PointElement",(function(){return o.y})),n.d(e,"PolarAreaController",(function(){return o.z})),n.d(e,"RadarController",(function(){return o.A})),n.d(e,"RadialLinearScale",(function(){return o.B})),n.d(e,"Scale",(function(){return o.C})),n.d(e,"ScatterController",(function(){return o.D})),n.d(e,"SubTitle",(function(){return o.E})),n.d(e,"Ticks",(function(){return o.F})),n.d(e,"TimeScale",(function(){return o.G})),n.d(e,"TimeSeriesScale",(function(){return o.H})),n.d(e,"Title",(function(){return o.I})),n.d(e,"Tooltip",(function(){return o.J})),n.d(e,"_adapters",(function(){return o.K})),n.d(e,"_detectPlatform",(function(){return o.L})),n.d(e,"animator",(function(){return o.M})),n.d(e,"controllers",(function(){return o.N})),n.d(e,"defaults",(function(){return o.P})),n.d(e,"elements",(function(){return o.Q})),n.d(e,"layouts",(function(){return o.R})),n.d(e,"plugins",(function(){return o.S})),n.d(e,"registerables",(function(){return o.T})),n.d(e,"registry",(function(){return o.U})),n.d(e,"scales",(function(){return o.V})),o.j.register.apply(o.j,Object(r.a)(o.T)),e.default=o.j}}]);