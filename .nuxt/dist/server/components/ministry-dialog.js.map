{"version":3,"file":"components/ministry-dialog.js","sources":["webpack:///./components/ministry/MinistryDialog.vue","webpack:///./components/ministry/MinistryDialog.vue?07a6","webpack:///./components/ministry/MinistryDialog.vue?bcdd","webpack:///./components/ministry/MinistryDialog.vue?67be","webpack:///./components/ministry/MinistryDialog.vue?bc9f","webpack:///./components/ministry/MinistryDialog.vue?8a25"],"sourcesContent":["\nexport default {\n  name: 'MinistryDialog',\n  \n  props: {\n    show: {\n      type: Boolean,\n      default: false\n    },\n    ministry: {\n      type: Object,\n      default: null\n    },\n    ministries: {\n      type: Array,\n      default: () => []\n    }\n  },\n\n  data() {\n    return {\n      loading: false,\n      errors: {},\n      formData: {\n        ministryCode: '',\n        ministryName: '',\n        ministryNameEn: '',\n        description: '',\n        ministryType: 'Ministry',\n        parentMinistryId: null,\n        ministerName: '',\n        establishedDate: '',\n        address: '',\n        phoneNumber: '',\n        email: '',\n        website: '',\n        province: '',\n        district: '',\n        status: 'Active',\n        priority: 0,\n        isActive: true\n      }\n    }\n  },\n\n  computed: {\n    isEdit() {\n      return this.ministry && this.ministry.id\n    },\n\n    availableParentMinistries() {\n      return this.ministries.filter(m => {\n        // Exclude current ministry (when editing) and its children\n        if (this.isEdit && m.id === this.ministry.id) {\n          return false\n        }\n        // Only show Ministry and Department types as potential parents\n        return ['Ministry', 'Department'].includes(m.ministryType)\n      })\n    }\n  },\n\n  watch: {\n    show(newVal) {\n      if (newVal) {\n        this.initializeForm()\n        this.clearErrors()\n      }\n    },\n\n    ministry: {\n      handler() {\n        if (this.show) {\n          this.initializeForm()\n        }\n      },\n      deep: true\n    }\n  },\n\n  methods: {\n    initializeForm() {\n      if (this.isEdit) {\n        // Edit mode - populate form with existing data\n        this.formData = {\n          ministryCode: this.ministry.ministryCode || '',\n          ministryName: this.ministry.ministryName || '',\n          ministryNameEn: this.ministry.ministryNameEn || '',\n          description: this.ministry.description || '',\n          ministryType: this.ministry.ministryType || 'Ministry',\n          parentMinistryId: this.ministry.parentMinistryId || null,\n          ministerName: this.ministry.ministerName || '',\n          establishedDate: this.ministry.establishedDate ? this.ministry.establishedDate.split('T')[0] : '',\n          address: this.ministry.address || '',\n          phoneNumber: this.ministry.phoneNumber || '',\n          email: this.ministry.email || '',\n          website: this.ministry.website || '',\n          province: this.ministry.province || '',\n          district: this.ministry.district || '',\n          status: this.ministry.status || 'Active',\n          priority: this.ministry.priority || 0,\n          isActive: this.ministry.isActive !== false\n        }\n      } else {\n        // Create mode - reset form\n        this.formData = {\n          ministryCode: '',\n          ministryName: '',\n          ministryNameEn: '',\n          description: '',\n          ministryType: 'Ministry',\n          parentMinistryId: null,\n          ministerName: '',\n          establishedDate: '',\n          address: '',\n          phoneNumber: '',\n          email: '',\n          website: '',\n          province: '',\n          district: '',\n          status: 'Active',\n          priority: 0,\n          isActive: true\n        }\n      }\n    },\n\n    validateForm() {\n      this.errors = {}\n\n      // Required fields\n      if (!this.formData.ministryCode) {\n        this.errors.ministryCode = 'ກະລຸນາປ້ອນລະຫັດກະຊວງ'\n      }\n\n      if (!this.formData.ministryName) {\n        this.errors.ministryName = 'ກະລຸນາປ້ອນຊື່ກະຊວງ'\n      }\n\n      if (!this.formData.ministryType) {\n        this.errors.ministryType = 'ກະລຸນາເລືອກປະເພດກະຊວງ'\n      }\n\n      // Email validation\n      if (this.formData.email && !this.isValidEmail(this.formData.email)) {\n        this.errors.email = 'ຮູບແບບອີເມວບໍ່ຖືກຕ້ອງ'\n      }\n\n      // Website validation\n      if (this.formData.website && !this.isValidUrl(this.formData.website)) {\n        this.errors.website = 'ຮູບແບບເວັບໄຊຕ໌ບໍ່ຖືກຕ້ອງ'\n      }\n\n      return Object.keys(this.errors).length === 0\n    },\n\n    isValidEmail(email) {\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n      return emailRegex.test(email)\n    },\n\n    isValidUrl(url) {\n      try {\n        new URL(url)\n        return true\n      } catch (e) {\n        return false\n      }\n    },\n\n    async submitForm() {\n      if (!this.validateForm()) {\n        return\n      }\n\n      try {\n        this.loading = true\n\n        // Clean up form data\n        const submitData = { ...this.formData }\n        \n        // Convert empty strings to null for optional fields\n        Object.keys(submitData).forEach(key => {\n          if (submitData[key] === '') {\n            submitData[key] = null\n          }\n        })\n\n        // Convert parentMinistryId to number or null\n        if (submitData.parentMinistryId) {\n          submitData.parentMinistryId = parseInt(submitData.parentMinistryId)\n        }\n\n        let response\n        if (this.isEdit) {\n          // Update existing ministry\n          response = await this.$axios.put(`/api/ministries/${this.ministry.id}`, submitData)\n        } else {\n          // Create new ministry\n          response = await this.$axios.post('/api/ministries', submitData)\n        }\n\n        this.$emit('saved', response.data)\n        this.closeDialog()\n      } catch (error) {\n        console.error('Error saving ministry:', error)\n        \n        if (error.response && error.response.data) {\n          if (error.response.data.errors) {\n            // Handle validation errors from server\n            this.errors = error.response.data.errors\n          } else {\n            // Handle other server errors\n            this.showToast(error.response.data.message || 'ມີຂໍ້ຜິດພາດໃນການບັນທຶກ', 'error')\n          }\n        } else {\n          this.showToast('ມີຂໍ້ຜິດພາດໃນການບັນທຶກ', 'error')\n        }\n      } finally {\n        this.loading = false\n      }\n    },\n\n    closeDialog() {\n      this.$emit('close')\n    },\n\n    clearErrors() {\n      this.errors = {}\n    },\n\n    onProvinceChange() {\n      // Clear district when province changes\n      this.formData.district = ''\n    },\n\n    showToast(message, type = 'info') {\n      // Use parent's toast method or fallback\n      if (this.$parent && this.$parent.showToast) {\n        this.$parent.showToast(message, type)\n      } else {\n        console.log(`${type}: ${message}`)\n      }\n    }\n  }\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--3-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??ref--3-oneOf-1-2!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MinistryDialog.vue?vue&type=style&index=0&id=e38c8604&prod&scoped=true&lang=css&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"5bf60468\", content, true, context)\n};","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--3-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--3-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js??ref--3-oneOf-1-2!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MinistryDialog.vue?vue&type=style&index=0&id=e38c8604&prod&scoped=true&lang=css&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(function(i){return i[1]});\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".dialog-overlay[data-v-e38c8604]{align-items:center;background-color:rgba(0,0,0,.5);bottom:0;display:flex;justify-content:center;left:0;padding:20px;position:fixed;right:0;top:0;z-index:1000}.dialog-container[data-v-e38c8604]{background:#fff;border-radius:8px;box-shadow:0 10px 30px rgba(0,0,0,.2);display:flex;flex-direction:column;max-height:90vh;max-width:900px;overflow:hidden;width:100%}.dialog-header[data-v-e38c8604]{background:#f8f9fa;border-bottom:1px solid #e9ecef;justify-content:space-between;padding:20px 24px}.dialog-header[data-v-e38c8604],.dialog-title[data-v-e38c8604]{align-items:center;display:flex}.dialog-title[data-v-e38c8604]{color:#333;font-size:20px;font-weight:600;gap:12px;margin:0}.dialog-close[data-v-e38c8604]{background:none;border:none;border-radius:4px;color:#666;cursor:pointer;font-size:20px;padding:8px;transition:all .2s}.dialog-close[data-v-e38c8604]:hover{background-color:#e9ecef;color:#333}.dialog-body[data-v-e38c8604]{flex:1;overflow-y:auto;padding:24px}.dialog-footer[data-v-e38c8604]{background:#f8f9fa;border-top:1px solid #e9ecef;display:flex;gap:12px;justify-content:flex-end;padding:16px 24px}.form-section[data-v-e38c8604]{margin-bottom:32px}.form-section[data-v-e38c8604]:last-child{margin-bottom:0}.section-title[data-v-e38c8604]{align-items:center;border-bottom:2px solid #e9ecef;color:#333;display:flex;font-size:16px;font-weight:600;gap:8px;margin:0 0 20px;padding-bottom:8px}.form-grid[data-v-e38c8604]{grid-gap:20px;display:grid;gap:20px;grid-template-columns:1fr 1fr}.form-group[data-v-e38c8604]{display:flex;flex-direction:column;gap:6px}.form-group.full-width[data-v-e38c8604]{grid-column:1/-1}.form-label[data-v-e38c8604]{color:#555;font-size:14px;font-weight:500}.form-label.required[data-v-e38c8604]:after{color:#dc3545;content:\\\" *\\\"}.form-input[data-v-e38c8604],.form-select[data-v-e38c8604],.form-textarea[data-v-e38c8604]{border:1px solid #ced4da;border-radius:6px;font-size:14px;padding:10px 12px;transition:border-color .2s,box-shadow .2s}.form-input[data-v-e38c8604]:focus,.form-select[data-v-e38c8604]:focus,.form-textarea[data-v-e38c8604]:focus{border-color:#007bff;box-shadow:0 0 0 3px rgba(0,123,255,.1);outline:none}.form-input.error[data-v-e38c8604],.form-select.error[data-v-e38c8604],.form-textarea.error[data-v-e38c8604]{border-color:#dc3545}.form-textarea[data-v-e38c8604]{min-height:80px;resize:vertical}.form-checkbox[data-v-e38c8604]{align-items:center;color:#555;cursor:pointer;display:flex;font-weight:500;gap:8px}.form-checkbox input[type=checkbox][data-v-e38c8604]{display:none}.checkbox-mark[data-v-e38c8604]{align-items:center;border:2px solid #ced4da;border-radius:4px;display:flex;height:20px;justify-content:center;transition:all .2s;width:20px}.form-checkbox input[type=checkbox]:checked+.checkbox-mark[data-v-e38c8604]{background-color:#007bff;border-color:#007bff}.form-checkbox input[type=checkbox]:checked+.checkbox-mark[data-v-e38c8604]:after{color:#fff;content:\\\"✓\\\";font-size:12px;font-weight:700}.error-message[data-v-e38c8604]{color:#dc3545;font-size:12px;margin-top:4px}.btn[data-v-e38c8604]{align-items:center;border:1px solid transparent;border-radius:6px;cursor:pointer;display:inline-flex;font-size:14px;font-weight:500;gap:8px;padding:10px 20px;-webkit-text-decoration:none;text-decoration:none;transition:all .2s}.btn[data-v-e38c8604]:disabled{cursor:not-allowed;opacity:.5}.btn-primary[data-v-e38c8604]{background-color:#007bff;border-color:#007bff;color:#fff}.btn-primary[data-v-e38c8604]:hover:not(:disabled){background-color:#0056b3;border-color:#0056b3}.btn-outline-secondary[data-v-e38c8604]{background-color:transparent;border-color:#6c757d;color:#6c757d}.btn-outline-secondary[data-v-e38c8604]:hover:not(:disabled){background-color:#6c757d;color:#fff}@media (max-width:768px){.dialog-overlay[data-v-e38c8604]{padding:10px}.dialog-container[data-v-e38c8604]{max-width:100%}.form-grid[data-v-e38c8604]{gap:16px;grid-template-columns:1fr}.form-group.full-width[data-v-e38c8604]{grid-column:1}.dialog-header[data-v-e38c8604]{padding:16px 20px}.dialog-body[data-v-e38c8604]{padding:20px}.dialog-footer[data-v-e38c8604]{flex-direction:column-reverse;padding:12px 20px}.btn[data-v-e38c8604]{justify-content:center;width:100%}}@media (max-width:480px){.dialog-title[data-v-e38c8604]{font-size:18px}.section-title[data-v-e38c8604]{font-size:14px}.form-section[data-v-e38c8604]{margin-bottom:24px}}\", \"\"]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MinistryDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MinistryDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MinistryDialog.vue?vue&type=template&id=e38c8604&scoped=true&\"\nimport script from \"./MinistryDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./MinistryDialog.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./MinistryDialog.vue?vue&type=style&index=0&id=e38c8604&prod&scoped=true&lang=css&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"e38c8604\",\n  \"5fc7dd18\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACrPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AHPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;AIFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}