exports.ids = [162];
exports.modules = {

/***/ 1046:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_3_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_3_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_ref_3_oneOf_1_2_node_modules_nuxt_components_dist_loader_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_customer_vue_vue_type_style_index_0_id_1fef85ee_prod_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(799);
/* harmony import */ var _node_modules_vue_style_loader_index_js_ref_3_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_3_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_ref_3_oneOf_1_2_node_modules_nuxt_components_dist_loader_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_customer_vue_vue_type_style_index_0_id_1fef85ee_prod_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_style_loader_index_js_ref_3_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_3_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_ref_3_oneOf_1_2_node_modules_nuxt_components_dist_loader_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_customer_vue_vue_type_style_index_0_id_1fef85ee_prod_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_vue_style_loader_index_js_ref_3_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_3_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_ref_3_oneOf_1_2_node_modules_nuxt_components_dist_loader_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_customer_vue_vue_type_style_index_0_id_1fef85ee_prod_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_vue_style_loader_index_js_ref_3_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_3_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_dist_cjs_js_ref_3_oneOf_1_2_node_modules_nuxt_components_dist_loader_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_customer_vue_vue_type_style_index_0_id_1fef85ee_prod_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));


/***/ }),

/***/ 1047:
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(4);
var ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(function(i){return i[1]});
// Module
___CSS_LOADER_EXPORT___.push([module.i, ".customer-display-container[data-v-1fef85ee]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);font-family:\"Roboto\",\"Arial\",sans-serif;min-height:100vh;overflow:hidden}.dcommerce-green[data-v-1fef85ee]{background-color:#01532b!important}.dcommerce-green-text[data-v-1fef85ee]{color:#01532b!important}.welcome-screen[data-v-1fef85ee]{align-items:center;display:flex;flex-direction:column;height:100vh;justify-content:center;padding:2rem;text-align:center}.logo-section[data-v-1fef85ee]{margin-bottom:3rem}.store-name[data-v-1fef85ee]{color:#01532b;font-size:3rem;font-weight:700;letter-spacing:-1px;margin:1rem 0}.welcome-text[data-v-1fef85ee]{color:#6c757d;font-size:1.5rem;margin:.5rem 0}.status-text[data-v-1fef85ee]{color:#01532b;font-size:1.2rem;font-weight:500;margin:.5rem 0}.waiting-animation[data-v-1fef85ee]{align-items:center;display:flex;flex-direction:column}.waiting-text[data-v-1fef85ee]{color:#6c757d;font-size:1.1rem;margin:0}.qr-payment-screen[data-v-1fef85ee]{height:100vh;padding:1.5rem}.payment-layout[data-v-1fef85ee]{display:flex;gap:2rem;height:100%}.order-section[data-v-1fef85ee]{background:#fff;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.1);display:flex;flex:1;flex-direction:column;overflow:hidden}.order-header[data-v-1fef85ee]{align-items:center;background:#01532b;color:#fff;display:flex;justify-content:space-between;padding:1.5rem}.order-title[data-v-1fef85ee]{font-size:1.5rem;font-weight:600;margin:0}.table-badge[data-v-1fef85ee]{background:hsla(0,0%,100%,.2);border-radius:20px;font-size:.9rem;font-weight:500;padding:.5rem 1rem}.order-items[data-v-1fef85ee]{flex:1;overflow-y:auto;padding:1.5rem}.items-list[data-v-1fef85ee]{space-y:1rem}.order-item[data-v-1fef85ee]{align-items:center;border:1px solid #e9ecef;border-radius:12px;display:flex;margin-bottom:.75rem;padding:1rem;transition:background-color .2s}.order-item[data-v-1fef85ee]:hover{background-color:#f8f9fa}.item-details[data-v-1fef85ee]{flex:1}.item-name[data-v-1fef85ee]{color:#212529;font-size:1rem;font-weight:600;margin-bottom:.25rem}.item-description[data-v-1fef85ee]{color:#6c757d;font-size:.85rem}.item-quantity[data-v-1fef85ee]{color:#01532b;font-weight:600;margin:0 1rem;min-width:40px;text-align:center}.item-price[data-v-1fef85ee]{color:#01532b;font-size:1rem;font-weight:700;min-width:80px;text-align:right}.no-items[data-v-1fef85ee]{padding:3rem 1rem;text-align:center}.order-summary[data-v-1fef85ee]{background:#f8f9fa;border-top:2px solid #e9ecef;padding:1.5rem}.summary-line[data-v-1fef85ee]{font-size:.95rem;margin-bottom:.5rem}.summary-line[data-v-1fef85ee],.summary-total[data-v-1fef85ee]{display:flex;justify-content:space-between}.summary-total[data-v-1fef85ee]{border-top:2px solid #01532b;color:#01532b;font-size:1.25rem;font-weight:700;margin-top:.75rem;padding-top:.75rem}.discount[data-v-1fef85ee]{color:#dc3545}.payment-section[data-v-1fef85ee]{align-items:center;display:flex;flex:1;flex-direction:column;text-align:center}.payment-header[data-v-1fef85ee]{margin-bottom:1.5rem}.payment-title[data-v-1fef85ee]{color:#01532b;font-size:2rem;font-weight:700;margin:0}.amount-display[data-v-1fef85ee]{background:#fff;border-radius:20px;box-shadow:0 10px 30px rgba(1,83,43,.15);margin-bottom:2rem;min-width:280px;padding:1.5rem}.amount-label[data-v-1fef85ee]{color:#6c757d;font-size:1rem;margin-bottom:.5rem}.amount-value[data-v-1fef85ee]{color:#01532b;font-size:2.5rem;font-weight:700;line-height:1}.currency-label[data-v-1fef85ee]{color:#6c757d;font-size:.9rem;margin-top:.5rem}.qr-container[data-v-1fef85ee]{margin-bottom:1.5rem}.qr-wrapper[data-v-1fef85ee]{background:#fff;border:3px solid #01532b;border-radius:20px;box-shadow:0 15px 45px rgba(1,83,43,.2);padding:1.5rem}.qr-code-image[data-v-1fef85ee]{display:block;height:240px;width:240px}.qr-instructions[data-v-1fef85ee]{margin-bottom:1.5rem}.instruction-steps[data-v-1fef85ee]{display:flex;justify-content:space-around;margin:0 auto;max-width:400px}.step[data-v-1fef85ee]{align-items:center;color:#6c757d;display:flex;flex-direction:column;font-size:.85rem;text-align:center}.step-icon[data-v-1fef85ee]{color:#01532b!important;margin-bottom:.5rem}.payment-status[data-v-1fef85ee]{align-items:center;display:flex;justify-content:center;margin-bottom:1rem}.status-text[data-v-1fef85ee]{font-weight:600}.timer-display[data-v-1fef85ee]{color:#6c757d;font-size:.9rem}.timer-text[data-v-1fef85ee]{font-weight:500}.success-overlay[data-v-1fef85ee]{background:rgba(40,167,69,.95)!important}.success-content[data-v-1fef85ee]{color:#fff;max-width:600px;padding:3rem;text-align:center}.success-icon[data-v-1fef85ee]{animation:successPulse-1fef85ee 1s ease-in-out}@keyframes successPulse-1fef85ee{0%{opacity:0;transform:scale(.8)}50%{transform:scale(1.1)}to{opacity:1;transform:scale(1)}}.success-title[data-v-1fef85ee]{font-size:2.5rem}.success-amount[data-v-1fef85ee],.success-title[data-v-1fef85ee]{font-weight:700;margin-bottom:1rem}.success-amount[data-v-1fef85ee]{font-size:2rem}.success-message[data-v-1fef85ee]{font-size:1.3rem;margin-bottom:.5rem}.success-submessage[data-v-1fef85ee]{font-size:1rem;opacity:.9}.success-timer[data-v-1fef85ee]{margin:0 auto;max-width:300px}@media (max-width:1200px){.payment-layout[data-v-1fef85ee]{flex-direction:column;gap:1rem}.order-section[data-v-1fef85ee]{max-height:40vh}.qr-code-image[data-v-1fef85ee]{height:200px;width:200px}}@media (max-width:768px){.qr-payment-screen[data-v-1fef85ee]{padding:1rem}.order-item[data-v-1fef85ee]{padding:.75rem}.item-name[data-v-1fef85ee]{font-size:.9rem}.amount-value[data-v-1fef85ee]{font-size:2rem}}", ""]);
// Exports
___CSS_LOADER_EXPORT___.locals = {};
module.exports = ___CSS_LOADER_EXPORT___;


/***/ }),

/***/ 1240:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/vuetify/lib/components/VIcon/VIcon.js
var VIcon = __webpack_require__(60);

// EXTERNAL MODULE: ./node_modules/vuetify/lib/components/VOverlay/VOverlay.js
var VOverlay = __webpack_require__(113);

// EXTERNAL MODULE: ./node_modules/vuetify/lib/components/VProgressCircular/VProgressCircular.js
var VProgressCircular = __webpack_require__(90);

// EXTERNAL MODULE: ./node_modules/vuetify/lib/components/VProgressLinear/VProgressLinear.js
var VProgressLinear = __webpack_require__(122);

// CONCATENATED MODULE: ./node_modules/vuetify-loader/lib/loader.js??ref--4!./node_modules/babel-loader/lib??ref--2-0!./node_modules/vue-loader/lib/loaders/templateLoader.js??ref--7!./node_modules/@nuxt/components/dist/loader.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./pages/admin/cafeTable/customer.vue?vue&type=template&id=1fef85ee&scoped=true&





var customervue_type_template_id_1fef85ee_scoped_true_render = function render() {
  var _vm = this,
    _c = _vm._self._c;
  return _c('div', {
    staticClass: "customer-display-container"
  }, [!_vm.showQR ? _vm._ssrNode("<div class=\"welcome-screen\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"logo-section\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "dcommerce-green-text mb-4",
    attrs: {
      "size": "120"
    }
  }, [_vm._v("mdi-storefront")]), _vm._ssrNode(" <h1 class=\"store-name\" data-v-1fef85ee>DCOMMERCE CAFE</h1> <p class=\"welcome-text\" data-v-1fef85ee>Customer Display</p> <p class=\"status-text\" data-v-1fef85ee>Ready for QR Payment</p>")], 2), _vm._ssrNode(" "), _vm._ssrNode("<div class=\"waiting-animation\" data-v-1fef85ee>", "</div>", [_c(VProgressCircular["a" /* default */], {
    staticClass: "mb-4",
    attrs: {
      "indeterminate": "",
      "color": "#01532B",
      "size": "64",
      "width": "4"
    }
  }), _vm._ssrNode(" <p class=\"waiting-text\" data-v-1fef85ee>Waiting for payment request...</p>")], 2)], 2) : _vm._e(), _vm._ssrNode(" "), _vm.showQR ? _vm._ssrNode("<div class=\"qr-payment-screen\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"payment-layout\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"order-section\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"order-header\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<h3 class=\"order-title\" data-v-1fef85ee>Your Order</h3> "), _vm.qrData.tableNumber ? _vm._ssrNode("<div class=\"table-badge\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "mr-1",
    attrs: {
      "small": ""
    }
  }, [_vm._v("mdi-table-furniture")]), _vm._ssrNode(_vm._ssrEscape("\n            Table " + _vm._s(_vm.qrData.tableNumber) + "\n          "))], 2) : _vm._e()], 2), _vm._ssrNode(" "), _vm._ssrNode("<div class=\"order-items\" data-v-1fef85ee>", "</div>", [_vm.orderItems.length > 0 ? _vm._ssrNode("<div class=\"items-list\" data-v-1fef85ee>", "</div>", [_vm._ssrNode(_vm._ssrList(_vm.orderItems, function (item, index) {
    return "<div class=\"order-item\" data-v-1fef85ee><div class=\"item-details\" data-v-1fef85ee><div class=\"item-name\" data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(item.name)) + "</div> " + (item.description ? "<div class=\"item-description\" data-v-1fef85ee>" + _vm._ssrEscape("\n                  " + _vm._s(item.description) + "\n                ") + "</div>" : "<!---->") + "</div> <div class=\"item-quantity\" data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(item.quantity) + "x") + "</div> <div class=\"item-price\" data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(_vm.formatPrice(item.totalPrice))) + "</div></div>";
  }))], 2) : _vm._ssrNode("<div class=\"no-items\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "mb-2",
    attrs: {
      "size": "48",
      "color": "grey lighten-2"
    }
  }, [_vm._v("mdi-cart-outline")]), _vm._ssrNode(" <p class=\"grey--text\" data-v-1fef85ee>Loading order details...</p>")], 2)]), _vm._ssrNode(" <div class=\"order-summary\" data-v-1fef85ee><div class=\"summary-line\" data-v-1fef85ee><span data-v-1fef85ee>Subtotal:</span> <span data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(_vm.formatPrice(_vm.orderSummary.subtotal))) + "</span></div> " + (_vm.orderSummary.tax > 0 ? "<div class=\"summary-line\" data-v-1fef85ee><span data-v-1fef85ee>" + _vm._ssrEscape("Tax (" + _vm._s(_vm.orderSummary.taxRate) + "%):") + "</span> <span data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(_vm.formatPrice(_vm.orderSummary.tax))) + "</span></div>" : "<!---->") + " " + (_vm.orderSummary.discount > 0 ? "<div class=\"summary-line\" data-v-1fef85ee><span data-v-1fef85ee>Discount:</span> <span class=\"discount\" data-v-1fef85ee>" + _vm._ssrEscape("-" + _vm._s(_vm.formatPrice(_vm.orderSummary.discount))) + "</span></div>" : "<!---->") + " <div class=\"summary-total\" data-v-1fef85ee><span data-v-1fef85ee>Total:</span> <span data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(_vm.formatPrice(_vm.qrData.amount))) + "</span></div></div>")], 2), _vm._ssrNode(" "), _vm._ssrNode("<div class=\"payment-section\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"payment-header\" data-v-1fef85ee><h2 class=\"payment-title\" data-v-1fef85ee>Scan to Pay</h2></div> <div class=\"amount-display\" data-v-1fef85ee><div class=\"amount-label\" data-v-1fef85ee>Total Amount</div> <div class=\"amount-value\" data-v-1fef85ee>" + _vm._ssrEscape(_vm._s(_vm.formatPrice(_vm.qrData.amount))) + "</div> <div class=\"currency-label\" data-v-1fef85ee>Lao Kip (LAK)</div></div> <div class=\"qr-container\" data-v-1fef85ee><div class=\"qr-wrapper\" data-v-1fef85ee><img" + _vm._ssrAttr("src", _vm.qrCodeUrl) + " alt=\"Payment QR Code\" class=\"qr-code-image\" data-v-1fef85ee></div></div> "), _vm._ssrNode("<div class=\"qr-instructions\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"instruction-steps\" data-v-1fef85ee>", "</div>", [_vm._ssrNode("<div class=\"step\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "step-icon"
  }, [_vm._v("mdi-numeric-1-circle")]), _vm._ssrNode("\n              Open banking app\n            ")], 2), _vm._ssrNode(" "), _vm._ssrNode("<div class=\"step\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "step-icon"
  }, [_vm._v("mdi-numeric-2-circle")]), _vm._ssrNode("\n              Scan QR code\n            ")], 2), _vm._ssrNode(" "), _vm._ssrNode("<div class=\"step\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "step-icon"
  }, [_vm._v("mdi-numeric-3-circle")]), _vm._ssrNode("\n              Confirm payment\n            ")], 2)], 2)]), _vm._ssrNode(" "), _vm._ssrNode("<div class=\"payment-status\" data-v-1fef85ee>", "</div>", [!_vm.paymentComplete ? _c(VProgressCircular["a" /* default */], {
    staticClass: "mr-2",
    attrs: {
      "indeterminate": "",
      "color": "#01532B",
      "size": "20"
    }
  }) : _c(VIcon["a" /* default */], {
    staticClass: "mr-2",
    attrs: {
      "color": "success",
      "size": "20"
    }
  }, [_vm._v("mdi-check-circle")]), _vm._ssrNode(" <span" + _vm._ssrClass("status-text", _vm.paymentComplete ? 'success--text' : 'dcommerce-green-text') + " data-v-1fef85ee>" + _vm._ssrEscape("\n            " + _vm._s(_vm.paymentComplete ? 'Payment Received!' : 'Waiting for payment...') + "\n          ") + "</span>")], 2), _vm._ssrNode(" "), _vm.timeRemaining > 0 && !_vm.paymentComplete ? _vm._ssrNode("<div class=\"timer-display\" data-v-1fef85ee>", "</div>", [_c(VIcon["a" /* default */], {
    staticClass: "mr-1",
    attrs: {
      "small": ""
    }
  }, [_vm._v("mdi-timer-outline")]), _vm._ssrNode(" <span class=\"timer-text\" data-v-1fef85ee>" + _vm._ssrEscape("Expires in: " + _vm._s(_vm.formatTime(_vm.timeRemaining))) + "</span>")], 2) : _vm._e()], 2)], 2)]) : _vm._e(), _vm._ssrNode(" "), _vm.paymentComplete ? _c(VOverlay["a" /* default */], {
    staticClass: "success-overlay"
  }, [_c('div', {
    staticClass: "success-content"
  }, [_c(VIcon["a" /* default */], {
    staticClass: "mb-4 success-icon",
    attrs: {
      "size": "100",
      "color": "white"
    }
  }, [_vm._v("mdi-check-circle")]), _vm._v(" "), _c('h2', {
    staticClass: "success-title"
  }, [_vm._v("Payment Successful!")]), _vm._v(" "), _c('div', {
    staticClass: "success-amount"
  }, [_vm._v(_vm._s(_vm.formatPrice(_vm.qrData.amount)))]), _vm._v(" "), _c('p', {
    staticClass: "success-message"
  }, [_vm._v("Thank you for your payment")]), _vm._v(" "), _c('p', {
    staticClass: "success-submessage"
  }, [_vm._v("Please keep your receipt")]), _vm._v(" "), _c('div', {
    staticClass: "success-timer mt-4"
  }, [_c(VProgressLinear["a" /* default */], {
    attrs: {
      "value": _vm.successProgress,
      "color": "white",
      "background-color": "rgba(255,255,255,0.3)",
      "height": "4",
      "rounded": ""
    }
  }), _vm._v(" "), _c('p', {
    staticClass: "caption mt-2"
  }, [_vm._v("Screen will reset in " + _vm._s(Math.ceil(_vm.successTimeRemaining / 1000)) + "s")])], 1)], 1)]) : _vm._e()], 2);
};
var staticRenderFns = [];

// CONCATENATED MODULE: ./pages/admin/cafeTable/customer.vue?vue&type=template&id=1fef85ee&scoped=true&

// CONCATENATED MODULE: ./node_modules/babel-loader/lib??ref--2-0!./node_modules/@nuxt/components/dist/loader.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./pages/admin/cafeTable/customer.vue?vue&type=script&lang=js&
/* harmony default export */ var customervue_type_script_lang_js_ = ({
  name: 'CustomerScreen',
  layout: 'empty',
  data() {
    return {
      showQR: false,
      qrData: {
        amount: 0,
        tableNumber: '',
        qrString: '',
        timestamp: null,
        orderItems: [],
        // Add order items to QR data
        orderSummary: {}
      },
      paymentComplete: false,
      timeRemaining: 300,
      timer: null,
      showCloseButton: "production" === 'development',
      successTimeRemaining: 5000,
      successProgress: 0,
      successTimer: null,
      // Sample order data (will be replaced by actual data from QR)
      orderItems: [],
      orderSummary: {
        subtotal: 0,
        tax: 0,
        taxRate: 8.5,
        discount: 0
      }
    };
  },
  computed: {
    qrCodeUrl() {
      if (!this.qrData.qrString) return '';
      const encodedString = encodeURIComponent(this.qrData.qrString.replace(/\s/g, ''));
      return `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodedString}&format=png&margin=15&color=01532B&bgcolor=ffffff`;
    }
  },
  mounted() {
    this.setupCommunication();
    this.checkForExistingQR();
  },
  beforeDestroy() {
    this.cleanup();
  },
  methods: {
    getProductName(productId) {
      try {
        const product = this.filteredProducts.find(el => el.id === parseInt(productId));
        console.info(`PRODUCT ${this.filteredProducts.length}`);
        console.info(`PRODUCT ${JSON.stringify(this.filteredProducts)}`);
        console.info(`PRODUCT ${JSON.stringify(product)}`);
        return (product === null || product === void 0 ? void 0 : product.pro_name) || `Product ${productId}`;
      } catch (error) {
        console.error('Error getting product name:', error);
        return `Product ${productId}`;
      }
    },
    setupCommunication() {
      window.addEventListener('storage', this.handleStorageChange);
      this.checkForExistingQR();
    },
    handleStorageChange(event) {
      if (event.key === 'customerDisplay') {
        const data = event.newValue;
        if (data) {
          try {
            const message = JSON.parse(data);
            this.handleDisplayMessage(message);
          } catch (error) {
            console.error('Error parsing customer display data:', error);
          }
        }
      }
    },
    checkForExistingQR() {
      const customerDisplayData = localStorage.getItem('customerDisplay');
      if (customerDisplayData) {
        try {
          const message = JSON.parse(customerDisplayData);
          this.handleDisplayMessage(message);
        } catch (error) {
          console.error('Error parsing existing customer display data:', error);
        }
      }
    },
    handleDisplayMessage(message) {
      console.log('Customer screen received message:', message);
      if (message.type === 'SHOW_QR_PAYMENT') {
        this.displayQR(message.data);
      } else if (message.type === 'HIDE_QR_PAYMENT') {
        this.hideQR();
      } else if (message.type === 'PAYMENT_SUCCESS') {
        this.showPaymentSuccess();
      }
    },
    async displayQR(data) {
      console.log('Displaying QR for:', data);
      this.qrData = {
        ...data,
        timestamp: Date.now()
      };

      // Load order details if table number is provided
      if (data.tableNumber) {
        await this.loadOrderDetails(data.tableNumber);
      }
      this.showQR = true;
      this.paymentComplete = false;
      this.startTimer();
    },
    async loadOrderDetails(tableNumber) {
      try {
        console.log('Loading order details for table:', tableNumber);

        // Get pending tickets for the table
        const ticketResponse = await this.$axios.get(`/api/ticket/table/${tableNumber}/pending`);
        const tickets = ticketResponse.data || [];
        if (tickets.length === 0) {
          console.log('No pending tickets found for table:', tableNumber);
          this.orderItems = [];
          this.orderSummary = {
            subtotal: 0,
            tax: 0,
            taxRate: 0,
            discount: 0
          };
          return;
        }
        const currentTicket = tickets[0]; // Get the first pending ticket
        console.log('Current ticket:', currentTicket);

        // Get product details for mapping
        let products = [];
        try {
          const productsResponse = await this.$axios.get('/api/product/find');
          const productData = productsResponse.data.data || productsResponse.data;
          products = productData.map(product => ({
            id: product.id,
            name: product.pro_name,
            description: product.pro_desc || '',
            category: product.categ_name || 'General',
            price: product.pro_price || 0
          }));
          console.log('Products loaded for mapping:', products.length);
        } catch (error) {
          console.warn('Could not fetch products for mapping:', error);
        }

        // Process ticket lines into order items
        const ticketLines = currentTicket.ticketLines || [];
        this.orderItems = ticketLines.map(line => {
          const product = products.find(p => p.id === line.productId);
          console.log(` [LINE] ${JSON.stringify(products)} `);
          console.log(` LINE ${JSON.stringify(line)} `);
          console.log(` product ${JSON.stringify(product)} `);
          return {
            id: line.id,
            name: (product === null || product === void 0 ? void 0 : product.name) || `Product ${line.productId}`,
            description: (product === null || product === void 0 ? void 0 : product.description) || line.specialInstructions || '',
            quantity: line.quantity,
            unitPrice: line.unitPrice,
            totalPrice: line.totalPrice,
            status: line.status
          };
        }).filter(item => item.name !== `Product ${item.productId}`); // Filter out items without product names

        // Set order summary from ticket data
        this.orderSummary = {
          subtotal: currentTicket.subtotal || 0,
          tax: currentTicket.tax || 0,
          taxRate: currentTicket.subtotal > 0 ? ((currentTicket.tax || 0) / currentTicket.subtotal * 100).toFixed(1) : 0,
          discount: 0,
          // Add discount calculation if available in your ticket model
          total: currentTicket.total || 0
        };
        console.log('Order details loaded:', {
          items: this.orderItems.length,
          summary: this.orderSummary
        });
      } catch (error) {
        console.error('Error loading order details:', error);
        // Fallback to empty order
        this.orderItems = [];
        this.orderSummary = {
          subtotal: 0,
          tax: 0,
          taxRate: 0,
          discount: 0
        };
      }
    },
    hideQR() {
      console.log('Hiding QR display');
      this.showQR = false;
      this.paymentComplete = false;
      this.orderItems = [];
      this.stopTimer();
      this.stopSuccessTimer();
      localStorage.removeItem('customerDisplay');
    },
    showPaymentSuccess() {
      console.log('Showing payment success');
      this.paymentComplete = true;
      this.stopTimer();
      this.startSuccessTimer();
    },
    startTimer() {
      this.timeRemaining = 300;
      this.timer = setInterval(() => {
        this.timeRemaining--;
        if (this.timeRemaining <= 0) {
          this.hideQR();
        }
      }, 1000);
    },
    stopTimer() {
      if (this.timer) {
        clearInterval(this.timer);
        this.timer = null;
      }
    },
    startSuccessTimer() {
      this.successTimeRemaining = 5000;
      this.successProgress = 0;
      this.successTimer = setInterval(() => {
        this.successTimeRemaining -= 100;
        this.successProgress = (5000 - this.successTimeRemaining) / 5000 * 100;
        if (this.successTimeRemaining <= 0) {
          this.hideQR();
        }
      }, 100);
    },
    stopSuccessTimer() {
      if (this.successTimer) {
        clearInterval(this.successTimer);
        this.successTimer = null;
      }
    },
    cleanup() {
      window.removeEventListener('storage', this.handleStorageChange);
      this.stopTimer();
      this.stopSuccessTimer();
    },
    formatPrice(amount) {
      if (!amount) return '0 ₭';
      const formattedNumber = new Intl.NumberFormat('en-US', {
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      }).format(Math.round(amount));
      return `${formattedNumber} ₭`;
    },
    formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    },
    onQRError() {
      console.error('Failed to load QR code image');
    }
  }
});
// CONCATENATED MODULE: ./pages/admin/cafeTable/customer.vue?vue&type=script&lang=js&
 /* harmony default export */ var cafeTable_customervue_type_script_lang_js_ = (customervue_type_script_lang_js_); 
// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js
var componentNormalizer = __webpack_require__(10);

// CONCATENATED MODULE: ./pages/admin/cafeTable/customer.vue



function injectStyles (context) {
  
  var style0 = __webpack_require__(1046)
if (style0.__inject__) style0.__inject__(context)

}

/* normalize component */

var component = Object(componentNormalizer["a" /* default */])(
  cafeTable_customervue_type_script_lang_js_,
  customervue_type_template_id_1fef85ee_scoped_true_render,
  staticRenderFns,
  false,
  injectStyles,
  "1fef85ee",
  "978c0786"
  
)

/* harmony default export */ var customer = __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 799:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(1047);
if(content.__esModule) content = content.default;
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add CSS to SSR context
var add = __webpack_require__(5).default
module.exports.__inject__ = function (context) {
  add("922ad2ca", content, true, context)
};

/***/ })

};;
//# sourceMappingURL=customer.js.map